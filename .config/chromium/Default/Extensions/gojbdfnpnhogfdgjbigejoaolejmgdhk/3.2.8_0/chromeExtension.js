var clienttelemetry_build;!function(e){e.version="2.7.0"}(clienttelemetry_build||(clienttelemetry_build={}));var Microsoft;!function(e){var t;!function(e){!function(e){e[e.BT_STOP=0]="BT_STOP",e[e.BT_STOP_BASE=1]="BT_STOP_BASE",e[e.BT_BOOL=2]="BT_BOOL",e[e.BT_UINT8=3]="BT_UINT8",e[e.BT_UINT16=4]="BT_UINT16",e[e.BT_UINT32=5]="BT_UINT32",e[e.BT_UINT64=6]="BT_UINT64",e[e.BT_FLOAT=7]="BT_FLOAT",e[e.BT_DOUBLE=8]="BT_DOUBLE",e[e.BT_STRING=9]="BT_STRING",e[e.BT_STRUCT=10]="BT_STRUCT",e[e.BT_LIST=11]="BT_LIST",e[e.BT_SET=12]="BT_SET",e[e.BT_MAP=13]="BT_MAP",e[e.BT_INT8=14]="BT_INT8",e[e.BT_INT16=15]="BT_INT16",e[e.BT_INT32=16]="BT_INT32",e[e.BT_INT64=17]="BT_INT64",e[e.BT_WSTRING=18]="BT_WSTRING",e[e.BT_UNAVAILABLE=127]="BT_UNAVAILABLE"}(e.BondDataType||(e.BondDataType={}));e.BondDataType;!function(e){e[e.MARSHALED_PROTOCOL=0]="MARSHALED_PROTOCOL",e[e.MAFIA_PROTOCOL=17997]="MAFIA_PROTOCOL",e[e.COMPACT_PROTOCOL=16963]="COMPACT_PROTOCOL",e[e.JSON_PROTOCOL=21322]="JSON_PROTOCOL",e[e.PRETTY_JSON_PROTOCOL=20554]="PRETTY_JSON_PROTOCOL",e[e.SIMPLE_PROTOCOL=20563]="SIMPLE_PROTOCOL"}(e.ProtocolType||(e.ProtocolType={}));e.ProtocolType}(t=e.Bond||(e.Bond={}))}(Microsoft||(Microsoft={}));var Microsoft;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(){this._buffer=[]}return e.prototype.Add=function(e){for(var t=0;t<this._buffer.length&&this._buffer[t]!=e;++t);t==this._buffer.length&&this._buffer.push(e)},e.prototype.Count=function(){return this._buffer.length},e.prototype.GetBuffer=function(){return this._buffer},e}();e.Set=t;var n=function(){function e(){this._buffer=[]}return e.prototype.Add=function(e,t){-1==this._getIndex(e)&&this._buffer.push({Key:e,Value:t})},e.prototype.AddOrReplace=function(e,t){var n=this._getIndex(e);n>=0?this._buffer[n]={Key:e,Value:t}:this._buffer.push({Key:e,Value:t})},e.prototype.Remove=function(e){var t=this._getIndex(e);t>=0&&this._buffer.splice(t,1)},e.prototype.Count=function(){return this._buffer.length},e.prototype.GetBuffer=function(){return this._buffer},e.prototype.ContainsKey=function(e){return this._getIndex(e)>=0?!0:!1},e.prototype.Get=function(e){var t=this._getIndex(e);return t>=0?this._buffer[t].Value:null},e.prototype._getIndex=function(e){for(var t=0,n=-1;t<this._buffer.length;++t)if(this._buffer[t].Key==e){n=t;break}return n},e}();e.Map=n}(t=e.Collections||(e.Collections={}))}(t=e.Bond||(e.Bond={}))}(Microsoft||(Microsoft={}));var Microsoft;!function(e){var t;!function(t){var n;!function(e){var n=function(){function e(){}return e.GetBytes=function(e){for(var t=[],n=0;n<e.length;++n){var i=e.charCodeAt(n);128>i?t.push(i):2048>i?t.push(192|i>>6,128|63&i):55296>i||i>=57344?t.push(224|i>>12,128|i>>6&63,128|63&i):(i=65536+((1023&i)<<10|1023&e.charCodeAt(++n)),t.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|63&i))}return t},e}();e.Utf8=n;var i=function(){function e(){}return e.GetString=function(e){var t,n,i,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=[],s=e.length%3,a=function(e){return[r.charAt(e>>18&63),r.charAt(e>>12&63),r.charAt(e>>6&63),r.charAt(63&e)].join("")};for(t=0,i=e.length-s;i>t;t+=3)n=(e[t]<<16)+(e[t+1]<<8)+e[t+2],o.push(a(n));switch(s){case 1:n=e[e.length-1],o.push(r.charAt(n>>2)),o.push(r.charAt(n<<4&63)),o.push("==");break;case 2:n=(e[e.length-2]<<8)+e[e.length-1],o.push(r.charAt(n>>10)),o.push(r.charAt(n>>4&63)),o.push(r.charAt(n<<2&63)),o.push("=")}return o.join("")},e}();e.Base64=i;var o=function(){function e(){}return e.GetBytes=function(e){for(var t=[];4294967168&e;)t.push(127&e|128),e>>>=7;return t.push(127&e),t},e}();e.Varint=o;var s=function(){function e(){}return e.GetBytes=function(e){for(var t=e.low,n=e.high,i=[];n||4294967168&t;)i.push(127&t|128),t=(127&n)<<25|t>>>7,n>>>=7;return i.push(127&t),i},e}();e.Varint64=s;var a=function(){function e(){}return e.GetBytes=function(e){if(t.BrowserChecker.IsDataViewSupport()){var n=new DataView(new ArrayBuffer(4));n.setFloat32(0,e,!0);for(var i=[],o=0;4>o;++o)i.push(n.getUint8(o));return i}return r.ConvertNumberToArray(e,!1)},e}();e.Float=a;var u=function(){function e(){}return e.GetBytes=function(e){if(t.BrowserChecker.IsDataViewSupport()){var n=new DataView(new ArrayBuffer(8));n.setFloat64(0,e,!0);for(var i=[],o=0;8>o;++o)i.push(n.getUint8(o));return i}return r.ConvertNumberToArray(e,!0)},e}();e.Double=u;var d=function(){function e(){}return e.EncodeZigzag16=function(e){return e=t.Number.ToInt16(e),e<<1^e>>15},e.EncodeZigzag32=function(e){return e=t.Number.ToInt32(e),e<<1^e>>31},e.EncodeZigzag64=function(e){var n=e.low,i=e.high,r=i<<1|n>>>31,o=n<<1;2147483648&i&&(r=~r,o=~o);var s=new t.UInt64("0");return s.low=o,s.high=r,s},e}();e.Zigzag=d}(n=t.Encoding||(t.Encoding={}));var i;!function(n){var i=function(){function e(){}return e.GetString=function(e){for(var t=[],n=0;n<e.length;++n){var i=e[n];if(191>=i)t.push(String.fromCharCode(i));else if(223>=i){var r=e[++n];t.push(String.fromCharCode((31&i)<<6|63&r))}else if(239>=i){var r=e[++n],o=e[++n];t.push(String.fromCharCode((15&i)<<12|(63&r)<<6|63&o))}else{var r=e[++n],o=e[++n],s=e[++n];i=(7&i)<<18|(63&r)<<12|(63&o)<<6|63&s,i-=65536,t.push(String.fromCharCode(55296|i>>10&1023)),t.push(String.fromCharCode(56320|1023&i))}}return t.join("")},e}();n.Utf8=i;var o=function(){function e(){}return e.GetBytes=function(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=[],i=0;i<e.length;++i){var r=t.indexOf(e.charAt(i++)),o=t.indexOf(e.charAt(i++)),s=t.indexOf(e.charAt(i++)),a=t.indexOf(e.charAt(i));n.push(r<<2|o>>4),s>=0&&(n.push(o<<4&240|s>>2),a>=0&&n.push(s<<6&192|a))}return n},e}();n.Base64=o;var s=function(){function t(){}return t.GetInt64=function(t){var n=new e.Bond.Int64("0"),i=this._Read(t);return n.low=i[0],i.length>1&&(n.high=i[1]),n},t.GetNumber=function(e){return this._Read(e)[0]},t._Read=function(e){for(var t=[],n=0,i=!0,r=0;i;){var o=e.shift();if(i=0!=(128&o),o=127&o,!(28>r)){n|=o<<r,t.push(n),n=o>>4,r=3;break}n|=o<<r,r+=7}for(;i;){var o=e.shift();if(i=0!=(128&o),o=127&o,n|=o<<r,r+=7,r>=32)break}return t.push(n),t},t}();n.Varint=s;var a=function(){function e(){}return e.GetNumber=function(e){if(t.BrowserChecker.IsDataViewSupport()){for(var n=new DataView(new ArrayBuffer(4)),i=0;4>i;++i)n.setUint8(i,e[i]);return n.getFloat32(0,!0)}return r.ConvertArrayToNumber(e,!1)},e}();n.Float=a;var u=function(){function e(){}return e.GetNumber=function(e){if(t.BrowserChecker.IsDataViewSupport()){for(var n=new DataView(new ArrayBuffer(8)),i=0;8>i;++i)n.setUint8(i,e[i]);return n.getFloat64(0,!0)}return r.ConvertArrayToNumber(e,!0)},e}();n.Double=u;var d=function(){function t(){}return t.DecodeZigzag16=function(e){return((65535&e)>>>1^-(1&e))<<16>>16},t.DecodeZigzag32=function(e){return e>>>1^-(1&e)},t.DecodeZigzag64=function(t){var n=1&t.high,i=t.high>>>1,r=1&t.low,o=t.low>>>1;o=n<<31|o,r&&(o^=4294967295,i^=4294967295);var s=new e.Bond.UInt64("0");return s.low=o,s.high=i,s},t}();n.Zigzag=d}(i=t.Decoding||(t.Decoding={}));var r=function(){function e(){}return e.ConvertNumberToArray=function(e,t){if(!e)return t?this._doubleZero:this._floatZero;var n=t?11:8,i=t?52:23,r=(1<<n-1)-1,o=1-r,s=r,a=0>e?1:0;e=Math.abs(e);for(var u=Math.floor(e),d=e-u,c=2*(r+2)+i,l=new Array(c),_=0;c>_;)l[_++]=0;for(_=r+2;_&&u;)l[--_]=u%2,u=Math.floor(u/2);for(_=r+1;c-1>_&&d>0;)d*=2,d>=1?(l[++_]=1,--d):l[++_]=0;for(var f=0;c>f&&!l[f];++f);var h=r+1-f,p=f+i;if(l[p+1]){for(_=p;_>f&&!(l[_]=1-l[_]);--_);_==f&&++h}if(h>s||u)return a?t?this._doubleNegInifinity:this._floatNegInifinity:t?this._doubleInifinity:this._floatInifinity;if(o>h)return t?this._doubleZero:this._floatZero;if(t){var I=0;for(_=0;20>_;++_)I=I<<1|l[++f];for(var T=0;52>_;++_)T=T<<1|l[++f];I|=h+r<<20,I=a<<31|2147483647&I;var S=[255&T,T>>8&255,T>>16&255,T>>>24,255&I,I>>8&255,I>>16&255,I>>>24];return S}var g=0;for(_=0;23>_;++_)g=g<<1|l[++f];g|=h+r<<23,g=a<<31|2147483647&g;var S=[255&g,g>>8&255,g>>16&255,g>>>24];return S},e.ConvertArrayToNumber=function(e,n){var i=n?11:8,r=(1<<i-1)-1,o=0!=(128&e[n?7:3]),s=n?(127&e[7])<<4|(240&e[6])>>4:(127&e[3])<<1|(128&e[2])>>7;if(255==s)throw new t.Exception("Not a valid float/double buffer.");var a=1,u=1;if(n){var d=(15&e[6])<<28|(255&e[5])<<20|(255&e[4])<<12,c=e[3]<<24|(255&e[2])<<16|(255&e[1])<<8|255&e[0];if(!s&&!d&&!c)return 0;for(var l=0;20>l;++l)u/=2,0>d&&(a+=u),d<<=1;for(var l=0;32>l;++l)u/=2,0>c&&(a+=u),c<<=1}else{var _=(127&e[2])<<25|(255&e[1])<<17|(255&e[0])<<9;if(!s&&!_)return 0;for(var l=0;23>l;++l)u/=2,0>_&&(a+=u),_<<=1}return a*=Math.pow(2,s-r),o?0-a:a},e._floatZero=[0,0,0,0],e._doubleZero=[0,0,0,0,0,0,0,0],e._floatInifinity=[0,0,128,127],e._floatNegInifinity=[0,0,128,255],e._doubleInifinity=[0,0,0,0,0,0,240,127],e._doubleNegInifinity=[0,0,0,0,0,0,240,255],e}()}(t=e.Bond||(e.Bond={}))}(Microsoft||(Microsoft={}));var Microsoft;!function(e){var t;!function(e){var t;!function(t){var n=function(){function t(){this._buffer=[]}return t.prototype.WriteByte=function(t){this._buffer.push(e.Number.ToByte(t))},t.prototype.Write=function(e,t,n){for(;n--;)this.WriteByte(e[t++])},t.prototype.GetBuffer=function(){return this._buffer},t}();t.MemoryStream=n}(t=e.IO||(e.IO={}))}(t=e.Bond||(e.Bond={}))}(Microsoft||(Microsoft={}));var Microsoft;!function(e){var t;!function(e){var t=function(){function e(e,t){this.Type=e,this.Id=t}return e}();e.FieldTag=t;var n=function(){function e(e,t){this.ElementType=e,this.Size=t}return e}();e.ContainerTag=n;var i=function(){function e(e,t,n){this.KeyType=e,this.ValueType=t,this.Size=n}return e}();e.KeyValueContainerTag=i;var r=function(){function e(){}return e}();e.Bonded=r;var o=function(){function e(e){this.low=0,this.high=0,this.low=parseInt(e),this.low<0&&(this.high=-1)}return e.prototype.Equals=function(t){var n=new e(t);return this.low==n.low&&this.high==n.high},e}();e.Int64=o;var s=function(){function e(e){this.low=0,this.high=0,this.low=parseInt(e)}return e.prototype.Equals=function(t){var n=new e(t);return this.low==n.low&&this.high==n.high},e}();e.UInt64=s;var a=function(){function e(){}return e.ToByte=function(e){return this.ToUInt8(e)},e.ToInt8=function(e){var t=(128&e)<<24>>24;return 127&e|t},e.ToInt16=function(e){var t=(32768&e)<<16>>16;return 32767&e|t},e.ToInt32=function(e){var t=2147483648&e;return 2147483647&e|t},e.ToUInt8=function(e){return 255&e},e.ToUInt16=function(e){return 65535&e},e.ToUInt32=function(e){return 4294967295&e},e}();e.Number=a;var u=function(){function e(e){this.Message=e}return e}();e.Exception=u;var d=function(){function e(){}return e}();e.KeyValuePair=d;var c=function(){function e(){}return e.IsDataViewSupport=function(){return"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},e}();e.BrowserChecker=c}(t=e.Bond||(e.Bond={}))}(Microsoft||(Microsoft={}));var Microsoft;!function(e){var t;!function(e){var t=function(){function t(e){this._stream=e}return t.prototype.WriteBlob=function(e){this._stream.Write(e,0,e.length)},t.prototype.WriteBool=function(e){this._stream.WriteByte(e?1:0)},t.prototype.WriteContainerBegin=function(e,t){this.WriteUInt8(t),this.WriteUInt32(e)},t.prototype.WriteMapContainerBegin=function(e,t,n){this.WriteUInt8(t),this.WriteUInt8(n),this.WriteUInt32(e)},t.prototype.WriteContainerEnd=function(){},t.prototype.WriteDouble=function(t){var n=e.Encoding.Double.GetBytes(t);this._stream.Write(n,0,n.length)},t.prototype.WriteFloat=function(t){var n=e.Encoding.Float.GetBytes(t);this._stream.Write(n,0,n.length)},t.prototype.WriteFieldBegin=function(e,t,n){5>=t?this._stream.WriteByte(e|t<<5):255>=t?(this._stream.WriteByte(192|e),this._stream.WriteByte(t)):(this._stream.WriteByte(224|e),this._stream.WriteByte(t),this._stream.WriteByte(t>>8))},t.prototype.WriteFieldEnd=function(){},t.prototype.WriteFieldOmitted=function(e,t,n){},t.prototype.WriteInt16=function(t){t=e.Encoding.Zigzag.EncodeZigzag16(t),this.WriteUInt16(t)},t.prototype.WriteInt32=function(t){t=e.Encoding.Zigzag.EncodeZigzag32(t),this.WriteUInt32(t)},t.prototype.WriteInt64=function(t){this.WriteUInt64(e.Encoding.Zigzag.EncodeZigzag64(t))},t.prototype.WriteInt8=function(t){this._stream.WriteByte(e.Number.ToInt8(t))},t.prototype.WriteString=function(t){if(""==t)this.WriteUInt32(0);else{var n=e.Encoding.Utf8.GetBytes(t);this.WriteUInt32(n.length),this._stream.Write(n,0,n.length)}},t.prototype.WriteStructBegin=function(e,t){},t.prototype.WriteStructEnd=function(t){this.WriteUInt8(t?e.BondDataType.BT_STOP_BASE:e.BondDataType.BT_STOP)},t.prototype.WriteUInt16=function(t){var n=e.Encoding.Varint.GetBytes(e.Number.ToUInt16(t));this._stream.Write(n,0,n.length)},t.prototype.WriteUInt32=function(t){var n=e.Encoding.Varint.GetBytes(e.Number.ToUInt32(t));this._stream.Write(n,0,n.length)},t.prototype.WriteUInt64=function(t){var n=e.Encoding.Varint64.GetBytes(t);this._stream.Write(n,0,n.length)},t.prototype.WriteUInt8=function(t){this._stream.WriteByte(e.Number.ToUInt8(t))},t.prototype.WriteWString=function(e){this.WriteUInt32(e.length);for(var t=0;t<e.length;++t){var n=e.charCodeAt(t);this._stream.WriteByte(n),this._stream.WriteByte(n>>>8)}},t}();e.CompactBinaryProtocolWriter=t;var n=function(){function e(){}return e}();e.CompactBinaryProtocolReader=n}(t=e.Bond||(e.Bond={}))}(Microsoft||(Microsoft={}));var sct;!function(e){var t=function(){function t(){}return t.IsSafari=function(){if(null===t._isSafari)if("undefined"!=typeof navigator&&navigator.userAgent){var e=navigator.userAgent.toLowerCase();t._isSafari=e.indexOf("safari")>=0&&e.indexOf("chrome")<0?!0:!1}else t._isSafari=!1;return t._isSafari},t.IsReactNative=function(){return null===t._isReactNative&&(t._isReactNative="undefined"!=typeof navigator&&navigator.product?"ReactNative"===navigator.product:!1),t._isReactNative},t.IsUint8ArrSupported=function(){return!e.Utils.IsSafari()&&"undefined"!=typeof Uint8Array&&!e.Utils.IsReactNative()},t.ajax=function(e,n){var i=t._createConnection();if(e.headers){var r="qsp=true";for(var o in e.headers)r+="&",r+=encodeURIComponent(o),r+="=",r+=encodeURIComponent(e.headers[o]);e.url+=e.url.indexOf("?")<0?"?":"&",e.url+=r}i.open(e.type,e.url,!n),e.complete&&(i.onload=function(){"undefined"==typeof i.status&&(i.status=200),e.complete(i)},i.ontimeout=function(){"undefined"==typeof i.status&&(i.status=500),e.complete(i)},i.onerror=function(){e.complete(i)}),i.send(e.data)},t.keys=function(e){if(Object.keys)return Object.keys(e);var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t},t.IsUsingXDomainRequest=function(){if(null==t._usingXDomainRequest){var e=new XMLHttpRequest;t._usingXDomainRequest="undefined"==typeof e.withCredentials&&"undefined"!=typeof XDomainRequest?!0:!1}return t._usingXDomainRequest},t._createConnection=function(){var e=new XMLHttpRequest;return t.IsUsingXDomainRequest()?new XDomainRequest:e},t._isSafari=null,t._isReactNative=null,t._usingXDomainRequest=null,t}();e.Utils=t}(sct||(sct={}));var microsoft;!function(e){var t;!function(e){var t;!function(e){var t;!function(t){var n=function(){function e(){}return e.GetGuid=function(){var e=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1,5)};return[e(),e(),"-",e(),"-",e(),"-",e(),"-",e(),e(),e()].join("")},e.GetTimeStamp=function(){var e=(new Date).getTime(),t=new Microsoft.Bond.Int64("0");return t.low=4294967295&e,t.high=Math.floor(e/4294967296),t},e.GetTimeStampWithValue=function(e){var t=new Microsoft.Bond.Int64("0");return t.low=4294967295&e,t.high=Math.floor(e/4294967296),t},e}();t.utils=n,function(e){e[e.NotSet=0]="NotSet",e[e.Event=1]="Event",e[e.PerformanceCounter=2]="PerformanceCounter",e[e.Anomaly=3]="Anomaly",e[e.Prediction=4]="Prediction",e[e.TraceLog=5]="TraceLog",e[e.EventSourceLog=6]="EventSourceLog",e[e.HttpLog=7]="HttpLog",e[e.PerformanceCounterAzure=8]="PerformanceCounterAzure",e[e.PerformanceCounterGfs=9]="PerformanceCounterGfs"}(t.RecordType||(t.RecordType={}));t.RecordType;!function(e){e[e.NotSet=0]="NotSet",e[e.O365=1]="O365",e[e.SkypeBI=2]="SkypeBI",e[e.SkypeData=3]="SkypeData"}(t.PIIScrubber||(t.PIIScrubber={}));t.PIIScrubber;!function(e){e[e.NotSet=0]="NotSet",e[e.DistinguishedName=1]="DistinguishedName",e[e.GenericData=2]="GenericData",e[e.IPV4Address=3]="IPV4Address",e[e.IPv6Address=4]="IPv6Address",e[e.MailSubject=5]="MailSubject",e[e.PhoneNumber=6]="PhoneNumber",e[e.QueryString=7]="QueryString",e[e.SipAddress=8]="SipAddress",e[e.SmtpAddress=9]="SmtpAddress",e[e.Identity=10]="Identity",e[e.Uri=11]="Uri",e[e.Fqdn=12]="Fqdn",e[e.IPV4AddressLegacy=13]="IPV4AddressLegacy"}(t.PIIKind||(t.PIIKind={}));t.PIIKind;!function(e){e[e.Unknown=0]="Unknown",e[e.MSACID=1]="MSACID",e[e.MSAPUID=2]="MSAPUID",e[e.ANID=3]="ANID",e[e.OrgIdCID=4]="OrgIdCID",e[e.OrgIdPUID=5]="OrgIdPUID",e[e.UserObjectId=6]="UserObjectId",e[e.Skype=7]="Skype",e[e.Yammer=8]="Yammer",e[e.EmailAddress=9]="EmailAddress",e[e.PhoneNumber=10]="PhoneNumber",e[e.SipAddress=11]="SipAddress",e[e.MUID=12]="MUID"}(t.UserIdType||(t.UserIdType={}));var i=(t.UserIdType,function(){function t(){this.ScrubType=e.datamodels.PIIScrubber.NotSet,this.Kind=e.datamodels.PIIKind.NotSet,this.RawContent=""}return t.prototype.Write=function(e){this.WriteImpl(e,!1)},t.prototype.WriteImpl=function(t,n){t.WriteStructBegin(null,n),this.ScrubType!=e.datamodels.PIIScrubber.NotSet?(t.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_INT32,1,null),t.WriteInt32(this.ScrubType),t.WriteFieldEnd()):t.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_INT32,1,null),this.Kind!=e.datamodels.PIIKind.NotSet?(t.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_INT32,2,null),t.WriteInt32(this.Kind),t.WriteFieldEnd()):t.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_INT32,2,null),""!=this.RawContent?(t.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_STRING,3,null),t.WriteString(this.RawContent),t.WriteFieldEnd()):t.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_STRING,3,null),t.WriteStructEnd(n)},t.prototype.Read=function(e){this.ReadImpl(e,!1)},t.prototype.ReadImpl=function(e,t){},t}());t.PII=i;var r=function(){function t(){this.Id=n.GetGuid(),this.Timestamp=n.GetTimeStamp(),this.Type="",this.EventType="",this.Extension=new Microsoft.Bond.Collections.Map,this.RecordType=e.datamodels.RecordType.NotSet,this.PIIExtensions=new Microsoft.Bond.Collections.Map}return t.prototype.AddOrReplacePII=function(t,n,i){var r=new e.datamodels.PII;r.RawContent=n,r.Kind=i,r.ScrubType=e.datamodels.PIIScrubber.O365,this.PIIExtensions.AddOrReplace(t,r)},t.prototype.Write=function(e){this.WriteImpl(e,!1)},t.prototype.WriteImpl=function(t,n){if(t.WriteStructBegin(null,n),""!=this.Id?(t.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_STRING,1,null),t.WriteString(this.Id),t.WriteFieldEnd()):t.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_STRING,1,null),this.Timestamp.Equals("0")?t.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_INT64,3,null):(t.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_INT64,3,null),t.WriteInt64(this.Timestamp),t.WriteFieldEnd()),""!=this.Type?(t.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_STRING,5,null),t.WriteString(this.Type),t.WriteFieldEnd()):t.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_STRING,5,null),""!=this.EventType?(t.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_STRING,6,null),t.WriteString(this.EventType),t.WriteFieldEnd()):t.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_STRING,6,null),this.Extension.Count()){t.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_MAP,13,null),t.WriteMapContainerBegin(this.Extension.Count(),Microsoft.Bond.BondDataType.BT_STRING,Microsoft.Bond.BondDataType.BT_STRING);for(var i=0;i<this.Extension.GetBuffer().length;++i)t.WriteString(this.Extension.GetBuffer()[i].Key),t.WriteString(this.Extension.GetBuffer()[i].Value);t.WriteContainerEnd(),t.WriteFieldEnd()}else t.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_MAP,13,null);if(this.RecordType!=e.datamodels.RecordType.NotSet?(t.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_INT32,24,null),t.WriteInt32(this.RecordType),t.WriteFieldEnd()):t.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_INT32,24,null),this.PIIExtensions.Count()){t.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_MAP,30,null),t.WriteMapContainerBegin(this.PIIExtensions.Count(),Microsoft.Bond.BondDataType.BT_STRING,Microsoft.Bond.BondDataType.BT_STRUCT);for(var r=0;r<this.PIIExtensions.GetBuffer().length;++r)t.WriteString(this.PIIExtensions.GetBuffer()[r].Key),this.PIIExtensions.GetBuffer()[r].Value.WriteImpl(t,!1);t.WriteContainerEnd(),t.WriteFieldEnd()}else t.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_MAP,30,null);t.WriteStructEnd(n)},t.prototype.Read=function(e){this.ReadImpl(e,!1)},t.prototype.ReadImpl=function(e,t){},t}();t.Record=r;var o=function(){function e(){this.Source="",this.DataPackageId="",this.Timestamp=new Microsoft.Bond.Int64("0"),this.Records=[]}return e.prototype.Write=function(e){this.WriteImpl(e,!1)},e.prototype.WriteImpl=function(e,t){if(e.WriteStructBegin(null,t),""!=this.Source?(e.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_STRING,2,null),e.WriteString(this.Source),e.WriteFieldEnd()):e.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_STRING,2,null),""!=this.DataPackageId?(e.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_STRING,5,null),e.WriteString(this.DataPackageId),e.WriteFieldEnd()):e.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_STRING,5,null),this.Timestamp.Equals("0")?e.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_INT64,6,null):(e.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_INT64,6,null),e.WriteInt64(this.Timestamp),e.WriteFieldEnd()),this.Records.length){e.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_LIST,8,null),e.WriteContainerBegin(this.Records.length,Microsoft.Bond.BondDataType.BT_STRUCT);for(var n=0;n<this.Records.length;++n)this.Records[n].WriteImpl(e,!1);e.WriteContainerEnd(),e.WriteFieldEnd()}else e.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_LIST,8,null);e.WriteStructEnd(t)},e.prototype.Read=function(e){this.ReadImpl(e,!1)},e.prototype.ReadImpl=function(e,t){},e}();t.DataPackage=o;var s=function(){function e(){this.DataPackages=[],this.RequestRetryCount=0}return e.prototype.Write=function(e){this.WriteImpl(e,!1)},e.prototype.WriteImpl=function(e,t){if(e.WriteStructBegin(null,t),this.DataPackages.length){e.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_LIST,1,null),e.WriteContainerBegin(this.DataPackages.length,Microsoft.Bond.BondDataType.BT_STRUCT);for(var n=0;n<this.DataPackages.length;++n)this.DataPackages[n].WriteImpl(e,!1);e.WriteContainerEnd(),e.WriteFieldEnd()}else e.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_LIST,1,null);0!=this.RequestRetryCount?(e.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_INT32,2,null),e.WriteInt32(this.RequestRetryCount),e.WriteFieldEnd()):e.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_INT32,2,null),e.WriteStructEnd(t)},e.prototype.Read=function(e){this.ReadImpl(e,!1)},e.prototype.ReadImpl=function(e,t){},e}();t.ClientToCollectorRequest=s}(t=e.datamodels||(e.datamodels={}))}(t=e.telemetry||(e.telemetry={}))}(t=e.applications||(e.applications={}))}(microsoft||(microsoft={}));var microsoft;!function(e){var t;!function(e){var t;!function(e){var t;!function(t){!function(e){e[e.SENT=0]="SENT",e[e.SEND_FAILED=1]="SEND_FAILED"}(t.CallbackEventType||(t.CallbackEventType={}));var n=t.CallbackEventType;!function(e){e[e.DATARV_ERROR_OK=0]="DATARV_ERROR_OK",e[e.DATARV_ERROR_INVALID_EVENT=1]="DATARV_ERROR_INVALID_EVENT",e[e.DATARV_ERROR_INVALID_CONFIG=2]="DATARV_ERROR_INVALID_CONFIG",e[e.DATARV_ERROR_INVALID_DEPENDENCIES=3]="DATARV_ERROR_INVALID_DEPENDENCIES",e[e.DATARV_ERROR_INVALID_STATUS=4]="DATARV_ERROR_INVALID_STATUS",e[e.DATARV_ERROR_INVALID_ARG=5]="DATARV_ERROR_INVALID_ARG"}(t.DATARV_ERROR||(t.DATARV_ERROR={}));var i=t.DATARV_ERROR,r=function(){function e(e){this._errorCode=i.DATARV_ERROR_OK,this._errorCode=e}return e.prototype.ErrorCode=function(){return this._errorCode},e.prototype.toString=function(){switch(this._errorCode){case i.DATARV_ERROR_OK:return"DATARV_ERROR_OK";case i.DATARV_ERROR_INVALID_EVENT:return"Event is invalid. Either event.Id is empty, or event.Timestamp is empty, or event.EventType is empty.";case i.DATARV_ERROR_INVALID_CONFIG:return"Invalid configuration. CollectorUrl is missing.";case i.DATARV_ERROR_INVALID_DEPENDENCIES:return"DATARV_ERROR_INVALID_DEPENDENCIES";case i.DATARV_ERROR_INVALID_STATUS:return"Telemetry Manager is not initialized.";case i.DATARV_ERROR_INVALID_ARG:return"TenantToken is null or empty, or events is null.";default:return"Unknown error"}},e}();t.Exception=r;var o=function(){function e(){}return e}();t.TelemetryConfig=o;var s=function(){function e(){}return e.CreateTelemetryManager=function(){return new d},e}();t.TelemetryManagerFactory=s;var a,u=function(){function e(){}return e.MaxPackageSizeInBytes=function(){return 3e6},e.TimeIntervalForNextSendInMS=function(){return 1e3},e}();!function(e){e[e.Created=0]="Created",e[e.Initialized=1]="Initialized",e[e.Started=2]="Started"}(a||(a={}));var d=function(){function t(){this._MaxPackageSizeInBytes=u.MaxPackageSizeInBytes(),this._listeners=[],this._status=a.Created,this._etag=null,this._testServerResponseHook=null,this._isPaused=!1}return t.prototype.Initialize=function(e){if(this._status!=a.Created)throw new r(i.DATARV_ERROR_INVALID_STATUS);if(!e||!e.collectorUrl)throw new r(i.DATARV_ERROR_INVALID_CONFIG);this._config=e,this._Reset(),this._status=a.Initialized,this._Verbose("Initialize() done")},t.prototype.AddListener=function(e){if(this._status<a.Initialized)throw new r(i.DATARV_ERROR_INVALID_STATUS);this._Verbose(["AddListener(), status: ",this._status," old length: ",this._listeners.length," func: ",e].join(""));for(var t=0;t<this._listeners.length;++t)if(this._listeners[t]==e)return void this._Verbose("the listener has been added already, index: "+t);this._listeners.push(e),this._Verbose("AddListener() done, the new length: "+this._listeners.length)},t.prototype.RemoveListener=function(e){if(this._status<a.Initialized)throw new r(i.DATARV_ERROR_INVALID_STATUS);this._Verbose(["RemoveListener(), status: ",this._status," old length: ",this._listeners.length," func: ",e].join(""));for(var t=0;t<this._listeners.length;++t)if(this._listeners[t]==e)return 1==this._listeners.length?this._listeners=[]:t==this._listeners.length-1?this._listeners.pop():this._listeners[t]=this._listeners.pop(),void this._Verbose(["this listener has been found, index: ",t,"new length: ",this._listeners.length].join(""));this._Verbose("listener isn't been found, new length"+this._listeners.length)},t.prototype.Start=function(){if(this._status<a.Initialized)throw new r(i.DATARV_ERROR_INVALID_STATUS);this._Verbose(["Start(), status:",this._status,"tag:",t._tag].join(" ")),this._status>=a.Started&&this._Verbose("Start() already, ignore"),++t._tag,this._status=a.Started,this._Verbose(["Start() done, status: ",this._status,"tag: ",t._tag].join(""))},t.prototype.Stop=function(){if(this._status<a.Initialized)throw new r(i.DATARV_ERROR_INVALID_STATUS);return this._Verbose("Stop(), status: "+this._status),this._status==a.Initialized?void this._Verbose("Stop() already, ignore"):(this._Reset(),this._status=a.Initialized,void this._Verbose("Stop() done, status: "+this._status))},t.prototype.Pause=function(){this._isPaused=!0,this._CleanTimer()},t.prototype.Resume=function(){this._isPaused=!1,this._eventsCache.IsEmpty()||this._timer||this._ScheduleTimer(!1)},t.prototype.Flush=function(e){this._eventsCache.IsEmpty()||this._WorkThread(e,!0)},t.prototype.SendAsync=function(e,n){if(this._status<a.Initialized)throw new r(i.DATARV_ERROR_INVALID_STATUS);if(this._Verbose(["SendAsync(), status:",this._status,"tenantToken:",e,"count:",n.length].join(" ")),this._status<a.Started)return this._Info("SendAsync(), not started, ignore, return false"),!1;if(!e||!n)throw this._Error("SendAsync(), tenantToken or events is null or empty"),new r(i.DATARV_ERROR_INVALID_ARG);for(var o=0;o<n.length;++o)if(!n[o].Id||!t._eventTypeRegex.test(n[o].EventType)||n[o].Timestamp.Equals("0"))throw this._Error(["eventId:",n[o].Id,"eventType:",n[o].EventType,"timestamp high:",n[o].Timestamp.high,"timestamp low:",n[o].Timestamp.low].join("")),new r(i.DATARV_ERROR_INVALID_EVENT);return this._eventsCache.AddEvents(e,n),this._Verbose(["SendAsync(), currentTimer: ",this._timer,"eventsCacheIsEmpty",this._eventsCache.IsEmpty()].join(" ")),this._eventsCache.IsEmpty()||this._timer||this._ScheduleTimer(!1),this._Verbose("SendAsync() done"),!0},t.prototype._WorkThread=function(e,n){var i=this;try{if(this._Verbose("_WorkThread, status: "+this._status),this._status<a.Started)return void this._Verbose("_WorkThread, status is not started, return");var r=this._eventsCache.DequeuEvents();if(null==r)return this._Verbose("_WorkThread, No events found, return"),void this._CleanTimer();var o=this._PackEvents(r.tenantToken,r.events);if(this._eventsCache.AddEvents(r.tenantToken,o.remainedEvents),null==o.buffer||0==o.buffer.length)return void(this._eventsCache.IsEmpty()?(this._Verbose("eventsCache is empty, stop schedule"),this._CleanTimer()):(this._Verbose("eventsCache is not empty, schedule for next run"),this._ScheduleTimer(!1)));if(this._testServerResponseHook){var s=this._testServerResponseHook();return void setTimeout(this._SendCallback(d,r.tenantToken,o.sendEvents,s,!1,null),100)}var u={type:"POST",url:this._config.collectorUrl,processData:!1,headers:{"content-type":"application/bond-compact-binary","client-id":"NO_AUTH","sdk-version":"ACT-Web-JS-"+clienttelemetry_build.version},complete:function(t){return i._SendCallback(d,r.tenantToken,o.sendEvents,t,n,e)}};sct.Utils.IsUint8ArrSupported()?(this._Verbose("Uint8Array is defined, send with binary format directly."),u.data=new Uint8Array(o.buffer)):(this._Verbose("Uint8Array is undefined, send with base64 encode."),u.data=Microsoft.Bond.Encoding.Base64.GetString(o.buffer),u.headers["content-encoding"]="base64"),r.tenantToken&&(u.headers["x-apikey"]=r.tenantToken);var d=t._tag;this._lastActiveTime=(new Date).getTime(),sct.Utils.ajax(u,n),this._Verbose("_Workthread, send via jquery, tag: "+d)}catch(c){this._Error("_WorkThread, exception: "+c)}},t.prototype._PackEvents=function(t,n){this._Verbose("_PackageEvents, total Count: "+n.length);var i=new e.datamodels.ClientToCollectorRequest,r=new e.datamodels.DataPackage;r.Source="JS_default_source",r.DataPackageId=e.datamodels.utils.GetGuid(),r.Timestamp=e.datamodels.utils.GetTimeStamp();var o,s=n;for(n=[];;){if(r.Records=[],r.Records.push.apply(r.Records,s),i.DataPackages=[],i.DataPackages.push(r),o=this._Serialize(i),this._Verbose(["_PackageEvents, sendEvents.length:",s.length,"buffer.length:",o.length,"MaxPackageSize:",this._MaxPackageSizeInBytes].join("")),o.length<this._MaxPackageSizeInBytes)break;if(1==s.length){s=[],o=null;break}var a=s.splice(0,Math.floor(s.length/2));this._Verbose("_PackageEvents, too large, package again"),n.push.apply(n,s),s=a}return this._Verbose(["_PakcageEvents done, sendEventsCount:",s.length,"buffer.length:",null==o?0:o.length,"remained events:",n.length].join("")),{buffer:o,sendEvents:s,remainedEvents:n}},t.prototype._Serialize=function(e){var t=new Microsoft.Bond.IO.MemoryStream,n=new Microsoft.Bond.CompactBinaryProtocolWriter(t);return e.Write(n),t.GetBuffer()},t.prototype._SendCallback=function(e,i,r,o,s,u){if(this._Verbose(["_SendCallback","tag:",e,"current tag:",t._tag,"tenantToken:",i,"events count:",r.length,"jqXHR:",o].join("")),u&&u(o?o.status:0,i,r),!s){var d=null!=o&&o.status>=200&&o.status<300;if(this._status<a.Started||e<t._tag)return void this._Verbose("_SendCallback, is not started, or tag is not the same, return");if(!d&&(!o||o.status&&400!=o.status))return this._Verbose("retry statusCode: "+(o?o.status:0)),this._eventsCache.AddEvents(i,r),void this._ScheduleTimer(!0);for(var c=0;c<this._listeners.length;++c)this._listeners[c](d?n.SENT:n.SEND_FAILED,o?o.status:0,i,r);this._eventsCache.IsEmpty()?(this._Verbose("eventsCache is empty, stop schedule"),this._CleanTimer()):(this._Verbose("eventsCache is not empty, schedule for next run"),this._ScheduleTimer(!1))}},t.prototype._CleanTimer=function(){this._Verbose("_CleanTimer(), timer: "+this._timer),
this._timer&&(clearTimeout(this._timer),this._timer=null)},t.prototype._ScheduleTimer=function(e){var t=this;if(!this._isPaused)if(this._Verbose("_ScheduleTimer: isRetry: "+e),this._CleanTimer(),e){this._Verbose("_ScheduleTimer, current factor: "+this._rescheduleFactor);var n=Math.floor(5*this._rescheduleFactor*(1+Math.random()));this._timer=setTimeout(function(){return t._WorkThread(null,!1)},1e3*n),this._Verbose("_ScheduleTimer, next try (s): "+n),this._rescheduleFactor<<=1,this._rescheduleFactor>64&&(this._rescheduleFactor=1)}else{var n=0,i=(new Date).getTime(),r=i-this._lastActiveTime;n=r>u.TimeIntervalForNextSendInMS()?0:u.TimeIntervalForNextSendInMS()-r,this._timer=setTimeout(function(){return t._WorkThread(null,!1)},n),this._Verbose("_ScheduleTimer, next try: "+n),this._rescheduleFactor=1}},t.prototype._Verbose=function(e){this._config.log&&this._config.log.Verbose("[TelemetryManagerImpl]: "+e)},t.prototype._Info=function(e){this._config.log&&this._config.log.Info("[TelemetryManagerImpl]: "+e)},t.prototype._Error=function(e){this._config.log&&this._config.log.Error("[TelemetryManagerImpl]: "+e)},t.prototype._Reset=function(){this._Verbose("Reset()"),this._CleanTimer(),this._lastActiveTime=0,this._rescheduleFactor=1,this._sendingEvents=[],this._eventsCache=new c},t.prototype.__GetListenerArray=function(){return this._listeners},t.prototype.__GetTotalEventsCount=function(){return this._eventsCache.GetTotalEventsCount()},t.prototype.__IsScheduled=function(){return null!=this._timer},t.prototype.__ChageMaxPackageSizeInKB=function(e){this._MaxPackageSizeInBytes=1024*e},t.prototype.__SetTestServerResponseHook=function(e){this._testServerResponseHook=e},t._eventTypeRegex=/^[a-zA-Z0-9]([a-zA-Z0-9]|_){2,98}[a-zA-Z0-9]$/,t._tag=0,t}(),c=function(){function e(){this._events={},this._tokens=[]}return e.prototype.AddEvents=function(e,t){t.length&&(this._events[e]||(this._events[e]=[],this._tokens.push(e)),this._events[e].push.apply(this._events[e],t))},e.prototype.IsEmpty=function(){return 0==this._tokens.length},e.prototype.DequeuEvents=function(){if(0==this._tokens.length)return null;var e=this._tokens.shift(),t=this._events[e];return delete this._events[e],{tenantToken:e,events:t}},e.prototype.GetTotalEventsCount=function(){var e=0;for(var t in this._events)e+=this._events[t].length;return e},e}()}(t=e._sender||(e._sender={}))}(t=e.telemetry||(e.telemetry={}))}(t=e.applications||(e.applications={}))}(microsoft||(microsoft={}));var microsoft;!function(e){var t;!function(t){var n;!function(t){var n=t._sender.TelemetryManagerFactory.CreateTelemetryManager(),i=function(){function e(){this.collectorUrl=null,this.enableAutoUserSession=!1,this.browserOverrides=new r}return e}();t.LogConfiguration=i;var r=function(){function e(){this.onSaveData=null,this.onGetData=null}return e}();t.LogConfigurationBrowserOverrides=r;var o=function(){function e(){this.value=null,this.pii=null}return e._isPii=function(e){return null===e||void 0===e||e===t.datamodels.PIIKind.NotSet||isNaN(e)?!1:void 0!==t.datamodels.PIIKind[e]},e}(),s=function(){function e(){this.name=null,this.timestamp=null,this.properties={},this.eventType=null}return e.prototype.setProperty=function(n,i,r){if(!n||!e._propertyNameRegex.test(n))throw new u(a.INVALID_PROPERTY_NAME);this.properties[n]=r?{value:i,pii:r!=t.datamodels.PIIKind.NotSet?r:null}:{value:i,pii:null}},e._propertyNameRegex=/^[a-zA-Z0-9](([a-zA-Z0-9|_|\.]){0,98}[a-zA-Z0-9])?$/,e}();t.EventProperties=s,function(e){e[e.INVALID_TENANT_TOKEN=1]="INVALID_TENANT_TOKEN",e[e.MISSING_EVENT_PROPERTIES_NAME=2]="MISSING_EVENT_PROPERTIES_NAME",e[e.INVALID_PROPERTY_NAME=3]="INVALID_PROPERTY_NAME",e[e.MISSING_FAILURE_SIGNATURE=5]="MISSING_FAILURE_SIGNATURE",e[e.MISSING_FAILURE_DETAIL=6]="MISSING_FAILURE_DETAIL",e[e.MISSING_PAGEVIEW_ID=7]="MISSING_PAGEVIEW_ID",e[e.MISSING_PAGEVIEW_NAME=8]="MISSING_PAGEVIEW_NAME",e[e.INVALID_SESSION_STATE=9]="INVALID_SESSION_STATE",e[e.INVALID_CONFIGURATION_USE_CUSTOM_GET_SET=10]="INVALID_CONFIGURATION_USE_CUSTOM_GET_SET"}(t.TelemetryError||(t.TelemetryError={}));var a=t.TelemetryError,u=function(){function e(e){this.errorCode=null,this.errorCode=e}return e.prototype.ErrorCode=function(){return this.errorCode},e.prototype.toString=function(){switch(this.errorCode){case a.INVALID_TENANT_TOKEN:return"Invalid tenant token";case a.MISSING_EVENT_PROPERTIES_NAME:return"Eventproperties.name can not be null or empty";case a.INVALID_PROPERTY_NAME:return"Invalid Key. Key does not conform to regular expression ^[a-zA-Z0-9](([a-zA-Z0-9|_|.]){0,98}[a-zA-Z0-9])?$";case a.MISSING_FAILURE_SIGNATURE:return"Failure signature can't be null or empty.";case a.MISSING_FAILURE_DETAIL:return"Failure detail can't be null or empty.";case a.MISSING_PAGEVIEW_ID:return"Pageview id can't be null or empty.";case a.MISSING_PAGEVIEW_NAME:return"Pageview name can't be null or empty.";case a.INVALID_SESSION_STATE:return"Session state has to be a value from the SessionState enum.";case a.INVALID_CONFIGURATION_USE_CUSTOM_GET_SET:return"Invalid configuration provided during initialization. Both onGetConfigData and onSaveConfigData must be provided together.  These are manditory when running in a non-brower enviornment";default:return"Unknown error"}},e}();t.Exception=u;var d=function(){function n(e){this.contextMap={},this.piiKind=t.datamodels.PIIKind.NotSet,this._allowDeviceInfoFields=!1,this._allowDeviceInfoFields=e}return n.prototype.setAppId=function(e){e&&(this.contextMap["AppInfo.Id"]=e)},n.prototype.setAppVersion=function(e){e&&(this.contextMap["AppInfo.Version"]=e)},n.prototype.setAppLanguage=function(e){e&&(this.contextMap["AppInfo.Language"]=e)},n.prototype.setDeviceId=function(e){e&&this._allowDeviceInfoFields&&(this.contextMap["DeviceInfo.Id"]=e,c.checkAndUpdateDeviceId(e))},n.prototype.setDeviceOsName=function(e){e&&this._allowDeviceInfoFields&&(this.contextMap["DeviceInfo.OsName"]=e)},n.prototype.setDeviceOsVersion=function(e){e&&this._allowDeviceInfoFields&&(this.contextMap["DeviceInfo.OsVersion"]=e)},n.prototype.setDeviceBrowserName=function(e){e&&this._allowDeviceInfoFields&&(this.contextMap["DeviceInfo.BrowserName"]=e)},n.prototype.setDeviceBrowserVersion=function(e){e&&this._allowDeviceInfoFields&&(this.contextMap["DeviceInfo.BrowserVersion"]=e)},n.prototype.setUserId=function(t,n,i){if(t&&(this.contextMap["UserInfo.Id"]=t),i)this.contextMap["UserInfo.IdType"]=i;else{var r;switch(n){case e.applications.telemetry.datamodels.PIIKind.SipAddress:r=e.applications.telemetry.datamodels.UserIdType.SipAddress;break;case e.applications.telemetry.datamodels.PIIKind.PhoneNumber:r=e.applications.telemetry.datamodels.UserIdType.PhoneNumber;break;case e.applications.telemetry.datamodels.PIIKind.SmtpAddress:r=e.applications.telemetry.datamodels.UserIdType.EmailAddress;break;default:r=e.applications.telemetry.datamodels.UserIdType.Unknown}this.contextMap["UserInfo.IdType"]=r}if(n)o._isPii(n)&&(this.piiKind=n);else{var s;switch(i){case e.applications.telemetry.datamodels.UserIdType.Skype:s=e.applications.telemetry.datamodels.PIIKind.Identity;break;case e.applications.telemetry.datamodels.UserIdType.EmailAddress:s=e.applications.telemetry.datamodels.PIIKind.SmtpAddress;break;case e.applications.telemetry.datamodels.UserIdType.PhoneNumber:s=e.applications.telemetry.datamodels.PIIKind.PhoneNumber;break;case e.applications.telemetry.datamodels.UserIdType.SipAddress:s=e.applications.telemetry.datamodels.PIIKind.SipAddress;break;default:s=e.applications.telemetry.datamodels.PIIKind.NotSet}o._isPii(s)&&(this.piiKind=s)}},n.prototype.setUserMsaId=function(e){e&&(this.contextMap["UserInfo.MsaId"]=e)},n.prototype.setUserANID=function(e){e&&(this.contextMap["UserInfo.ANID"]=e)},n.prototype.setUserAdvertisingId=function(e){e&&(this.contextMap["UserInfo.AdvertisingId"]=e)},n.prototype.setUserTimeZone=function(e){e&&(this.contextMap["UserInfo.TimeZone"]=e)},n.prototype.setUserLanguage=function(e){e&&(this.contextMap["UserInfo.Language"]=e)},n}();t.SemanticContext=d;var c=function(){function e(){}return e.initialize=function(n){this._overrides=n;var i=e._getAppLanguage();i&&e.semanticContext.setAppLanguage(i);var r=e._getUserLanguage();r&&e.semanticContext.setUserLanguage(r);var o=(new Date).getTimezoneOffset(),s=o%60,a=(o-s)/60,u="+";a>0&&(u="-"),e.semanticContext.setUserTimeZone(u+(10>a?"0"+a:a.toString())+":"+(10>s?"0"+s:s.toString()));var d=e._getUserAgent();d&&(e.semanticContext.setDeviceBrowserName(e._getBrowserName()),e.semanticContext.setDeviceBrowserVersion(e._getBrowserVersion()),e.semanticContext.setDeviceOsName(e._getOsName()),e.semanticContext.setDeviceOsVersion(e._getOsVersion()));var c=e._getData(e.DEVICE_ID_COOKIE);c&&""!=c||(c=t.datamodels.utils.GetGuid()),e.semanticContext.setDeviceId(c)},e.checkAndUpdateDeviceId=function(t){var n=e._getData(e.DEVICE_ID_COOKIE);n!=t&&(e._saveData(e.DEVICE_ID_COOKIE,t),e._saveData(e.FIRST_LAUNCH_TIME_COOKIE,(new Date).getTime().toString()));var i=e._getData(e.FIRST_LAUNCH_TIME_COOKIE);e.firstLaunchTime=parseInt(i)},e._saveData=function(e,t){if(this._overrides.onSaveData)this._overrides.onSaveData(e,t);else if("undefined"!=typeof document&&document.cookie){var n="expires=Mon, 31 Dec 2029 23:59:59 GMT";document.cookie=e+"="+t+"; "+n}},e._getData=function(e){if(this._overrides.onGetData)return this._overrides.onGetData(e)||"";if("undefined"!=typeof document&&document.cookie)for(var t=e+"=",n=document.cookie.split(";"),i=0;i<n.length;i++){for(var r=n[i],o=0;" "==r.charAt(o);)o++;if(r=r.substring(o),0==r.indexOf(t))return r.substring(t.length,r.length)}return""},e._getUserAgent=function(){return"undefined"!=typeof navigator?navigator.userAgent||"":""},e._getAppLanguage=function(){return"undefined"!=typeof document&&document.documentElement?document.documentElement.lang:null},e._getUserLanguage=function(){return"undefined"!=typeof navigator?navigator.userLanguage||navigator.language:null},e._userAgentContainsString=function(t){return e._getUserAgent().indexOf(t)>-1},e._isIe=function(){return e._userAgentContainsString("Trident")},e._isEdge=function(){return e._userAgentContainsString(e.BROWSERS.EDGE)},e._isOpera=function(){return e._userAgentContainsString("OPR/")},e._getBrowserName=function(){return e._isOpera()?e.BROWSERS.UNKNOWN:e._userAgentContainsString(e.BROWSERS.PHANTOMJS)?e.BROWSERS.PHANTOMJS:e._isEdge()?e.BROWSERS.EDGE:e._userAgentContainsString(e.BROWSERS.ELECTRON)?e.BROWSERS.ELECTRON:e._userAgentContainsString(e.BROWSERS.CHROME)?e.BROWSERS.CHROME:e._userAgentContainsString(e.BROWSERS.FIREFOX)?e.BROWSERS.FIREFOX:e._userAgentContainsString(e.BROWSERS.SAFARI)?e.BROWSERS.SAFARI:e._userAgentContainsString(e.BROWSERS.SKYPE_SHELL)?e.BROWSERS.SKYPE_SHELL:e._isIe()?e.BROWSERS.MSIE:e.BROWSERS.UNKNOWN},e._getBrowserVersion=function(){function t(){var t,n=e._getUserAgent(),i=n.match(new RegExp(e.BROWSERS.MSIE+" "+e.REGEX_VERSION));return i?i[1]:(t=n.match(new RegExp("rv:"+e.REGEX_VERSION)))?t[1]:void 0}function n(t){var n;return t===e.BROWSERS.SAFARI&&(t="Version"),n=e._getUserAgent().match(new RegExp(t+"/"+e.REGEX_VERSION)),n?n[1]:e.UNKNOWN_VERSION}return e._isIe()?t():n(e._getBrowserName())},e._getOsName=function(){var t=/(windows|win32)/i,n=/ arm;/i,i=/windows\sphone\s\d+\.\d+/i,r=/(macintosh|mac os x)/i,o=/(iPad|iPhone|iPod)(?=.*like Mac OS X)/i,s=/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)/i,a=/android/i;return e._getUserAgent().match(i)?e.OPERATING_SYSTEMS.WINDOWS_PHONE:e._getUserAgent().match(n)?e.OPERATING_SYSTEMS.WINDOWS_RT:e._getUserAgent().match(o)?e.OPERATING_SYSTEMS.IOS:e._getUserAgent().match(a)?e.OPERATING_SYSTEMS.ANDROID:e._getUserAgent().match(s)?e.OPERATING_SYSTEMS.LINUX:e._getUserAgent().match(r)?e.OPERATING_SYSTEMS.MACOSX:e._getUserAgent().match(t)?e.OPERATING_SYSTEMS.WINDOWS:e.OPERATING_SYSTEMS.UNKNOWN},e._getOsVersion=function(){function t(){var t=e._getUserAgent().match(new RegExp("Windows NT "+e.REGEX_VERSION));return t&&e.VERSION_MAPPINGS[t[1]]?e.VERSION_MAPPINGS[t[1]]:e.UNKNOWN_VERSION}function n(){var t=e._getUserAgent().match(new RegExp(e.OPERATING_SYSTEMS.MACOSX+" "+e.REGEX_VERSION_MAC));if(t){var n=t[1].replace(/_/g,"."),r=[];if(n){var o=i(n);return o?(r=n.split(o),r[0]):n}}return e.UNKNOWN_VERSION}function i(e){return e.indexOf(".")>-1?".":e.indexOf("_")>-1?"_":null}return e._getOsName()===e.OPERATING_SYSTEMS.WINDOWS?t():e._getOsName()===e.OPERATING_SYSTEMS.MACOSX?n():e.UNKNOWN_VERSION},e.semanticContext=new d(!0),e.firstLaunchTime=-1,e.BROWSERS={MSIE:"MSIE",CHROME:"Chrome",FIREFOX:"Firefox",SAFARI:"Safari",EDGE:"Edge",ELECTRON:"Electron",SKYPE_SHELL:"SkypeShell",PHANTOMJS:"PhantomJS",UNKNOWN:"Unknown"},e.OPERATING_SYSTEMS={WINDOWS:"Windows",MACOSX:"Mac OS X",WINDOWS_PHONE:"Windows Phone",WINDOWS_RT:"Windows RT",IOS:"iOS",ANDROID:"Android",LINUX:"Linux",UNKNOWN:"Unknown"},e.VERSION_MAPPINGS={5.1:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1","10.0":"10"},e.REGEX_VERSION="([\\d,.]+)",e.REGEX_VERSION_MAC="([\\d,_,.]+)",e.UNKNOWN_VERSION="Unknown",e.DEVICE_ID_COOKIE="MicrosoftApplicationsTelemetryDeviceId",e.FIRST_LAUNCH_TIME_COOKIE="MicrosoftApplicationsTelemetryFirstLaunchTime",e}();!function(e){e[e.STARTED=0]="STARTED",e[e.ENDED=1]="ENDED"}(t.SessionState||(t.SessionState={}));var l=t.SessionState,_=function(){function e(){}return e.initialize=function(t,i){if(!e._initialized){if(!t)throw new u(a.INVALID_TENANT_TOKEN);if(e._defaultToken=t,e._tmConfig.collectorUrl="https://browser.pipe.aria.microsoft.com/Collector/3.0/",e._configuration=i,!("undefined"!=typeof window||i&&i.browserOverrides&&i.browserOverrides.onGetData))throw new u(a.INVALID_CONFIGURATION_USE_CUSTOM_GET_SET);var o=new r;if(i&&(i.collectorUrl&&(e._tmConfig.collectorUrl=i.collectorUrl),i.browserOverrides)){if(i.browserOverrides.onGetData?!i.browserOverrides.onSaveData:!!i.browserOverrides.onSaveData)throw new u(a.INVALID_CONFIGURATION_USE_CUSTOM_GET_SET);o.onGetData=i.browserOverrides.onGetData,o.onSaveData=i.browserOverrides.onSaveData}n.Initialize(e._tmConfig),n.Start(),c.initialize(o),e._initialized=!0,"undefined"!=typeof window&&window.addEventListener&&(i&&i.enableAutoUserSession&&(e._logger=new f,e._logger.logSession(l.STARTED)),window.addEventListener("beforeunload",e._teardown))}},e.pauseTransmission=function(){n.Pause()},e.resumeTransmission=function(){n.Resume()},e.flush=function(e){n.Flush(e)},e.addCallbackListener=function(t){e._initialized&&n.AddListener(t)},e.setContext=function(t,n,i){e._contextProperties.setProperty(t,n,i)},e.isInitialized=function(){return e._initialized},e.getDefaultToken=function(){return e._defaultToken},e.getSemanticContext=function(){return e._semanticContext},e._getInitIdForToken=function(n){return e._initIdMap[n]||(e._initIdMap[n]=t.datamodels.utils.GetGuid()),e._initIdMap[n]},e._getSequenceForToken=function(t){return e._sequenceMap[t]||(e._sequenceMap[t]=0),e._sequenceMap[t]++,e._sequenceMap[t]},e._teardown=function(){e._logger&&e._logger.logSession(l.ENDED),e.flush()},e.__backToUninitialized=function(){e._tmConfig=new t._sender.TelemetryConfig,e._semanticContext=new d(!0),e._contextProperties=new s,e._configuration=null,n=t._sender.TelemetryManagerFactory.CreateTelemetryManager(),e._initialized=!1,e._initIdMap={},e._sequenceMap={}},e._initialized=!1,e._defaultToken=null,e._tmConfig=new t._sender.TelemetryConfig,e._logger=null,e._initIdMap={},e._sequenceMap={},e._configuration=null,e._contextProperties=new s,e._semanticContext=new d(!0),e}();t.LogManager=_;var f=function(){function e(e){this._initId=null,this._tenantToken=null,this._contextProperties=new s,this._semanticContext=new d(!1),this._sessionStartTime=0,this._sessionId=null,this._tenantToken=e?e:_.getDefaultToken(),this._initId=_._getInitIdForToken(this._tenantToken)}return e.prototype.logEvent=function(e){if(!e.name)throw new u(a.MISSING_EVENT_PROPERTIES_NAME);var t=this._createEventRecord(e.name,e.eventType);this._addPropertiesAndSendEvent(t,e)},e.prototype.logFailure=function(e,t,n,i,r){if(!e)throw new u(a.MISSING_FAILURE_SIGNATURE);if(!t)throw new u(a.MISSING_FAILURE_DETAIL);var o=this._createEventRecord("failure","failure");o.Extension.Add("Failure.Signature",e),o.Extension.Add("Failure.Detail",t),n&&o.Extension.Add("Failure.Category",n),i&&o.Extension.Add("Failure.Id",i),this._addPropertiesAndSendEvent(o,r)},e.prototype.logPageView=function(e,t,n,i,r,o){if(!e)throw new u(a.MISSING_PAGEVIEW_ID);if(!t)throw new u(a.MISSING_PAGEVIEW_NAME);var s=this._createEventRecord("pageview","pageview");s.Extension.Add("PageView.Id",e),s.Extension.Add("PageView.Name",t),n&&s.Extension.Add("PageView.Category",n),i&&s.Extension.Add("PageView.Uri",i),r&&s.Extension.Add("PageView.ReferrerUri",r),this._addPropertiesAndSendEvent(s,o)},e.prototype.logSession=function(e,n){if(e!==l.STARTED&&e!==l.ENDED)throw new u(a.INVALID_SESSION_STATE);var i=this._createEventRecord("session","session");if(e===l.STARTED){if(this._sessionStartTime>0)return;this._sessionStartTime=(new Date).getTime(),this._sessionId=t.datamodels.utils.GetGuid(),i.Extension.Add("Session.Id",this._sessionId),i.Extension.Add("Session.State","Started")}else if(e===l.ENDED){if(0==this._sessionStartTime)return;var r=Math.floor(((new Date).getTime()-this._sessionStartTime)/1e3);i.Extension.Add("Session.Duration",r.toString()),i.Extension.Add("Session.DurationBucket",this._getSessionDurationFromTime(r)),i.Extension.Add("Session.Id",this._sessionId),i.Extension.Add("Session.State","Ended"),this._sessionId=null,this._sessionStartTime=0}i.Extension.Add("Session.FirstLaunchTime",this._getISOString(new Date(c.firstLaunchTime))),this._addPropertiesAndSendEvent(i,n)},e.prototype.getSessionId=function(){return this._sessionId},e.prototype.setContext=function(e,t,n){this._contextProperties.setProperty(e,t,n)},e.prototype.getSemanticContext=function(){return this._semanticContext},e.prototype._getSessionDurationFromTime=function(e){return 0>e?"Undefined":3>=e?"UpTo3Sec":10>=e?"UpTo10Sec":30>=e?"UpTo30Sec":60>=e?"UpTo60Sec":180>=e?"UpTo3Min":600>=e?"UpTo10Min":1800>=e?"UpTo30Min":"Above30Min"},e.prototype._createEventRecord=function(e,n){var i=new t.datamodels.Record;n||(n="custom"),i.EventType=e.toLowerCase(),i.Type=n.toLowerCase(),i.Extension.Add("EventInfo.Source","JS_default_source"),i.Extension.Add("EventInfo.InitId",this._initId),i.Extension.Add("EventInfo.Sequence",_._getSequenceForToken(this._tenantToken).toString()),i.Extension.Add("EventInfo.Name",e.toLowerCase());var r=new Date;return i.Timestamp=t.datamodels.utils.GetTimeStampWithValue(r.getTime()),i.Extension.Add("EventInfo.Time",this._getISOString(r)),i.Extension.Add("EventInfo.SdkVersion","ACT-Web-JS-"+clienttelemetry_build.version),i},e.prototype._getISOString=function(e){function t(e){return 10>e?"0"+e:e.toString()}function n(e){return 10>e?"00"+e:100>e?"0"+e:e.toString()}return e.getUTCFullYear()+"-"+t(e.getUTCMonth()+1)+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes())+":"+t(e.getUTCSeconds())+"."+n(e.getUTCMilliseconds())+"Z"},e.prototype._addCustomPropertiesToEvent=function(e,t){this._addSemanticContext(e,c.semanticContext),this._addSemanticContext(e,_._semanticContext),this._addSemanticContext(e,this._semanticContext),this._sessionId&&e.Extension.Add("Session.Id",this._sessionId),this._addEventPropertiesToEvent(e,_._contextProperties),this._addEventPropertiesToEvent(e,this._contextProperties),this._addEventPropertiesToEvent(e,t)},e.prototype._addSemanticContext=function(e,n){if(n&&n.contextMap){var i=n.contextMap;for(var r in n.contextMap)"UserInfo.Id"==r&&n.piiKind!=t.datamodels.PIIKind.NotSet?e.AddOrReplacePII(r,i[r],n.piiKind):e.Extension.AddOrReplace(r,i[r])}},e.prototype._addEventPropertiesToEvent=function(e,n){if(n){n.timestamp&&n.timestamp>=new Date("1/1/2000").getTime()&&(e.Timestamp=t.datamodels.utils.GetTimeStampWithValue(n.timestamp),e.Extension.AddOrReplace("EventInfo.Time",this._getISOString(new Date(n.timestamp)))),n.name&&(e.EventType=n.name.toLowerCase(),e.Extension.AddOrReplace("EventInfo.Name",n.name.toLowerCase()));var i=n.properties;if(i)for(var r in i)r&&(i[r].value||i[r].value===!1||0==i[r].value||""==i[r].value)&&(o._isPii(i[r].pii)?(e.AddOrReplacePII(r,i[r].value.toString(),i[r].pii),e.Extension.Remove(r)):(e.Extension.AddOrReplace(r,i[r].value.toString()),e.PIIExtensions.Remove(r)))}},e.prototype._addPropertiesAndSendEvent=function(e,t){this._addCustomPropertiesToEvent(e,t),_.isInitialized()&&(this._sanitizeName(e),n.SendAsync(this._tenantToken,[e]))},e.prototype._sanitizeName=function(e){var t=e.EventType.replace(/\./g,"_");e.EventType=t,e.Extension.AddOrReplace("EventInfo.Name",t)},e}();t.Logger=f}(n=t.telemetry||(t.telemetry={}))}(t=e.applications||(e.applications={}))}(microsoft||(microsoft={})),"undefined"!=typeof module&&(module.exports=microsoft.applications.telemetry);
!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.LogManager=e()}}(function(){return function e(t,o,n){function r(s,a){if(!o[s]){if(!t[s]){var l="function"==typeof require&&require;if(!a&&l)return l(s,!0);if(i)return i(s,!0);var p=new Error("Cannot find module '"+s+"'");throw p.code="MODULE_NOT_FOUND",p}var u=o[s]={exports:{}};t[s][0].call(u.exports,function(e){var o=t[s][1][e];return r(o?o:e)},u,u.exports,e,t,o,n)}return o[s].exports}for(var i="function"==typeof require&&require,s=0;s<n.length;s++)r(n[s]);return r}({1:[function(e,t,o){"use strict";!function(e){e[e.Bookmarklet=0]="Bookmarklet",e[e.ChromeExtension=1]="ChromeExtension",e[e.EdgeExtension=2]="EdgeExtension",e[e.FirefoxExtension=3]="FirefoxExtension",e[e.SafariExtension=4]="SafariExtension"}(o.ClientType||(o.ClientType={}));o.ClientType},{}],2:[function(e,t,o){"use strict";var n=e("../extensions/invokeSource");!function(e){e[e.ChangeLog=0]="ChangeLog",e[e.Pdf=1]="Pdf",e[e.Product=2]="Product",e[e.Recipe=3]="Recipe",e[e.Video=4]="Video",e[e.WhatsNew=5]="WhatsNew"}(o.TooltipType||(o.TooltipType={}));var r,i=o.TooltipType;!function(e){function t(e){switch(e){case i.Pdf:return n.InvokeSource.PdfTooltip;case i.Product:return n.InvokeSource.ProductTooltip;case i.Recipe:return n.InvokeSource.RecipeTooltip;case i.Video:return n.InvokeSource.VideoTooltip;case i.WhatsNew:return n.InvokeSource.WhatsNewTooltip;default:throw Error("Invalid TooltipType passed in TooltipType.toInvokeSource")}}e.toInvokeSource=t}(r=o.TooltipTypeUtils||(o.TooltipTypeUtils={}))},{"../extensions/invokeSource":5}],3:[function(e,t,o){"use strict";var n=function(){function e(e){this.subscriptions=[],this.t=e}return e.prototype.subscribe=function(e,t){void 0===t&&(t={}),void 0===t.times&&(t.times=1/0),void 0===t.callOnSubscribe&&(t.callOnSubscribe=!0),t.callOnSubscribe&&e(this.t),t.times>0&&this.subscriptions.push({func:e,times:t.times})},e.prototype.unsubscribe=function(e){for(var t=0;t<this.subscriptions.length;t++)if(e===this.subscriptions[t].func)return void this.subscriptions.splice(t,1)},e.prototype.set=function(e){return this.t!==e&&(this.t=e,this.notifySubscribers()),this},e.prototype.get=function(){return this.t},e.prototype.forceUpdate=function(){this.notifySubscribers()},e.prototype.equals=function(e){return this.t===e},e.prototype.toString=function(){return this.t?this.t.toString():"undefined"},e.prototype.notifySubscribers=function(){for(var e=this.subscriptions.length,t=0;t<e;t++){this.subscriptions[t].times--,this.subscriptions[t].func(this.t);var o=this.subscriptions[t]&&0===this.subscriptions[t].times;o&&this.subscriptions.splice(t,1),this.subscriptions[t]&&!o||(e--,t--)}},e.subscribe=function(e,t){for(var o=0;o<e.length;o++)e[o].subscribe(function(){for(var o=[],n=0;n<e.length;n++)o.push(e[n].get());t.apply(this,o)})},e}();o.SmartValue=n},{}],4:[function(e,t,o){"use strict";var n;!function(e){var t;!function(e){e.heightAnimator="height-animator",e.panelAnimator="panel-animator",e.change="change",e.changes="changes",e.changeBody="change-body",e.changeDescription="change-description",e.changeImage="change-image",e.changeTitle="change-title",e.textAreaInput="textAreaInput",e.textAreaInputMirror="textAreaInputMirror",e.deleteHighlightButton="delete-highlight",e.highlightable="highlightable",e.highlighted="highlighted",e.regionSelection="region-selection",e.regionSelectionImage="region-selection-image",e.regionSelectionRemoveButton="region-selection-remove-button",e.spinner="spinner",e.tooltip="tooltip",e.centeredInPreview="centered-in-preview"}(t=e.Classes||(e.Classes={}));var o;!function(e){e.clipperInfo="ClipperInfo"}(o=e.Cookies||(e.Cookies={}));var n;!function(e){e.annotationContainer="annotationContainer",e.annotationField="annotationField",e.annotationFieldMirror="annotationFieldMirror",e.annotationPlaceholder="annotationPlaceholder",e.bookmarkThumbnail="bookmarkThumbnail",e.bookmarkPreviewContentContainer="bookmarkPreviewContentContainer",e.bookmarkPreviewInnerContainer="bookmarkPreviewInnerContainer",e.clipperApiProgressContainer="clipperApiProgressContainer",e.dialogBackButton="dialogBackButton",e.dialogButtonContainer="dialogButtonContainer",e.dialogDebugMessageContainer="dialogDebugMessageContainer",e.dialogMessageContainer="dialogMessageContainer",e.dialogContentContainer="dialogContentContainer",e.dialogMessage="dialogMessage",e.dialogTryAgainButton="dialogTryAgainButton",e.highlightablePreviewBody="highlightablePreviewBody",e.apiErrorMessage="apiErrorMessage",e.backToHomeButton="backToHomeButton",e.clipperFailureContainer="clipperFailureContainer",e.refreshPageButton="refreshPageButton",e.tryAgainButton="tryAgainButton",e.clipperFooterContainer="clipperFooterContainer",e.currentUserControl="currentUserControl",e.currentUserDetails="currentUserDetails",e.currentUserEmail="currentUserEmail",e.currentUserId="currentUserId",e.currentUserName="currentUserName",e.feedbackButton="feedbackButton",e.feedbackImage="feedbackImage",e.signOutButton="signOutButton",e.userDropdownArrow="userDropdownArrow",e.userSettingsContainer="userSettingsContainer",e.clipperLoadingContainer="clipperLoadingContainer",e.closeButton="closeButton",e.closeButtonContainer="closeButtonContainer",e.mainController="mainController",e.saveToLocationContainer="saveToLocationContainer",e.clipButton="clipButton",e.clipButtonContainer="clipButtonContainer",e.previewBody="previewBody",e.previewContentContainer="previewContentContainer",e.previewHeader="previewHeader",e.previewHeaderContainer="previewHeaderContainer",e.previewHeaderInput="previewHeaderInput",e.previewHeaderInputMirror="previewHeaderInputMirror",e.previewTitleContainer="previewTitleContainer",e.previewSubtitleContainer="previewSubtitleContainer",e.previewInnerContainer="previewInnerContainer",e.previewOptionsContainer="previewOptionsContainer",e.previewInnerWrapper="previewInnerWrapper",e.previewOuterContainer="previewOuterContainer",e.previewUrlContainer="previewUrlContainer",e.previewNotesContainer="previewNotesContainer",e.fullPageControl="fullPageControl",e.fullPageHeaderTitle="fullPageHeaderTitle",e.addAnotherRegionButton="addAnotherRegionButton",e.addRegionControl="addRegionControl",e.regionControl="regionControl",e.regionHeaderTitle="regionHeaderTitle",e.highlightControl="highlightControl",e.highlightButton="highlightButton",e.decrementFontSize="decrementFontSize",e.incrementFontSize="incrementFontSize",e.serifControl="serifControl",e.sansSerif="sansSerif",e.serif="serif",e.bookmarkControl="bookmarkControl",e.bookmarkHeaderTitle="bookmarkHeaderTitle",e.ratingsButtonFeedbackNo="ratingsButtonFeedbackNo",e.ratingsButtonFeedbackYes="ratingsButtonFeedbackYes",e.ratingsButtonInitNo="ratingsButtonInitNo",e.ratingsButtonInitYes="ratingsButtonInitYes",e.ratingsButtonRateNo="ratingsButtonRateNo",e.ratingsButtonRateYes="ratingsButtonRateYes",e.ratingsPromptContainer="ratingsPromptContainer",e.regionInstructionsContainer="regionInstructionsContainer",e.regionClipCancelButton="regionClipCancelButton",e.innerFrame="innerFrame",e.outerFrame="outerFrame",e.regionSelectorContainer="regionSelectorContainer",e.spinnerText="spinnerText",e.locationPickerContainer="locationPickerContainer",e.signInButtonMsa="signInButtonMsa",e.signInButtonOrgId="signInButtonOrgId",e.signInContainer="signInContainer",e.signInLogo="signInLogo",e.signInMessageLabelContainer="signInMessageLabelContainer",e.signInText="signInText",e.clipperSuccessContainer="clipperSuccessContainer",e.launchOneNoteButton="launchOneNoteButton",e.pageNavAnimatedTooltip="pageNavAnimatedTooltip",e.unsupportedBrowserContainer="unsupportedBrowserContainer",e.unsupportedBrowserPanel="unsupportedBrowserPanel",e.changeLogSubPanel="changeLogSubPanel",e.checkOutWhatsNewButton="checkOutWhatsNewButton",e.proceedToWebClipperButton="proceedToWebClipperButton",e.whatsNewTitleSubPanel="whatsNewTitleSubPanel",e.clipperRootScript="oneNoteCaptureRootScript",e.clipperUiFrame="oneNoteWebClipper",e.clipperPageNavFrame="oneNoteWebClipperPageNav",e.clipperExtFrame="oneNoteWebClipperExtension",e.brandingContainer="brandingContainer"}(n=e.Ids||(e.Ids={}));var r;!function(e){e.accept="Accept",e.appIdKey="MS-Int-AppId",e.correlationId="X-CorrelationId",e.noAuthKey="X-NoAuth",e.userSessionIdKey="X-UserSessionId"}(r=e.HeaderValues||(e.HeaderValues={}));var i;!function(e){e.debugLoggingInjectedAndExtension="DEBUGLOGGINGINJECTED_AND_EXTENSION",e.extensionAndUi="EXTENSION_AND_UI",e.injectedAndUi="INJECTED_AND_UI",e.injectedAndExtension="INJECTED_AND_EXTENSION",e.extensionAndPageNavUi="EXTENSION_AND_PAGENAVUI",e.pageNavInjectedAndPageNavUi="PAGENAVINJECTED_AND_PAGENAVUI",e.pageNavInjectedAndExtension="PAGENAVINJECTED_AND_EXTENSION"}(i=e.CommunicationChannels||(e.CommunicationChannels={}));var s;!function(e){e.clipperStrings="CLIPPER_STRINGS",e.clipperStringsFrontLoaded="CLIPPER_STRINGS_FRONT_LOADED",e.closePageNavTooltip="CLOSE_PAGE_NAV_TOOLTIP",e.createHiddenIFrame="CREATE_HIDDEN_IFRAME",e.ensureFreshUserBeforeClip="ENSURE_FRESH_USER_BEFORE_CLIP",e.escHandler="ESC_HANDLER",e.getInitialUser="GET_INITIAL_USER",e.getPageNavTooltipProps="GET_PAGE_NAV_TOOLTIP_PROPS",e.getStorageValue="GET_STORAGE_VALUE",e.getMultipleStorageValues="GET_MULTIPLE_STORAGE_VALUES",e.getTooltipToRenderInPageNav="GET_TOOLTIP_TO_RENDER_IN_PAGE_NAV",e.hideUi="HIDE_UI",e.invokeClipper="INVOKE_CLIPPER",e.invokeClipperFromPageNav="INVOKE_CLIPPER_FROM_PAGE_NAV",e.invokeDebugLogging="INVOKE_DEBUG_LOGGING",e.invokePageNav="INVOKE_PAGE_NAV",e.noOpTracker="NO_OP_TRACKER",e.onSpaNavigate="ON_SPA_NAVIGATE",e.refreshPage="REFRESH_PAGE",e.showRefreshClipperMessage="SHOW_REFRESH_CLIPPER_MESSAGE",e.setInjectOptions="SET_INJECT_OPTIONS",e.setInvokeOptions="SET_INVOKE_OPTIONS",e.setStorageValue="SET_STORAGE_VALUE",e.signInUser="SIGN_IN_USER",e.signOutUser="SIGN_OUT_USER",e.tabToLowestIndexedElement="TAB_TO_LOWEST_INDEXED_ELEMENT",e.takeTabScreenshot="TAKE_TAB_SCREENSHOT",e.telemetry="TELEMETRY",e.toggleClipper="TOGGLE_CLIPPER",e.unloadHandler="UNLOAD_HANDLER",e.updateFrameHeight="UPDATE_FRAME_HEIGHT",e.updatePageInfoIfUrlChanged="UPDATE_PAGE_INFO_IF_URL_CHANGED"}(s=e.FunctionKeys||(e.FunctionKeys={}));var a;!function(e){e.tab=9,e.enter=13,e.esc=27}(a=e.KeyCodes||(e.KeyCodes={}));var l;!function(e){e.clientInfo="CLIENT_INFO",e.isFullScreen="IS_FULL_SCREEN",e.pageInfo="PAGE_INFO",e.sessionId="SESSION_ID",e.user="USER"}(l=e.SmartValueKeys||(e.SmartValueKeys={}));var p;!function(e){e.sectionPickerContainerHeight=280,e.clipperUiWidth=322,e.clipperUiTopRightOffset=20,e.clipperUiDropShadowBuffer=7,e.clipperUiInnerPadding=30;var t;!function(e){e.oneNoteHighlightColor="#fefe56"}(t=e.Colors||(e.Colors={}))}(p=e.Styles||(e.Styles={}));var u;!function(e){e.serviceDomain="https://www.onenote.com",e.augmentationApiUrl=e.serviceDomain+"/onaugmentation/clipperextract/v1.0/",e.changelogUrl=e.serviceDomain+"/whatsnext/webclipper",e.clipperFeedbackUrl=e.serviceDomain+"/feedback",e.clipperInstallPageUrl=e.serviceDomain+"/clipper/installed",e.fullPageScreenshotUrl=e.serviceDomain+"/onaugmentation/clipperDomEnhancer/v1.0/",e.localizedStringsUrlBase=e.serviceDomain+"/strings?ids=WebClipper.",e.userFlightingEndpoint=e.serviceDomain+"/webclipper/userflight",e.msaDomain="https://login.live.com",e.orgIdDomain="https://login.microsoftonline.com";var t;!function(t){t.authRedirectUrl=e.serviceDomain+"/webclipper/auth",t.signInUrl=e.serviceDomain+"/webclipper/signin",t.signOutUrl=e.serviceDomain+"/webclipper/signout",t.userInformationUrl=e.serviceDomain+"/webclipper/userinfo"}(t=e.Authentication||(e.Authentication={}));var o;!function(e){e.authType="authType",e.category="category",e.changelogLocale="omkt",e.channel="channel",e.clientType="clientType",e.clipperId="clipperId",e.clipperVersion="clipperVersion",e.correlationId="correlationId",e.error="error",e.errorDescription="errorDescription",e.event="event",e.eventName="eventName",e.failureId="failureId",e.failureInfo="failureInfo",e.failureType="failureType",e.inlineInstall="inlineInstall",e.label="label",e.noOpType="noOpType",e.stackTrace="stackTrace",e.timeoutInMs="timeoutInMs",e.url="url",e.userSessionId="userSessionId",e.wdFromClipper="wdfromclipper"}(o=e.QueryParams||(e.QueryParams={}))}(u=e.Urls||(e.Urls={}));var c;!function(e){e.oneNoteClipperUsage="OneNoteClipperUsage"}(c=e.LogCategories||(e.LogCategories={}));var g;!function(e){e.fontSizeStep=2,e.maxClipSuccessForRatingsPrompt=12,e.maximumJSTimeValue=864e13,e.maximumFontSize=72,e.maximumNumberOfTimesToShowTooltips=3,e.minClipSuccessForRatingsPrompt=4,e.minimumFontSize=8,e.minTimeBetweenBadRatings=6048e6,e.noOpTrackerTimeoutDuration=2e4,e.timeBetweenDifferentTooltips=6048e5,e.timeBetweenSameTooltip=18144e5,e.timeBetweenTooltips=18144e5}(g=e.Settings||(e.Settings={}))}(n=o.Constants||(o.Constants={}))},{}],5:[function(e,t,o){"use strict";!function(e){e[e.Bookmarklet=0]="Bookmarklet",e[e.ContextMenu=1]="ContextMenu",e[e.ExtensionButton=2]="ExtensionButton",e[e.WhatsNewTooltip=3]="WhatsNewTooltip",e[e.PdfTooltip=4]="PdfTooltip",e[e.ProductTooltip=5]="ProductTooltip",e[e.RecipeTooltip=6]="RecipeTooltip",e[e.VideoTooltip=7]="VideoTooltip"}(o.InvokeSource||(o.InvokeSource={}));o.InvokeSource},{}],6:[function(e,t,o){"use strict";var n;!function(t){function o(e){if(!e)throw new Error("stringId must be a non-empty string, but was: "+e);if(a){var t=a[e];if(t)return t}var o=u[e];if(o)return o;throw new Error("getLocalizedString could not find a localized or fallback string: "+e)}function n(e){a=e}function r(e){return"font-family: "+i(e)+";"}function i(e){if(p[e])return p[e];var t="WebClipper.FontFamily."+l[e].toString(),n=o(t);return p[e]=s(n),p[e]}function s(e){if(!e)return"";for(var t=e.split(","),o=0;o<t.length;o++)t[o]=t[o].trim(),t[o].length>0&&t[o].indexOf(" ")>=0&&"'"!==t[o][0]&&"'"!==t[o][t.length-1]&&(t[o]="'"+t[o]+"'");return t.join(",")}!function(e){e[e.Regular=0]="Regular",e[e.Bold=1]="Bold",e[e.Light=2]="Light",e[e.Semibold=3]="Semibold",e[e.Semilight=4]="Semilight"}(t.FontFamily||(t.FontFamily={}));var a,l=t.FontFamily,p={},u=e("../../strings.json");t.getLocalizedString=o,t.setLocalizedStrings=n,t.getFontFamilyAsStyle=r,t.getFontFamily=i,t.formatFontFamily=s}(n=o.Localization||(o.Localization={}))},{"../../strings.json":37}],7:[function(e,t,o){"use strict";var n=e("./log"),r=function(){function e(){}return e.prototype.logJsonParseUnexpected=function(e){this.logFailure(n.Failure.Label.JsonParse,n.Failure.Type.Unexpected,void 0,e)},e}();o.Logger=r},{"./log":15}],8:[function(e,t,o){"use strict";var n=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)},r=e("../settings"),i=e("../utils"),s=e("./log"),a=e("./loggerDecorator"),l=e("./logHelpers"),p=microsoft.applications.telemetry.EventProperties,u=function(e){function t(t,o){e.call(this,o),microsoft.applications.telemetry.LogManager.getDefaultToken()||microsoft.applications.telemetry.LogManager.initialize(t),this.logger=new microsoft.applications.telemetry.Logger,this.semanticContext=this.logger.getSemanticContext();var n="Debug console logger is ON - now logging to both Aria ("+r.Settings.getSetting("Misc_Data_Endpoint_Id").toUpperCase()+") and console.";e.prototype.logTrace.call(this,s.Trace.Label.DebugMode,s.Trace.Level.Information,n)}return n(t,e),t.prototype.generateSessionId=function(){return this.logger.getSessionId()},t.prototype.outputClickEvent=function(e){var t=l.LogHelpers.createClickEventAsJson(e),o=this.createEventProperties(t);this.logger.logEvent(o)},t.prototype.outputEvent=function(e){var t=l.LogHelpers.createLogEventAsJson(e),o=this.createEventProperties(t);this.logger.logEvent(o)},t.prototype.outputSessionStart=function(){var e=l.LogHelpers.createSessionStartEventAsJson(),t=this.createEventProperties(e);this.logger.logSession(s.Session.State.Started,t)},t.prototype.outputSessionEnd=function(e){var t=l.LogHelpers.createSessionEndEventAsJson(e),o=this.createEventProperties(t);this.logger.logSession(s.Session.State.Ended,o)},t.prototype.outputFailure=function(e,t,o,n){var r=l.LogHelpers.createFailureEventAsJson(e,t,o,n),i=this.createEventProperties(r);this.logger.logEvent(i)},t.prototype.outputUserFunnel=function(e){var t=l.LogHelpers.createFunnelEventAsJson(e),o=this.createEventProperties(t);this.logger.logEvent(o)},t.prototype.outputTrace=function(e,t,o){var n=l.LogHelpers.createTraceEventAsJson(e,t,o),r=this.createEventProperties(n);this.logger.logEvent(r)},t.prototype.outputSetContext=function(e,t){switch(e){case s.Context.Custom.AppInfoId:this.semanticContext.setAppId(t);break;case s.Context.Custom.AppInfoVersion:this.semanticContext.setAppVersion(t);break;case s.Context.Custom.DeviceInfoId:microsoft.applications.telemetry.LogManager.getSemanticContext().setDeviceId(t);break;case s.Context.Custom.UserInfoId:this.semanticContext.setUserId(t,0);break;case s.Context.Custom.UserInfoLanguage:this.semanticContext.setUserLanguage(t);break;case s.Context.Custom.SessionId:break;default:this.logger.setContext(s.Context.toString(e),t)}},t.prototype.onNavigateAway=function(){microsoft.applications.telemetry.LogManager.flush()},t.prototype.createEventProperties=function(e){var t=new p;for(var o in e)if(e.hasOwnProperty(o)){if(o===s.PropertyName.Reserved.EventType){t.name=e[o].toString();continue}var n=i.Utils.isNullOrUndefined(e[o])?s.unknownValue:e[o].toString();t.setProperty(o,n)}return t},t.prototype.formatUserLanguage=function(e){return e?e.replace("_","-"):void 0},t}(a.LoggerDecorator);o.AriaLoggerDecorator=u},{"../settings":34,"../utils":35,"./log":15,"./logHelpers":16,"./loggerDecorator":19}],9:[function(e,t,o){"use strict";var n=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)},r=e("./communicatorLoggerPure"),i=e("./loggerDecorator"),s=function(e){function t(t,o){e.call(this,{component:o}),this.pureLogger=new r.CommunicatorLoggerPure(t)}return n(t,e),t.prototype.outputEvent=function(e){this.pureLogger.logEvent(e)},t.prototype.outputFailure=function(e,t,o,n){this.pureLogger.logFailure(e,t,o,n)},t.prototype.outputUserFunnel=function(e){this.pureLogger.logUserFunnel(e)},t.prototype.outputSessionStart=function(){this.pureLogger.logSessionStart()},t.prototype.outputSessionEnd=function(e){this.pureLogger.logSessionEnd(e)},t.prototype.outputTrace=function(e,t,o){this.pureLogger.logTrace(e,t,o)},t.prototype.outputClickEvent=function(e){this.pureLogger.logClickEvent(e)},t.prototype.outputSetContext=function(e,t){this.pureLogger.setContextProperty(e,t)},t}(i.LoggerDecorator);o.CommunicatorLoggerDecorator=s},{"./communicatorLoggerPure":10,"./loggerDecorator":19}],10:[function(e,t,o){"use strict";var n=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)},r=e("../constants"),i=e("./log"),s=e("./logger"),a=function(e){function t(t){e.call(this),this.communicator=t}return n(t,e),t.prototype.logEvent=function(e){e.timerWasStopped()||e.stopTimer(),this.sendDataPackage(i.LogMethods.logEvent,[e.getEventCategory(),e.getEventData()])},t.prototype.logFailure=function(e,t,o,n){this.sendDataPackage(i.LogMethods.logFailure,arguments)},t.prototype.logUserFunnel=function(e){this.sendDataPackage(i.LogMethods.logFunnel,arguments)},t.prototype.logSessionStart=function(){this.sendDataPackage(i.LogMethods.logSessionStart,arguments)},t.prototype.logSessionEnd=function(e){this.sendDataPackage(i.LogMethods.logSessionEnd,arguments)},t.prototype.logTrace=function(e,t,o){o?this.sendDataPackage(i.LogMethods.logTrace,[e,t,o]):this.sendDataPackage(i.LogMethods.logTrace,[e,t])},t.prototype.pushToStream=function(e,t){this.sendDataPackage(i.LogMethods.pushToStream,arguments)},t.prototype.logClickEvent=function(e){this.sendDataPackage(i.LogMethods.logClickEvent,arguments)},t.prototype.setContextProperty=function(e,t){this.sendDataPackage(i.LogMethods.setContextProperty,arguments)},t.prototype.sendDataPackage=function(e,t){var o={methodName:e,methodArgs:Object.keys(t).map(function(e){return t[e]})};this.communicator.callRemoteFunction(r.Constants.FunctionKeys.telemetry,{param:o})},t}(s.Logger);o.CommunicatorLoggerPure=a},{"../constants":4,"./log":15,"./logger":18}],11:[function(e,t,o){"use strict";var n=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)},r=e("./consoleLoggerPure"),i=e("./loggerDecorator"),s=function(e){function t(t,o){e.call(this,o),this.pureConsoleLogger=new r.ConsoleLoggerPure(t)}return n(t,e),t.prototype.outputEvent=function(e){this.pureConsoleLogger.logEvent(e)},t.prototype.outputFailure=function(e,t,o,n){this.pureConsoleLogger.logFailure(e,t,o,n)},t.prototype.outputUserFunnel=function(e){this.pureConsoleLogger.logUserFunnel(e)},t.prototype.outputSessionStart=function(){this.pureConsoleLogger.logSessionStart()},t.prototype.outputSessionEnd=function(e){this.pureConsoleLogger.logSessionEnd(e)},t.prototype.outputTrace=function(e,t,o){this.pureConsoleLogger.logTrace(e,t,o)},t.prototype.outputClickEvent=function(e){this.pureConsoleLogger.logClickEvent(e)},t.prototype.outputSetContext=function(e,t){this.pureConsoleLogger.setContextProperty(e,t)},t}(i.LoggerDecorator);o.ConsoleLoggerDecorator=s},{"./consoleLoggerPure":12,"./loggerDecorator":19}],12:[function(e,t,o){"use strict";var n=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)},r=e("./log"),i=e("./consoleLoggerShell"),s=e("./Logger"),a=e("./logHelpers"),l=function(e){function t(t){e.call(this),this.consoleShell=new i.ConsoleLoggerShell(t)}return n(t,e),t.prototype.logEvent=function(e){var t=a.LogHelpers.createLogEventAsJson(e);this.consoleShell.logToConsole(t)},t.prototype.logFailure=function(e,t,o,n){var r=a.LogHelpers.createFailureEventAsJson(e,t,o,n);this.consoleShell.logToConsole(r)},t.prototype.logUserFunnel=function(e){var t=a.LogHelpers.createFunnelEventAsJson(e);this.consoleShell.logToConsole(t)},t.prototype.logSessionStart=function(){var e=a.LogHelpers.createSessionStartEventAsJson();this.consoleShell.logToConsole(e)},t.prototype.logSessionEnd=function(e){var t=a.LogHelpers.createSessionEndEventAsJson(e);this.consoleShell.logToConsole(t)},t.prototype.logTrace=function(e,t,o){var n=a.LogHelpers.createTraceEventAsJson(e,t,o);this.consoleShell.logToConsole(n)},t.prototype.pushToStream=function(e,t){},t.prototype.logClickEvent=function(e){var t=a.LogHelpers.createClickEventAsJson(e);this.consoleShell.logToConsole(t)},t.prototype.setContextProperty=function(e,t){this.consoleShell.setContextProperty(r.Context.toString(e),t)},t}(s.Logger);o.ConsoleLoggerPure=l},{"./Logger":7,"./consoleLoggerShell":13,"./log":15,"./logHelpers":16}],13:[function(e,t,o){"use strict";var n=e("./log"),r=function(){function e(e){this.context={},this.consoleOutput=e}return e.prototype.logToConsole=function(e){if(!e)throw new Error("'event' argument to logToConsole was: "+e);var t=e[n.PropertyName.Reserved.Level];e[n.PropertyName.Reserved.Status]!==n.Status[n.Status.Failed]&&e[n.PropertyName.Reserved.Category]!==n.PropertyName.Reserved.WebClipper+"."+n.Failure.category||(t=n.Trace.Level[n.Trace.Level.Error]);var o=this.consoleOutput,r="";r+="["+e[n.PropertyName.Reserved.EventName]+"]",r+=t?" ["+t+"]":"",r+=n.PropertyName.Reserved.Message in e?" "+e[n.PropertyName.Reserved.Message]:"";var i=this.combineContextAndEvent(e);switch(n.Trace.Level[t]){case n.Trace.Level.Warning:o.warn(r,i);break;case n.Trace.Level.Error:o.error(r,i);break;case n.Trace.Level.Verbose:case n.Trace.Level.Information:o.info(r,i);break;default:o.log(r,i)}},e.prototype.setContextProperty=function(e,t){this.context[e]=t},e.prototype.combineContextAndEvent=function(e){var t={};for(var o in this.context)this.context.hasOwnProperty(o)&&(t[o]=this.context[o]);for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);return t},e}();o.ConsoleLoggerShell=r},{"./log":15}],14:[function(e,t,o){"use strict";var n=e("../utils"),r=e("./log"),i=function(){function e(){}return e.prototype.requirementsAreMet=function(e){return!0},e}();o.NoRequirements=i;var s=function(){function e(e){this.prodProperties=[r.Context.toString(r.Context.Custom.AppInfoId),r.Context.toString(r.Context.Custom.AppInfoVersion),r.Context.toString(r.Context.Custom.DeviceInfoId),r.Context.toString(r.Context.Custom.BrowserLanguage),r.Context.toString(r.Context.Custom.ClipperType),r.Context.toString(r.Context.Custom.FlightInfo),r.Context.toString(r.Context.Custom.InPrivateBrowsing)],this.requiredProperties=e?e:this.prodProperties}return e.prototype.requirementsAreMet=function(e){if(n.Utils.isNullOrUndefined(e))return!1;for(var t=0;t<this.requiredProperties.length;++t){var o=this.requiredProperties[t];if(!e.hasOwnProperty(o))return!1}return!0},e}();o.ProductionRequirements=s},{"../utils":35,"./log":15}],15:[function(e,t,o){"use strict";function n(e,t){switch(e.methodName){case i.LogMethods.logEvent:var o=e.methodArgs[0],n=e.methodArgs[1];t.logEvent.apply(t,[r.Event.createEvent(o,n)]);break;case i.LogMethods.logFailure:t.logFailure.apply(t,e.methodArgs);break;case i.LogMethods.pushToStream:t.pushToStream.apply(t,e.methodArgs);break;case i.LogMethods.logFunnel:t.logUserFunnel.apply(t,e.methodArgs);break;case i.LogMethods.logSessionStart:t.logSessionStart.apply(t,e.methodArgs);break;case i.LogMethods.logSessionEnd:t.logSessionEnd.apply(t,e.methodArgs);break;case i.LogMethods.logClickEvent:t.logClickEvent.apply(t,e.methodArgs);break;case i.LogMethods.setContextProperty:t.setContextProperty.apply(t,e.methodArgs);break;case i.LogMethods.logTrace:default:t.logTrace.apply(t,e.methodArgs)}}var r=e("./submodules/event"),i=e("./submodules/logMethods");o.contextPropertyNameRegex=/^[a-zA-Z0-9](([a-zA-Z0-9|_]){0,98}[a-zA-Z0-9])?$/,o.enableConsoleLogging="enable_console_logging",o.reportData="ReportData",o.unknownValue="unknown",o.parseAndLogDataPackage=n;var s=e("./submodules/click");o.Click=s.Click;var a=e("./submodules/context");o.Context=a.Context;var l=e("./submodules/errorUtils");o.ErrorUtils=l.ErrorUtils;var p=e("./submodules/event");o.Event=p.Event;var u=e("./submodules/failure");o.Failure=u.Failure;var c=e("./submodules/funnel");o.Funnel=c.Funnel;var g=e("./submodules/logMethods");o.LogMethods=g.LogMethods;var d=e("./submodules/noop");o.NoOp=d.NoOp;var h=e("./submodules/propertyName");o.PropertyName=h.PropertyName;var m=e("./submodules/session");o.Session=m.Session;var f=e("./submodules/status");o.Status=f.Status;var C=e("./submodules/trace");o.Trace=C.Trace},{"./submodules/click":21,"./submodules/context":22,"./submodules/errorUtils":23,"./submodules/event":24,"./submodules/failure":25,"./submodules/funnel":26,"./submodules/logMethods":27,"./submodules/noop":28,"./submodules/propertyName":29,"./submodules/session":30,"./submodules/status":31,"./submodules/trace":32}],16:[function(e,t,o){"use strict";var n,r=e("./log");!function(e){function t(e,t){var o={};o[r.PropertyName.Reserved.EventType]=r.reportData,o[r.PropertyName.Reserved.Label]=t;var n=r.PropertyName.Reserved.WebClipper+"."+e;return o[r.PropertyName.Reserved.Category]=n,o[r.PropertyName.Reserved.EventName]=n+"."+t,o}function o(t){if(!t)throw new Error("Button clicked without an ID! Logged with ID "+JSON.stringify(t));var o=e.createBaseEventAsJson(r.Click.category,t);return o}function n(t){t.timerWasStopped()||t.stopTimer();var o=t.getEventCategory(),n=e.createBaseEventAsJson(r.Event.Category[o],t.getLabel());switch(n[r.PropertyName.Reserved.Duration]=t.getDuration(),d(n,t.getCustomProperties()),o){case r.Event.Category.BaseEvent:break;case r.Event.Category.PromiseEvent:i(n,t);break;case r.Event.Category.StreamEvent:s(n,t);break;default:throw new Error("createLogEvent does not specify a case for event category: "+r.Event.Category[o])}return n}function i(e,t){var o=t.getStatus();e[r.PropertyName.Reserved.Status]=o,o===r.Status[r.Status.Failed]&&(e[r.PropertyName.Reserved.FailureInfo]=t.getFailureInfo(),e[r.PropertyName.Reserved.FailureType]=t.getFailureType())}function s(e,t){e[r.PropertyName.Reserved.Stream]=JSON.stringify(t.getEventData().Stream)}function a(t,o){var n=new r.Event.BaseEvent(r.Event.Label.SetContextProperty),i=e.createBaseEventAsJson(r.Event.Category[n.getEventCategory()],n.getLabel()),s=r.Context.toString(t);return i[r.PropertyName.Custom[r.PropertyName.Custom.Key]]=s,i[r.PropertyName.Custom[r.PropertyName.Custom.Value]]=o,i}function l(t,o,n,i){var s=e.createBaseEventAsJson(r.Failure.category,r.Failure.Label[t]);return s[r.PropertyName.Reserved.FailureType]=r.Failure.Type[o],n&&(s[r.PropertyName.Reserved.FailureInfo]=r.ErrorUtils.toString(n)),i&&(s[r.PropertyName.Reserved.Id]=i),s[r.PropertyName.Reserved.StackTrace]=r.Failure.getStackTrace(),s}function p(t){var o=e.createBaseEventAsJson(r.Funnel.category,r.Funnel.Label[t]);return o}function u(){var t=e.createBaseEventAsJson(r.Session.category,r.Session.State[r.Session.State.Started]);return t}function c(t){var o=e.createBaseEventAsJson(r.Session.category,r.Session.State[r.Session.State.Ended]);return o[r.PropertyName.Reserved.Trigger]=r.Session.EndTrigger[t],o}function g(t,o,n){var i=e.createBaseEventAsJson(r.Trace.category,r.Trace.Label[t]);switch(n&&(i[r.PropertyName.Reserved.Message]=n),i[r.PropertyName.Reserved.Level]=r.Trace.Level[o],o){case r.Trace.Level.Warning:i[r.PropertyName.Reserved.StackTrace]=r.Failure.getStackTrace()}return i}function d(e,t){if(e[r.PropertyName.Reserved.Status]===r.Status[r.Status.Failed]&&(e[r.PropertyName.Reserved.StackTrace]=r.Failure.getStackTrace()),t)for(var o in t)if(t.hasOwnProperty(o)){var n=void 0;n="object"==typeof t[o]?JSON.stringify(t[o]):t[o],e[o]=n}}function h(){try{if(localStorage.getItem(r.enableConsoleLogging))return!0}catch(e){}return!1}e.createBaseEventAsJson=t,e.createClickEventAsJson=o,e.createLogEventAsJson=n,e.createSetContextEventAsJson=a,e.createFailureEventAsJson=l,e.createFunnelEventAsJson=p,e.createSessionStartEventAsJson=u,e.createSessionEndEventAsJson=c,e.createTraceEventAsJson=g,e.addToLogEvent=d,e.isConsoleOutputEnabled=h}(n=o.LogHelpers||(o.LogHelpers={}))},{"./log":15}],17:[function(e,t,o){"use strict";function n(e,t){var o=s.Settings.getSetting("Aria_Token"),n=new h.ProductionRequirements;return t?r(o,n,t,e):new c.AriaLoggerDecorator(o,{contextStrategy:n,sessionId:e})}function r(e,t,o,n){var r=o?new p.CommunicatorLoggerDecorator(o):void 0,i=d.LogHelpers.isConsoleOutputEnabled()?new m.WebConsole:void 0,s=new g.ConsoleLoggerDecorator(i,{component:r});return new c.AriaLoggerDecorator(e,{contextStrategy:t,component:s,sessionId:n})}function i(e,t){var o=new XMLHttpRequest,n=u.PropertyName.Reserved.WebClipper+"."+e.category,r=s.Settings.getSetting("Misc_Data_Endpoint_Id"),i="https://www.onenote.com/webclipper/data/"+r;i=l.Utils.addUrlQueryValue(i,a.Constants.Urls.QueryParams.event,u.reportData,t),i=l.Utils.addUrlQueryValue(i,a.Constants.Urls.QueryParams.label,e.label,t),i=l.Utils.addUrlQueryValue(i,a.Constants.Urls.QueryParams.category,n,t),i=l.Utils.addUrlQueryValue(i,a.Constants.Urls.QueryParams.eventName,n+"."+e.label,t),i=l.Utils.addUrlQueryValue(i,a.Constants.HeaderValues.appIdKey.replace(/-/g,""),s.Settings.getSetting("App_Id"),t);for(var p in e.properties)e.properties.hasOwnProperty(p)&&(i=l.Utils.addUrlQueryValue(i,p,e.properties[p],t));o.open("GET",i),o.send()}var s=e("../settings"),a=e("../constants"),l=e("../utils"),p=e("../logging/communicatorLoggerDecorator"),u=e("../logging/log"),c=e("../logging/ariaLoggerDecorator_internal"),g=e("../logging/consoleLoggerDecorator"),d=e("../logging/logHelpers"),h=e("../logging/context"),m=e("../logging/webConsole");
o.createExtLogger=n,o.sendMiscLogRequest=i},{"../constants":4,"../logging/ariaLoggerDecorator_internal":8,"../logging/communicatorLoggerDecorator":9,"../logging/consoleLoggerDecorator":11,"../logging/context":14,"../logging/log":15,"../logging/logHelpers":16,"../logging/webConsole":33,"../settings":34,"../utils":35}],18:[function(e,t,o){arguments[4][7][0].apply(o,arguments)},{"./log":15,dup:7}],19:[function(e,t,o){"use strict";var n=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)},r=e("../utils"),i=e("./log"),s=e("./sessionLogger"),a=function(e){function t(t){var o=t&&t.contextStrategy?t.contextStrategy:void 0,n=t&&t.sessionId?t.sessionId:void 0;e.call(this,{contextStrategy:o,sessionId:n}),this.component=t?t.component:void 0}return n(t,e),t.prototype.generateSessionId=function(){},t.prototype.handleSetUserSessionId=function(e){var t,o=this.sessionId.get(),n=this.generateSessionId();return o?t=o:e?t=e:n&&(t=n),this.component&&t?this.component.handleSetUserSessionId(t):this.component&&!t?t=this.component.handleSetUserSessionId():this.component||t||(t=this.currentSessionState===i.Session.State.Started?"cccccccc-"+r.Utils.generateGuid().substring(9):void 0),this.sessionId.set(t),this.setContextPropertyPure(i.Context.Custom.SessionId,t),this.outputSetContext(i.Context.Custom.SessionId,t),t},t.prototype.handleClickEvent=function(e){this.outputClickEvent(e),this.component&&this.component.executeClickEvent(e)},t.prototype.handleEvent=function(e){this.handleEventPure(e),this.component&&this.component.logEvent(e)},t.prototype.handleEventPure=function(e){this.outputEvent(e)},t.prototype.handleSessionStart=function(){this.outputSessionStart(),this.component&&this.component.executeSessionStart()},t.prototype.handleSessionEnd=function(e){this.outputSessionEnd(e),this.component&&this.component.executeSessionEnd(e)},t.prototype.handleFailure=function(e,t,o,n){this.outputFailure(e,t,o,n),this.component&&this.component.logFailure(e,t,o,n)},t.prototype.handleUserFunnel=function(e){this.outputUserFunnel(e),this.component&&this.component.logUserFunnel(e)},t.prototype.handleTrace=function(e,t,o){this.outputTrace(e,t,o),this.component&&this.component.logTrace(e,t,o)},t.prototype.handleSetContext=function(e,t){this.outputSetContext(e,t),this.component&&this.component.setContextProperty(e,t)},t}(s.SessionLogger);o.LoggerDecorator=a},{"../utils":35,"./log":15,"./sessionLogger":20}],20:[function(e,t,o){"use strict";var n=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)},r=e("../communicator/smartValue"),i=e("../constants"),s=e("../utils"),a=e("./log"),l=e("./logger"),p=function(e){function t(t){e.call(this),this.contextProperties={},this.currentSessionState=a.Session.State.Ended,this.logQueue=[],this.streams={},this.userHasInteracted=!1,this.sessionId=void 0,this.sessionId=t&&t.sessionId?t.sessionId:new r.SmartValue,this.contextStrategy=t?t.contextStrategy:void 0}return n(t,e),t.prototype.hasUserInteracted=function(){return this.userHasInteracted},t.prototype.getUserSessionId=function(e){return this.sessionId.get()},t.prototype.sendFunnelInteractionEvent=function(e){var t=[i.Constants.Ids.signInButtonMsa,i.Constants.Ids.signInButtonOrgId,i.Constants.Ids.signOutButton,i.Constants.Ids.closeButton,i.Constants.Ids.clipButton,i.Constants.Ids.launchOneNoteButton,i.Constants.Ids.checkOutWhatsNewButton,i.Constants.Ids.proceedToWebClipperButton];this.hasUserInteracted()||t.indexOf(e)!==-1||(this.userHasInteracted=!0,this.logUserFunnel(a.Funnel.Label.Interact))},t.prototype.logEvent=function(e){return s.Utils.isNullOrUndefined(e)?void this.logFailure(a.Failure.Label.InvalidArgument,a.Failure.Type.Unexpected):this.areContextRequirementsMet()?void this.handleEvent(e):void this.pushDataPackage(a.LogMethods.logEvent,arguments)},t.prototype.logFailure=function(e,t,o,n){return s.Utils.isNullOrUndefined(e)||s.Utils.isNullOrUndefined(t)?void this.logFailure(a.Failure.Label.InvalidArgument,a.Failure.Type.Unexpected):this.areContextRequirementsMet()?void this.handleFailure(e,t,o,n):void this.pushDataPackage(a.LogMethods.logFailure,arguments)},t.prototype.logUserFunnel=function(e){return s.Utils.isNullOrUndefined(e)?void this.logFailure(a.Failure.Label.InvalidArgument,a.Failure.Type.Unexpected):this.areContextRequirementsMet()?void this.handleUserFunnel(e):void this.pushDataPackage(a.LogMethods.logFunnel,arguments)},t.prototype.logSessionStart=function(){return this.areContextRequirementsMet()?(this.executeSessionStart(),void this.handleSetUserSessionId()):void this.pushDataPackage(a.LogMethods.logSessionStart,arguments)},t.prototype.executeSessionStart=function(){if(this.currentSessionState===a.Session.State.Started){var e="Session already STARTED";return void this.logFailure(a.Failure.Label.SessionAlreadySet,a.Failure.Type.Unexpected,{error:e})}this.streams={},this.currentSessionState=a.Session.State.Started,this.handleSessionStart()},t.prototype.logSessionEnd=function(e){return this.areContextRequirementsMet()?(this.executeSessionEnd(e),void this.handleSetUserSessionId()):void this.pushDataPackage(a.LogMethods.logSessionEnd,arguments)},t.prototype.executeSessionEnd=function(e){if(this.currentSessionState===a.Session.State.Ended){var t="Session already ENDED";return s.Utils.isNullOrUndefined(e)||(t+=". EndTrigger: "+a.Session.EndTrigger[e]),void this.logFailure(a.Failure.Label.SessionAlreadySet,a.Failure.Type.Unexpected,{error:t})}this.logAllStreams(),this.sessionId.set(void 0),this.userHasInteracted=!1,this.currentSessionState=a.Session.State.Ended,this.handleSessionEnd(e)},t.prototype.logTrace=function(e,t,o){return s.Utils.isNullOrUndefined(e)||s.Utils.isNullOrUndefined(t)?void this.logFailure(a.Failure.Label.InvalidArgument,a.Failure.Type.Unexpected):this.areContextRequirementsMet()?void this.handleTrace(e,t,o):void this.pushDataPackage(a.LogMethods.logTrace,arguments)},t.prototype.pushToStream=function(e,t){if(s.Utils.isNullOrUndefined(e))return void this.logFailure(a.Failure.Label.InvalidArgument,a.Failure.Type.Unexpected);var o=a.Event.Label[e];t&&(this.streams[o]||(this.streams[o]=[]),this.streams[o].push(t))},t.prototype.logClickEvent=function(e){return this.areContextRequirementsMet()?(this.sendFunnelInteractionEvent(e),void this.executeClickEvent(e)):void this.pushDataPackage(a.LogMethods.logClickEvent,arguments)},t.prototype.executeClickEvent=function(e){return e?(this.pushToStream(a.Event.Label.Click,e),void this.handleClickEvent(e)):void this.logFailure(a.Failure.Label.InvalidArgument,a.Failure.Type.Unexpected,{error:"Button clicked without an ID! Logged with ID "+JSON.stringify(e)})},t.prototype.setContextProperty=function(e,t){this.setContextPropertyPure(e,t),this.handleSetContext(e,t),this.areContextRequirementsMet()&&this.flushEventQueue()},t.prototype.setContextPropertyPure=function(e,t){var o=a.Context.toString(e);this.contextProperties[o]=t},t.prototype.areContextRequirementsMet=function(){return!this.contextStrategy||this.contextStrategy.requirementsAreMet(this.contextProperties)},t.prototype.flushEventQueue=function(){var e=this;this.isQueueFlushing||this.isQueueFlushed||(this.isQueueFlushing=!0,this.logQueue.forEach(function(t){switch(t.methodName){case a.LogMethods.logEvent:e.logEvent.apply(e,t.methodArgs);break;case a.LogMethods.logFailure:e.logFailure.apply(e,t.methodArgs);break;case a.LogMethods.pushToStream:e.pushToStream.apply(e,t.methodArgs);break;case a.LogMethods.logFunnel:e.logUserFunnel.apply(e,t.methodArgs);break;case a.LogMethods.logSessionStart:e.logSessionStart.apply(e,t.methodArgs);break;case a.LogMethods.logSessionEnd:e.logSessionEnd.apply(e,t.methodArgs);break;case a.LogMethods.logClickEvent:e.logClickEvent.apply(e,t.methodArgs);break;case a.LogMethods.setContextProperty:e.setContextProperty.apply(e,t.methodArgs);break;case a.LogMethods.logTrace:default:e.logTrace.apply(e,t.methodArgs)}}),this.isQueueFlushing=!1,this.isQueueFlushed=!0)},t.prototype.logAllStreams=function(){for(var e in this.streams)if(this.streams.hasOwnProperty(e)){for(var t=new a.Event.StreamEvent(a.Event.Label[e]),o=this.streams[e],n=0;n<o.length;n++)t.append(o[n]);this.handleEventPure(t)}},t.prototype.pushDataPackage=function(e,t){this.logQueue.push({methodName:e,methodArgs:t})},t}(l.Logger);o.SessionLogger=p},{"../communicator/smartValue":3,"../constants":4,"../utils":35,"./log":15,"./logger":18}],21:[function(e,t,o){"use strict";var n;!function(e){e.category="Click";var t;!function(e){e.regionSelectionRemoveButton="RegionSelectionRemoveButton",e.sectionComponent="SectionComponent",e.sectionPickerLocationContainer="SectionPickerLocationContainer"}(t=e.Label||(e.Label={}))}(n=o.Click||(o.Click={}))},{}],22:[function(e,t,o){"use strict";var n;!function(e){function t(e){return o[n[e]]}var o={AppInfoId:"AppInfo.Id",AppInfoVersion:"AppInfo.Version",DeviceInfoId:"DeviceInfo.Id",SessionId:"Session.Id",UserInfoId:"UserInfo.Id",UserInfoLanguage:"UserInfo.Language",AuthType:"AuthType",BrowserLanguage:"BrowserLanguage",ClipperType:"ClipperType",ContentType:"ContentType",FlightInfo:"FlightInfo",InPrivateBrowsing:"InPrivateBrowsing",InvokeHostname:"InvokeHostname",PageLanguage:"PageLanguage"};!function(e){e[e.AppInfoId=0]="AppInfoId",e[e.AppInfoVersion=1]="AppInfoVersion",e[e.DeviceInfoId=2]="DeviceInfoId",e[e.SessionId=3]="SessionId",e[e.UserInfoId=4]="UserInfoId",e[e.UserInfoLanguage=5]="UserInfoLanguage",e[e.AuthType=6]="AuthType",e[e.BrowserLanguage=7]="BrowserLanguage",e[e.ClipperType=8]="ClipperType",e[e.ContentType=9]="ContentType",e[e.FlightInfo=10]="FlightInfo",e[e.InPrivateBrowsing=11]="InPrivateBrowsing",e[e.InvokeHostname=12]="InvokeHostname",e[e.PageLanguage=13]="PageLanguage"}(e.Custom||(e.Custom={}));var n=e.Custom;e.toString=t}(n=o.Context||(o.Context={}))},{}],23:[function(e,t,o){"use strict";var n,r=e("../../clientType"),i=e("../../constants"),s=e("../../utils"),a=e("../../localization/localization"),l=e("../log");!function(e){function t(e){if(e){var t={};t[d[d.error]]=e.error;var o=e;return o&&void 0!==o.statusCode&&(t[d[d.statusCode]]=o.statusCode,t[d[d.response]]=o.response,t[d[d.responseHeaders]]=o.responseHeaders,void 0!==o.timeout&&(t[d[d.timeout]]=o.timeout)),JSON.stringify(t)}}function o(e){if(e){var t=e;return t&&void 0!==t.statusCode?void 0!==t.timeout?{error:t.error,statusCode:t.statusCode,response:t.response,responseHeaders:t.responseHeaders,timeout:t.timeout}:{error:t.error,statusCode:t.statusCode,response:t.response,responseHeaders:t.responseHeaders}:{error:e.error}}}function n(t){var o={};o[i.Constants.Urls.QueryParams.failureType]=l.Failure.Type[t.properties.failureType],o[i.Constants.Urls.QueryParams.failureInfo]=e.toString(t.properties.failureInfo),o[i.Constants.Urls.QueryParams.stackTrace]=t.properties.stackTrace,s.Utils.isNullOrUndefined(t.properties.failureId)||(o[i.Constants.Urls.QueryParams.failureId]=t.properties.failureId);var n=t.clientInfo;g(o,n),LogManager.sendMiscLogRequest({label:l.Failure.Label[t.label],category:l.Failure.category,properties:o},!0)}function p(t,o,n,r){var i;throw i=r?JSON.stringify({message:r,error:o.toString()}):o.toString(),e.sendFailureLogRequest({label:l.Failure.Label.UnhandledExceptionThrown,properties:{failureType:l.Failure.Type.Unexpected,failureInfo:{error:i},failureId:"Channel "+t,stackTrace:l.Failure.getStackTrace(o)},clientInfo:n}),o}function u(e,t){void 0===t&&(t=!1);var o={};o[i.Constants.Urls.QueryParams.channel]=e.channel,o[i.Constants.Urls.QueryParams.url]=encodeURIComponent(e.url),o[i.Constants.Urls.QueryParams.timeoutInMs]=i.Constants.Settings.noOpTrackerTimeoutDuration.toString();var n=e.clientInfo;g(o,n),LogManager.sendMiscLogRequest({label:l.NoOp.Label[e.label],category:l.NoOp.category,properties:o},!0),t&&window&&window.alert(a.Localization.getLocalizedString("WebClipper.Error.NoOpError"))}function c(e,t){return void 0===t&&(t=!1),setTimeout(function(){u(e,t)},i.Constants.Settings.noOpTrackerTimeoutDuration)}function g(e,t){t&&(e[i.Constants.Urls.QueryParams.clientType]=s.Utils.isNullOrUndefined(t.get())?l.unknownValue:r.ClientType[t.get().clipperType],e[i.Constants.Urls.QueryParams.clipperVersion]=s.Utils.isNullOrUndefined(t.get())?l.unknownValue:t.get().clipperVersion,e[i.Constants.Urls.QueryParams.clipperId]=s.Utils.isNullOrUndefined(t.get())?l.unknownValue:t.get().clipperId)}var d;!function(e){e[e.error=0]="error",e[e.statusCode=1]="statusCode",e[e.response=2]="response",e[e.responseHeaders=3]="responseHeaders",e[e.timeout=4]="timeout"}(d||(d={})),e.toString=t,e.clone=o,e.sendFailureLogRequest=n,e.handleCommunicatorError=p,e.sendNoOpTrackerRequest=u,e.setNoOpTrackerRequestTimeout=c}(n=o.ErrorUtils||(o.ErrorUtils={}))},{"../../clientType":1,"../../constants":4,"../../localization/localization":6,"../../utils":35,"../log":15}],24:[function(e,t,o){"use strict";var n,r=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)},i=e("../log"),s=e("../../utils");!function(e){function t(t,o){switch(t){default:case e.Category.BaseEvent:return new e.BaseEvent(o);case e.Category.PromiseEvent:return new e.PromiseEvent(o);case e.Category.StreamEvent:return new e.StreamEvent(o)}}!function(e){e[e.BaseEvent=0]="BaseEvent",e[e.PromiseEvent=1]="PromiseEvent",e[e.StreamEvent=2]="StreamEvent"}(e.Category||(e.Category={}));e.Category;!function(e){e[e.AddEmbeddedVideo=0]="AddEmbeddedVideo",e[e.AugmentationApiCall=1]="AugmentationApiCall",e[e.BookmarkPage=2]="BookmarkPage",e[e.CompressRegionSelection=3]="CompressRegionSelection",e[e.ClearNoOpTracker=4]="ClearNoOpTracker",e[e.Click=5]="Click",e[e.ClipToOneNoteAction=6]="ClipToOneNoteAction",e[e.CloseClipper=7]="CloseClipper",e[e.ClosePageNavTooltip=8]="ClosePageNavTooltip",e[e.DebugFeedback=9]="DebugFeedback",e[e.DeviceIdMap=10]="DeviceIdMap",e[e.FetchNonLocalData=11]="FetchNonLocalData",e[e.FullPageScreenshotCall=12]="FullPageScreenshotCall",e[e.GetBinaryRequest=13]="GetBinaryRequest",e[e.GetCleanDom=14]="GetCleanDom",e[e.GetDefaultSection=15]="GetDefaultSection",e[e.GetExistingUserInformation=16]="GetExistingUserInformation",e[e.GetFlightingAssignments=17]="GetFlightingAssignments",e[e.GetLocale=18]="GetLocale",e[e.GetLocalizedStrings=19]="GetLocalizedStrings",e[e.GetNotebooks=20]="GetNotebooks",e[e.HandleSignInEvent=21]="HandleSignInEvent",e[e.HideClipperDueToSpaNavigate=22]="HideClipperDueToSpaNavigate",e[e.InvokeClipper=23]="InvokeClipper",e[e.InvokeTooltip=24]="InvokeTooltip",e[e.InvokeWhatsNew=25]="InvokeWhatsNew",e[e.RegionSelectionCapturing=26]="RegionSelectionCapturing",e[e.RegionSelectionLoading=27]="RegionSelectionLoading",e[e.RegionSelectionProcessing=28]="RegionSelectionProcessing",e[e.SetContextProperty=29]="SetContextProperty",e[e.SetDoNotPromptRatings=30]="SetDoNotPromptRatings",e[e.ShouldShowRatingsPrompt=31]="ShouldShowRatingsPrompt",e[e.PageModifications=32]="PageModifications",e[e.PostToOneNoteApi=33]="PostToOneNoteApi",e[e.ProcessPdfIntoDataUrls=34]="ProcessPdfIntoDataUrls",e[e.RefreshUserToken=35]="RefreshUserToken",e[e.TooltipImpression=36]="TooltipImpression",e[e.UserInfoUpdated=37]="UserInfoUpdated",e[e.WaitOnBinaryRequestBeforePdfClip=38]="WaitOnBinaryRequestBeforePdfClip",e[e.WhatsNewImpression=39]="WhatsNewImpression"}(e.Label||(e.Label={}));var o=(e.Label,function(){function t(e){if(this._timerWasStopped=!1,this.isEventData(e)){var t=e;this._label=t.Label,this._duration=t.Duration,this._properties=t.Properties?JSON.parse(JSON.stringify(t.Properties)):void 0}else{var o=e;this._label=o,this.startTimer()}}return t.prototype.getDuration=function(){return this._duration},t.prototype.getEventCategory=function(){return e.Category.BaseEvent},t.prototype.getEventData=function(){return{Label:this._label,Duration:this._duration,Properties:this.getCustomProperties()}},t.prototype.getLabel=function(){return e.Label[this._label]},t.prototype.getCustomProperties=function(){return this._properties?JSON.parse(JSON.stringify(this._properties)):void 0},t.prototype.setCustomProperty=function(e,t){if(this.isReservedPropertyName(e))throw new Error("Tried to overwrite key '"+i.PropertyName.Custom[e]+"' with value of "+JSON.stringify(t));this._properties||(this._properties={}),this._properties[i.PropertyName.Custom[e]]=t},t.prototype.startTimer=function(){this._startTime=(new Date).getTime()},t.prototype.stopTimer=function(){return!!this._startTime&&(this._duration=(new Date).getTime()-this._startTime,this._timerWasStopped=!0,!0)},t.prototype.timerWasStopped=function(){return this._timerWasStopped},t.prototype.isEventData=function(e){var t=e;return!(!t||s.Utils.isNullOrUndefined(t.Label))},t.prototype.isReservedPropertyName=function(e){for(var t in i.PropertyName.Reserved)if(i.PropertyName.Custom[e].toLowerCase()===t.toLowerCase())return!0;return!1},t}());e.BaseEvent=o;var n=function(t){function o(e){if(t.call(this,e),this._logStatus=i.Status.Succeeded,this._failureType=i.Failure.Type.Unexpected,this.isEventData(e)){var o=e;this._logStatus=o.LogStatus,this._failureType=o.FailureType,this._failureInfo=i.ErrorUtils.clone(o.FailureInfo)}}return r(o,t),o.prototype.getEventCategory=function(){return e.Category.PromiseEvent},o.prototype.getEventData=function(){return{Label:this._label,Duration:this._duration,Properties:this.getCustomProperties(),LogStatus:this._logStatus,FailureType:this._failureType,FailureInfo:i.ErrorUtils.clone(this._failureInfo)}},o.prototype.getStatus=function(){return i.Status[this._logStatus]},o.prototype.setStatus=function(e){this._logStatus=e,this._timerWasStopped||this.stopTimer()},o.prototype.getFailureInfo=function(){return i.ErrorUtils.toString(this._failureInfo)},o.prototype.setFailureInfo=function(e){this._failureInfo=i.ErrorUtils.clone(e)},o.prototype.getFailureType=function(){return i.Failure.Type[this._failureType]},o.prototype.setFailureType=function(e){this._failureType=e},o}(o);e.PromiseEvent=n;var a=function(t){function o(e){if(t.call(this,e),this._stream=[],this.isEventData(e)){var o=e;this._stream=o.Stream}}return r(o,t),o.prototype.getEventCategory=function(){return e.Category.StreamEvent},o.prototype.getEventData=function(){return{Label:this._label,Duration:this._duration,Properties:this.getCustomProperties(),Stream:this._stream}},o.prototype.append=function(e){this._stream.push(e)},o}(o);e.StreamEvent=a,e.createEvent=t}(n=o.Event||(o.Event={}))},{"../../utils":35,"../log":15}],25:[function(e,t,o){"use strict";var n;!function(e){function t(e){return e||(e=new Error),e.stack}e.category="Failure",function(e){e[e.Unexpected=0]="Unexpected",e[e.Expected=1]="Expected"}(e.Type||(e.Type={}));e.Type;e.getStackTrace=t,function(e){e[e.ClickedButtonWithNoId=0]="ClickedButtonWithNoId",e[e.EndSessionWithoutTrigger=1]="EndSessionWithoutTrigger",e[e.GetChangeLog=2]="GetChangeLog",e[e.GetComputedStyle=3]="GetComputedStyle",e[e.GetLocalizedString=4]="GetLocalizedString",e[e.GetSetting=5]="GetSetting",e[e.IFrameMessageHandlerHasNoOtherWindow=6]="IFrameMessageHandlerHasNoOtherWindow",e[e.InvalidArgument=7]="InvalidArgument",e[e.IsFeatureEnabled=8]="IsFeatureEnabled",e[e.JsonParse=9]="JsonParse",e[e.NotImplemented=10]="NotImplemented",e[e.OnLaunchOneNoteButton=11]="OnLaunchOneNoteButton",e[e.OrphanedWebClippersDueToExtensionRefresh=12]="OrphanedWebClippersDueToExtensionRefresh",e[e.RegionSelectionProcessing=13]="RegionSelectionProcessing",e[e.RenderFailurePanel=14]="RenderFailurePanel",e[e.ReservedPropertyOverwriteAttempted=15]="ReservedPropertyOverwriteAttempted",e[e.SessionAlreadySet=16]="SessionAlreadySet",e[e.SetLoggerNoop=17]="SetLoggerNoop",e[e.SetUndefinedLocalizedStrings=18]="SetUndefinedLocalizedStrings",e[e.TraceLevelErrorWarningMessage=19]="TraceLevelErrorWarningMessage",e[e.UnhandledApiCode=20]="UnhandledApiCode",e[e.UnhandledExceptionThrown=21]="UnhandledExceptionThrown",e[e.UserSetWithInvalidExpiredData=22]="UserSetWithInvalidExpiredData",e[e.WebExtensionWindowCreate=23]="WebExtensionWindowCreate",e[e.UnclippablePage=24]="UnclippablePage",e[e.UnsupportedBrowser=25]="UnsupportedBrowser"}(e.Label||(e.Label={}));e.Label}(n=o.Failure||(o.Failure={}))},{}],26:[function(e,t,o){"use strict";var n;!function(e){e.category="Funnel",function(e){e[e.Invoke=0]="Invoke",e[e.AuthAlreadySignedIn=1]="AuthAlreadySignedIn",e[e.AuthAttempted=2]="AuthAttempted",e[e.AuthSignInCompleted=3]="AuthSignInCompleted",e[e.ClipAttempted=4]="ClipAttempted",e[e.Interact=5]="Interact",e[e.ViewInWac=6]="ViewInWac",e[e.SignOut=7]="SignOut"}(e.Label||(e.Label={}));e.Label}(n=o.Funnel||(o.Funnel={}))},{}],27:[function(e,t,o){"use strict";!function(e){e[e.logEvent=0]="logEvent",e[e.logFailure=1]="logFailure",e[e.pushToStream=2]="pushToStream",e[e.logFunnel=3]="logFunnel",e[e.logSession=4]="logSession",e[e.logSessionStart=5]="logSessionStart",e[e.logSessionEnd=6]="logSessionEnd",e[e.logTrace=7]="logTrace",e[e.logClickEvent=8]="logClickEvent",e[e.setContextProperty=9]="setContextProperty"}(o.LogMethods||(o.LogMethods={}));o.LogMethods},{}],28:[function(e,t,o){"use strict";var n;!function(e){e.category="NoOp",function(e){e[e.InitializeCommunicator=0]="InitializeCommunicator",e[e.WebClipperUiFrameDidNotExist=1]="WebClipperUiFrameDidNotExist",e[e.WebClipperUiFrameIsNotVisible=2]="WebClipperUiFrameIsNotVisible"}(e.Label||(e.Label={}));e.Label}(n=o.NoOp||(o.NoOp={}))},{}],29:[function(e,t,o){"use strict";var n;!function(e){!function(e){e[e.AnnotationAdded=0]="AnnotationAdded",e[e.AugmentationModel=1]="AugmentationModel",e[e.AverageProcessingDurationPerPage=2]="AverageProcessingDurationPerPage",e[e.BookmarkInfo=3]="BookmarkInfo",e[e.ByteLength=4]="ByteLength",e[e.BytesTrimmed=5]="BytesTrimmed",e[e.Channel=6]="Channel",e[e.ClipMode=7]="ClipMode",e[e.CloseReason=8]="CloseReason",e[e.ContainsAtLeastOneHighlight=9]="ContainsAtLeastOneHighlight",e[e.ContentType=10]="ContentType",e[e.CorrelationId=11]="CorrelationId",e[e.CurrentPanel=12]="CurrentPanel",e[e.CurrentSectionStillExists=13]="CurrentSectionStillExists",e[e.DeviceIdInStorage=14]="DeviceIdInStorage",e[e.DeviceIdInCookie=15]="DeviceIdInCookie",e[e.DomSizeInBytes=16]="DomSizeInBytes",e[e.FeatureEnabled=17]="FeatureEnabled",e[e.FinalDataUrlLength=18]="FinalDataUrlLength",e[e.FontSize=19]="FontSize",e[e.ForceRetrieveFreshLocStrings=20]="ForceRetrieveFreshLocStrings",e[e.FoundDefaultNotebook=21]="FoundDefaultNotebook",e[e.FoundDefaultSection=22]="FoundDefaultSection",e[e.FreshUserInfoAvailable=23]="FreshUserInfoAvailable",e[e.FullPageScreenshotContentFound=24]="FullPageScreenshotContentFound",e[e.Height=25]="Height",e[e.InitialDataUrlLength=26]="InitialDataUrlLength",e[e.InvokeMode=27]="InvokeMode",e[e.InvokeSource=28]="InvokeSource",e[e.IsRetryable=29]="IsRetryable",e[e.IsSerif=30]="IsSerif",e[e.Key=31]="Key",e[e.LastSeenTooltipTime=32]="LastSeenTooltipTime",e[e.LastUpdated=33]="LastUpdated",e[e.MaxDepth=34]="MaxDepth",e[e.NumPages=35]="NumPages",e[e.NumTimesTooltipHasBeenSeen=36]="NumTimesTooltipHasBeenSeen",e[e.PageNavTooltipType=37]="PageNavTooltipType",e[e.PageTitleModified=38]="PageTitleModified",e[e.Quality=39]="Quality",e[e.QualityStepDownCount=40]="QualityStepDownCount",e[e.RatingsInfo=41]="RatingsInfo",e[e.RequestCorrelationId=42]="RequestCorrelationId",e[e.ShouldShowRatingsPrompt=43]="ShouldShowRatingsPrompt",e[e.SignInCancelled=44]="SignInCancelled",e[e.StoredLocaleDifferentThanRequested=45]="StoredLocaleDifferentThanRequested",e[e.Styles=46]="Styles",e[e.TimeToClearNoOpTracker=47]="TimeToClearNoOpTracker",e[e.TooltipType=48]="TooltipType",e[e.UpdateInterval=49]="UpdateInterval",e[e.UserInformationReturned=50]="UserInformationReturned",e[e.UserInformationStored=51]="UserInformationStored",e[e.UserUpdateReason=52]="UserUpdateReason",e[e.Url=53]="Url",e[e.Value=54]="Value",e[e.VideoDataOriginalSrcUrl=55]="VideoDataOriginalSrcUrl",e[e.VideoSrcUrl=56]="VideoSrcUrl",e[e.Width=57]="Width"}(e.Custom||(e.Custom={}));var t;e.Custom;!function(e){e.Category="Category",e.Duration="Duration",e.EventName="EventName",e.EventType="EventType",e.FailureInfo="FailureInfo",e.FailureType="FailureType",e.Id="Id",e.Label="Label",e.Level="Level",e.Message="Message",e.Properties="Properties",e.StackTrace="StackTrace",e.Status="Status",e.Stream="Stream",e.Trigger="Trigger",e.WebClipper="WebClipper"}(t=e.Reserved||(e.Reserved={}))}(n=o.PropertyName||(o.PropertyName={}))},{}],30:[function(e,t,o){"use strict";var n;!function(e){e.category="Session",function(e){e[e.SignOut=0]="SignOut",e[e.Unload=1]="Unload"}(e.EndTrigger||(e.EndTrigger={}));e.EndTrigger;!function(e){e[e.Started=0]="Started",e[e.Ended=1]="Ended"}(e.State||(e.State={}));e.State}(n=o.Session||(o.Session={}))},{}],31:[function(e,t,o){"use strict";!function(e){e[e.Succeeded=0]="Succeeded",e[e.Failed=1]="Failed"}(o.Status||(o.Status={}));o.Status},{}],32:[function(e,t,o){"use strict";var n;!function(e){e.category="Trace",function(e){e[e.DefaultingToConsoleLogger=0]="DefaultingToConsoleLogger",e[e.DebugMode=1]="DebugMode",e[e.RequestForClipperInstalledPageUrl=2]="RequestForClipperInstalledPageUrl"}(e.Label||(e.Label={}));e.Label;!function(e){e[e.None=0]="None",e[e.Error=1]="Error",e[e.Warning=2]="Warning",e[e.Information=3]="Information",e[e.Verbose=4]="Verbose"}(e.Level||(e.Level={}));e.Level}(n=o.Trace||(o.Trace={}))},{}],33:[function(e,t,o){"use strict";var n=function(){function e(){}return e.prototype.warn=function(e,t){console.warn(e,t)},e.prototype.error=function(e,t){console.error(e,t)},e.prototype.info=function(e,t){console.info(e,t)},e.prototype.log=function(e,t){console.log(e,t)},e}();o.WebConsole=n},{}],34:[function(e,t,o){"use strict";var n,r=e("../settings.json");!function(t){function o(e){var t=r[e];if(t&&t.Value)return t.Value}function n(t){r=t?t:e("../settings.json")}t.getSetting=o,t.setSettingsJsonForTesting=n}(n=o.Settings||(o.Settings={}))},{"../settings.json":36}],35:[function(e,t,o){"use strict";var n,r=e("./clientType"),i=e("./constants"),s=e("./settings"),a=e("./clipperUI/tooltipType");!function(e){function t(e){var t=1e3,o=700,n=screen.width?(screen.width-t)/2:0,r=screen.height?(screen.height-o)/2:0,i="height="+o+",width="+t+",top="+r+",left="+n+",scrollbars=yes,resizable=yes,location=no,menubar=no,status=yes,titlebar=no,toolbar=no";return window.open(e,"_blank",i)}function o(e,t){if(e&&t){var o=t.replace(/[\[\]]/g,"\\$&"),n=new RegExp("[?&]"+o+"(=([^&#]*)|&|#|$)","i"),r=n.exec(e);if(r)return r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):""}}function n(t,o,n,r){if(void 0===r&&(r=!1),!t||!o||!n)return t;r&&(o=e.toCamelCase(o));var i=t.match(/^([^#]*)(#.*)?$/),s=i[1],a=i[2]?i[2]:"",l=s.indexOf("?");if(l===-1)return s+"?"+o+"="+n+a;if(l===s.length-1)return s+o+"="+n+a;for(var p=s.substring(l+1).split("&"),u=0;u<p.length;u++){var c=p[u].split("=");if(c[0]===o)return p[u]=c[0]+"="+n,s.substring(0,l+1)+p.join("&")+a}return s+"&"+o+"="+n+a}function l(t,o,n,r){var s=e.addUrlQueryValue(t,i.Constants.Urls.QueryParams.authType,r);return s=e.addUrlQueryValue(s,i.Constants.Urls.QueryParams.clipperId,o),s=e.addUrlQueryValue(s,i.Constants.Urls.QueryParams.userSessionId,n)}function p(e,t,o){return l(i.Constants.Urls.Authentication.signInUrl,e,t,o)}function u(e,t,o){return l(i.Constants.Urls.Authentication.signOutUrl,e,t,o)}function c(t,o,n){var s=e.addUrlQueryValue(i.Constants.Urls.clipperFeedbackUrl,"LogCategory",n);return s=e.addUrlQueryValue(s,"originalUrl",t.pageInfo.rawUrl),s=e.addUrlQueryValue(s,"clipperId",t.clientInfo.clipperId),s=e.addUrlQueryValue(s,"usid",o),s=e.addUrlQueryValue(s,"type",r.ClientType[t.clientInfo.clipperType]),s=e.addUrlQueryValue(s,"version",t.clientInfo.clipperVersion)}function g(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,o="x"===e?t:3&t|8;return o.toString(16)})}function d(e){var t=document.createElement("a");return t.href=e,t.protocol+"//"+t.host+"/"}function h(e){var t=document.createElement("a");t.href=e;var o=t.pathname;return this.ensureLeadingForwardSlash(o)}function m(e,t){for(var o=0;o<t.length;++o){var n=t[o],r=a.TooltipType[n],i=s.Settings.getSetting(r+"Domains"),l=new RegExp(i.join("|"),"i");if(l.test(e))return n}}function f(e){return e=this.isNullOrUndefined(e)?"/":e,e.length>0&&"/"===e.charAt(0)?e:"/"+e}function C(e,t){if(!e)return t;var o=/\/(?=[^\/]+\.\w{3,4}$).+/g.exec(e);return o&&o[0]?o[0].slice(1):t}function v(e){return null===e||void 0===e}function S(e){return"number"==typeof e&&!isNaN(e)}function y(e){return("images/"+e).toLowerCase()}function b(e){return e.charAt(0).toUpperCase()+e.slice(1)}function w(e){if(!e)return!1;var t=["AugmentationDefault_WhitelistedDomains","ProductDomains","RecipeDomains"],o=[];t.forEach(function(e){o=o.concat(s.Settings.getSetting(e))});for(var n=0,r=o;n<r.length;n++){var i=r[n];if(new RegExp(i).test(e))return!0}return!1}function I(e){var t=document.createElement("iframe");t.hidden=!0,t.style.display="none",t.src=e,document.body.appendChild(t)}function T(e,t){var o={};if(e)for(var n in e)e.hasOwnProperty(n)&&(o[n]=e[n]);if(t)for(var n in t)t.hasOwnProperty(n)&&(o[n]=t[n]);return o}function E(t,o){e.isNullOrUndefined(o)&&(o=document);for(var n=document.cookie.split(";").map(function(e){return e.split("=")}),r=0,i=n;r<i.length;r++){var s=i[r];if(s[0].trim()===t)return s[1].trim()}}e.openPopupWindow=t,e.getQueryValue=o,e.addUrlQueryValue=n,e.generateSignInUrl=p,e.generateSignOutUrl=u,e.generateFeedbackUrl=c,e.generateGuid=g,e.getHostname=d,e.getPathname=h,e.checkIfUrlMatchesAContentType=m,e.ensureLeadingForwardSlash=f,e.getFileNameFromUrl=C,e.isNullOrUndefined=v,e.isNumeric=S,e.getImageResourceUrl=y,e.toCamelCase=b,e.onWhitelistedDomain=w,e.appendHiddenIframeToDocument=I,e.createUpdatedObject=T,e.readCookie=E}(n=o.Utils||(o.Utils={}))},{"./clientType":1,"./clipperUI/tooltipType":2,"./constants":4,"./settings":34}],36:[function(e,t,o){t.exports={DummyObjectForTestingPurposes:{Description:"Do not remove under any circumstances!",Value:"Testing."},AugmentationDefault_WhitelistedDomains:{Description:"The set of domains on which we are changing the default clip mode to Augmentation.",Value:["onenote","wikipedia","nytimes","lifehacker","msn","theguardian","forbes","bbc","huffingtonpost","businessinsider","washingtonpost","medium","buzzfeed","bbc","theverge","techcrunch","amazon","allrecipes","foodnetwork","seriouseats","epicurious","support.office.com","blogs.office.com","blogs.technet.com","youtube\\.com\\/watch(\\?v=(\\w+)|.*\\&v=(\\w+))","youtube\\.com\\/embed\\/(\\w+)","vimeo\\.com.*?\\/(\\d+)($|\\?|\\#|\\/$)","vimeo\\.com.*?\\/(\\d+)\\/\\w+:\\w+(\\/|$)","khanacademy\\.org(.*)/v/(.*)","\\/(\\d{2}|\\d{4})\\/\\d{1,2}\\/","\\/(\\d{2}|\\d{4})-\\d{1,2}-\\d{1,2}\\/"]},PdfDomains:{Description:"PDF regexes",Value:["^.*(.pdf)$"]},RecipeDomains:{Description:"The set of domains where we want to show a Recipe tooltip",Value:["^(http(s)?)://(12tomatoes\\.com/)()([^/]*-[^/]*)/$","^(http(s)?)://(abc\\.go\\.com/shows/the-chew/recipes/)([^/]*-[^/]*)$","^(http(s)?)://(([^ ]{1,18})?)(allrecipes\\.com)()/(recipe/.*)$","^(http(s)?)://((\\.{1,18}\\.)?)(allrecipes\\.)(com)/(recipe/[^/]+(/)?(/detail\\.aspx\\??)?)$","^(http(s)?)://()(allrecipes\\.com)()/([r|R]ecipe/[^/]+/Detail\\.aspx)$","^(http(s)?)://()(allrecipes\\.com)()/(recipe/.*)$","^(http(s)?)://(cookieandkate\\.com)()/(\\d{4})/(.+)$","^(http(s)?)://(cooking\\.)(nytimes\\.com)()/(recipes/(.*))$","^(http(s)?)://()(cookpad\\.com)()/(recipe/[0-9]+$)$","^(http(s)?)://()(damndelicious\\.net)()/\\d+/\\d+/\\d+/.+/$","^(http(s)?)://(food52\\.com)()/recipes/[0-9]+-.+$","^(http(s)?)://(minimalistbaker.com)/([^/]*-[^/]*)/$","^(http(s)?)://(paleoleap.com)/([^/]*-[^/]*)/$","^(http(s)?)://(pinchofyum.com)/([^/]*-[^/]*)$","^(http(s)?)://(recipe\\.rakuten\\.co\\.jp)()/recipe/[0-9]+/$","^(http(s)?)://()(thepioneerwoman\\.com)()/(cooking/.+/)$","^(http(s)?)://((www\\.)?)(allrecipes\\.com)()/([r|R]ecipe/[^/]+/(Detail\\.aspx)?)$","^(http(s)?)://((www\\.)?)(allrecipes\\.com)()/([R|r]ecipe/.*)$","^(http(s)?)://(www\\.)(bbc\\.co\\.uk/food/recipes/[^/]*_\\d+)$","^(http(s)?)://(www\\.)(bbcgoodfood\\.com)()/(recipes/[0-9]+/(.*))$","^(http(s)?)://(www\\.)(bbcgoodfood\\.com)/recipes/([^/]*-[^/]*)$","^(http(s)?)://(www\\.)(bettycrocker\\.com)()/(recipes/[^\\/]+/[0-9a-f-]{36}/?)$","^(http(s)?)://(www\\.)(bonappetit\\.com)()/(recipe/(.*))$","^(http(s)?)://(www\\.budgetbytes\\.com)/\\d{4}/\\d{2}/(.*)/","^(http(s)?)://((www\\.)?)(chowhound\\.com)()/(recipes/.*)$","^(http(s)?)://(www\\.cookingclassy\\.com)/\\d{4}/\\d{2}/(.*)/","^(http(s)?)://(www\\.delish\\.com)/cooking/recipe-ideas/recipes/a\\d+/[^/]*-[^/]*/","^(http(s)?)://(www\\.)(eatingwell\\.com)()/(recipe/\\d+/.+/)$","^(http(s)?)://(www\\.)(epicurious\\.com)()/(recipes/food/views/.*)$","^(http(s)?)://(www\\.)(food\\.com)()/(recipe/.*)$","^(http(s)?)://(www\\.)(foodandwine\\.com)()/(recipes\\/.+)$","^(http(s)?)://(www\\.)(foodnetwork)(\\.ca)/(recipe/(.*))$","^(http(s)?)://(www\\.)(foodnetwork\\.com)()/(recipe-collections/.*)$","^(http(s)?)://(www\\.)(foodnetwork\\.com)()/(recipes.*)$","^(http(s)?)://(www\\.)(foodnetwork\\.com)()/(recipes/.*)$","^(http(s)?)://(www\\.)(marthastewart\\.com)()/(([0-9]+|recipe)/.*)$","^(http(s)?)://(www\\.)(marthastewart\\.com)()/([0-9]+/[^/]+)$","^(http(s)?)://(www\\.)(myrecipes\\.com)()/(recipe/.*)$","^(http(s)?)://(www\\.)(myrecipes\\.com)()/(recipe/.*-[0-9]*/)$","^(http(s)?)://(www\\.)(myrecipes\\.com)()/(recipe/.*)$","^(http(s)?)://(www\\.)(myrecipes\\.com)()/(recipe/[^/]+.*)$","^(http(s)?)://(www\\.)(realsimple\\.com)()/(food-recipes/browse-all-recipes/[^\\/]+/index\\.html)$","^(http(s)?)://((www)?\\.)(seriouseats\\.com)()/([Rr]ecipes\\/.*\\.(html|HTML)(.*)?)$","^(http(s)?)://(www\\.)(simplyrecipes\\.com)()/(recipes/[^/]*/)$","^(http(s)?)://((www\\.)?)(simplyrecipes\\.com)()/(recipes/[^/]*/)$","^(http(s)?)://((www\\.)?)(simplyrecipes\\.com)()/(recipes/.*)$","^(http(s)?)://(www\\.)(tasteofhome\\.com)()/([R|r]ecipes/[^/]+$)$","^(http(s)?)://(www\\.)(tasteofhome\\.com)()/(recipes/[^/]*/?)$","^(http(s)?)://(www\\.)(tasteofhome\\.com)()/(recipes/[^\\/]+/?)$","^(http(s)?)://(www\\.)(yummly\\.com)()/(recipe/[^/]+)$","^(http(s)?)://((www\\.)?)(yummly\\.com)()/(recipe/.*)$","^(http(s)?)://(.*)(yummly\\.com)()/(recipe/.+)$"]
},ProductDomains:{Description:"The set of domains where we want to show a Product tooltip",Value:["^(http(s)?)://store\\.steampowered.com/app/\\d+/.*$","^(http(s)?)://(www\\.)(amazon\\.com)()/(gp/product/[^/]+/.*)$","^(http(s)?)://(www\\.)(amazon\\.com)()/(dp/[^/]+.*)$","^(http(s)?)://(www\\.)(amazon\\.com)()/([^/]+/dp/[^/]+)$","^(http(s)?)://(www\\.)(amazon\\.in)()/((.+/)?(dp|gp/product)\\/\\w{10,13}([^\\w].*)?)$","^(http(s)?)://(www\\.)(amazon\\.)([a-zA-Z\\.]+)/([^/]+/dp/.*)$","^(http(s)?)://(www\\.)(bedbathandbeyond\\.com)(/store/product/)([^/]*-[^/]*/)(\\d+.*)","^(http(s)?)://(www\\.)(ebay\\.com)()/(itm/[^/]+/.*)$","^(http(s)?)://(www\\.)(etsy\\.com)()/(listing)/(\\d+/.*)$","^(http(s)?)://(www\\.)(homedepot\\.com)()/(p/[^/]+/.*)$","^(http(s)?)://(www\\.)(newegg\\.com)()/(Product/Product\\.aspx\\?Item=.+)$","^(http(s)?)://(www\\.)(overstock\\.com)()/(.+/.+/[0-9]+/product\\.html.*)$","^(http(s)?)://(www\\.)(staples\\.com)()/(.*/product_[^/]+)$","^(http(s)?)://(www\\.)(target\\.com)()/(p/.+)$","^(http(s)?)://(www\\.)(walmart\\.com)()/(ip/.*)$"]},App_Id:{Description:"For identifying the Web Clipper during interaction with external services",Value:"OneNote Web Clipper"},Misc_Data_Endpoint_Id:{Description:"The id of the data endpoint used for miscellaneous logging",Value:"production"},Aria_Token:{Description:"For sending log events to the Aria production tenant 'OneNote Web Clipper (production)'",Value:"c7f3f24bc5f746d7b9d8f8e422fdd8a5-1cb58166-2598-485f-897c-1d3c8e62d30e-7560"},LogCategory_RatingsPrompt:{Description:"OFeedback log category for the ratings prompt feature",Value:"OneNoteClipperRatingsPrompt"},Bookmarklet_RatingsEnabled:{Description:"If true, ratings prompt will be enabled for the bookmarklet",Value:"false"},ChromeExtension_RatingsEnabled:{Description:"If true, ratings prompt will be enabled for the Chrome extension",Value:"true"},EdgeExtension_RatingsEnabled:{Description:"If true, ratings prompt will be enabled for the Edge extension",Value:"false"},FirefoxExtension_RatingsEnabled:{Description:"If true, ratings prompt will be enabled for the Firefox extension",Value:"false"},SafariExtension_RatingsEnabled:{Description:"If true, ratings prompt will be enabled for the Safari extension",Value:"false"},ChromeExtension_RatingUrl:{Description:"URL for the Web Clipper in the Chrome Web Store; used to direct users to leave ratings and reviews",Value:"https://chrome.google.com/webstore/detail/onenote-web-clipper/gojbdfnpnhogfdgjbigejoaolejmgdhk/reviews"},EdgeExtension_RatingUrl:{Description:"URL for the Web Clipper in the Windows Store; used to direct users to leave ratings and reviews",Value:"https://www.microsoft.com/en-us/store/p/onenote-web-clipper/9nblggh4r01n#ratings-reviews"},FirefoxExtension_RatingUrl:{Description:"URL for the Web Clipper in Firefox Add-ons; used to direct users to leave ratings and reviews",Value:""}}},{}],37:[function(e,t,o){t.exports={"WebClipper.Action.BackToHome":"Back","WebClipper.Action.Cancel":"Cancel","WebClipper.Action.Clip":"Clip","WebClipper.Action.Feedback":"Feedback?","WebClipper.Action.RefreshPage":"Refresh Page","WebClipper.Action.Signin":"Sign In","WebClipper.Action.SigninMsa":"Sign in with a Microsoft account","WebClipper.Action.SigninOrgId":"Sign in with a work or school account","WebClipper.Action.SignOut":"Sign Out","WebClipper.Action.TryAgain":"Try Again","WebClipper.Action.ViewInOneNote":"View in OneNote","WebClipper.BetaTag":"beta","WebClipper.ClipType.Article.Button":"Article","WebClipper.ClipType.Article.ProgressLabel":"Clipping Article","WebClipper.ClipType.Bookmark.Button":"Bookmark","WebClipper.ClipType.Bookmark.Button.Tooltip":"Clip just the title, thumbnail, synopsis, and link.","WebClipper.ClipType.Bookmark.ProgressLabel":"Clipping Bookmark","WebClipper.ClipType.Button.Tooltip":"Clip just the {0} in an easy-to-read format.","WebClipper.ClipType.Image.Button":"Image","WebClipper.ClipType.ImageSnippet.Button":"Image Snippet","WebClipper.ClipType.MultipleRegions.Button.Tooltip":"Take screenshots of parts of the page you'll select.","WebClipper.ClipType.Pdf.Button":"PDF File","WebClipper.ClipType.Pdf.ProgressLabel":"Clipping PDF File","WebClipper.ClipType.Pdf.Button.Tooltip":"Take a screenshot of the whole PDF file and save a copy of the attachment.","WebClipper.ClipType.Product.Button":"Product","WebClipper.ClipType.Product.ProgressLabel":"Clipping Product","WebClipper.ClipType.Recipe.Button":"Recipe","WebClipper.ClipType.Recipe.ProgressLabel":"Clipping Recipe","WebClipper.ClipType.Region.Button":"Region","WebClipper.ClipType.Region.Button.Tooltip":"Take a screenshot of the part of the page you'll select.","WebClipper.ClipType.Region.ProgressLabel":"Clipping Region","WebClipper.ClipType.ScreenShot.Button":"Full Page","WebClipper.ClipType.ScreenShot.Button.Tooltip":"Take a screenshot of the whole page, just like you see it.","WebClipper.ClipType.ScreenShot.ProgressLabel":"Clipping Page","WebClipper.ClipType.Selection.Button":"Selection","WebClipper.ClipType.Selection.Button.Tooltip":"Clip the selection you made on the web page.","WebClipper.ClipType.Selection.ProgressLabel":"Clipping Selection","WebClipper.Error.NoOpError":"Sorry, we can't clip this page right now","WebClipper.Error.CannotClipPage":"Sorry, this type of page can't be clipped.","WebClipper.Error.CorruptedSection":"Your clip can't be saved here because the section is corrupt.","WebClipper.Error.GenericError":"Something went wrong. Please try clipping the page again.","WebClipper.Error.NotProvisioned":"Your clip can't be saved because your OneDrive for Business account isn't set up.","WebClipper.Error.PasswordProtected":"Your clip can't be saved here because the section is password protected.","WebClipper.Error.QuotaExceeded":"Your clip can't be saved because your OneDrive account has reached its size limit.","WebClipper.Error.ResourceDoesNotExist":"Your clip can't be saved here because the location no longer exists. Please try clipping to another location.","WebClipper.Error.SectionTooLarge":"Your clip can't be saved here because the section has reached its size limit.","WebClipper.Error.UserAccountSuspended":"Your clip can't be saved because your Microsoft account has been suspended.","WebClipper.Error.UserAccountSuspendedResetText":"Reset Your Account","WebClipper.Error.GenericExpiredTokenRefreshError":"Your login session has ended and we were unable to clip the page. Please sign in again.","WebClipper.Error.SignInUnsuccessful":"We couldn't sign you in. Please try again.","WebClipper.Error.OrphanedWebClipperDetected":"Something went wrong. Please refresh this page, and try to clip again.","WebClipper.Extension.RefreshTab":"Please refresh this page, and try to clip again.","WebClipper.FromCitation":"Clipped from: {0}","WebClipper.Label.Annotation":"Note","WebClipper.Label.AnnotationPlaceholder":"Add a note...","WebClipper.Label.ClipImageToOneNote":"Clip Image to OneNote","WebClipper.Label.ClipLocation":"Location","WebClipper.Label.ClipSelectionToOneNote":"Clip Selection to OneNote","WebClipper.Label.ClipSuccessful":"Clip Successful!","WebClipper.Label.DragAndRelease":"Drag and release to capture a screenshot","WebClipper.Label.OneNoteClipper":"OneNote Clipper","WebClipper.Label.OneNoteWebClipper":"OneNote Web Clipper","WebClipper.Label.OpenChangeLogFromTooltip":"Check out what's new","WebClipper.Label.ProceedToWebClipper":"Proceed to the Web Clipper","WebClipper.Label.ProceedToWebClipperFun":"Try it out!","WebClipper.Label.SignInDescription":"Save anything on the web to OneNote in one click","WebClipper.Label.UnsupportedBrowser":"Sorry, your browser version is unsupported.","WebClipper.Label.WebClipper":"Web Clipper","WebClipper.Label.WebClipperWasUpdated":"OneNote Web Clipper has been updated","WebClipper.Label.WebClipperWasUpdatedFun":"OneNote Web Clipper is now better than ever!","WebClipper.Label.PdfTooltip":"Clip this PDF to OneNote, and read it later","WebClipper.Label.ProductTooltip":"Clip and save product details like this to OneNote","WebClipper.Label.RecipeTooltip":"Save clutter-free recipes right to OneNote","WebClipper.Label.VideoTooltip":"Clip this video and watch it anytime in OneNote","WebClipper.Label.WhatsNew":"What's New","WebClipper.Label.Ratings.Message.End":"Thanks for your feedback!","WebClipper.Label.Ratings.Message.Feedback":"Help us improve","WebClipper.Label.Ratings.Message.Init":"Enjoying the Web Clipper?","WebClipper.Label.Ratings.Message.Rate":"Glad you like it!","WebClipper.Label.Ratings.Button.Feedback":"Provide feedback","WebClipper.Label.Ratings.Button.Init.Positive":"Yes, it's great!","WebClipper.Label.Ratings.Button.Init.Negative":"Not really...","WebClipper.Label.Ratings.Button.NoThanks":"No thanks","WebClipper.Label.Ratings.Button.Rate":"Rate us 5 stars","WebClipper.Preview.AugmentationModeGenericError":"Something went wrong creating the preview. Try again, or choose a different clipping mode.","WebClipper.Preview.BookmarkModeGenericError":"Something went wrong creating the bookmark. Try again, or choose a different clipping mode.","WebClipper.Preview.FullPageModeGenericError":"A preview isn't available, but you can still clip your page.","WebClipper.Preview.LoadingMessage":"Loading preview...","WebClipper.Preview.NoContentFound":"No article found. Try another clipping mode.","WebClipper.Preview.UnableToClipLocalFile":"Local files can only be clipped using Region mode.","WebClipper.Preview.Header.AddAnotherRegionButtonLabel":"Add another region","WebClipper.Preview.Header.SansSerifButtonLabel":"Sans-serif","WebClipper.Preview.Header.SerifButtonLabel":"Serif","WebClipper.Preview.Spinner.ClipAnyTimeInFullPage":"In a hurry? You can clip any time in Full Page mode!","WebClipper.SectionPicker.DefaultLocation":"Default location","WebClipper.SectionPicker.LoadingNotebooks":"Loading notebooks...","WebClipper.SectionPicker.NoNotebooksFound":"You don't have any notebooks yet, so we'll create your default notebook when you clip this page.","WebClipper.SectionPicker.NotebookLoadFailureMessage":"OneNote couldn't load your notebooks. Please try again later.","WebClipper.SectionPicker.NotebookLoadUnretryableFailureMessage":"OneNote couldn't load your notebooks.","WebClipper.FontFamily.Regular":"Segoe UI Regular,Segoe UI,Segoe,Segoe WP,Helvetica Neue,Roboto,Helvetica,Arial,Tahoma,Verdana,sans-serif","WebClipper.FontFamily.Bold":"Segoe UI Bold,Segoe UI,Segoe,Segoe WP,Helvetica Neue,Roboto,Helvetica,Arial,Tahoma,Verdana,sans-serif","WebClipper.FontFamily.Light":"Segoe UI Light,Segoe WP Light,Segoe UI,Segoe,Segoe WP,Helvetica Neue,Roboto,Helvetica,Arial,Tahoma,Verdana,sans-serif","WebClipper.FontFamily.Preview.SerifDefault":"Georgia","WebClipper.FontFamily.Preview.SansSerifDefault":"Verdana","WebClipper.FontFamily.Semibold":"Segoe UI Semibold,Segoe UI,Segoe,Segoe WP,Helvetica Neue,Roboto,Helvetica,Arial,Tahoma,Verdana,sans-serif","WebClipper.FontFamily.Semilight":"Segoe UI Semilight,Segoe UI Light,Segoe WP Light,Segoe UI,Segoe,Segoe WP,Helvetica Neue,Roboto,Helvetica,Arial,Tahoma,Verdana,sans-serif","WebClipper.FontSize.Preview.SerifDefault":"16px","WebClipper.FontSize.Preview.SansSerifDefault":"16px"}},{}]},{},[17])(17)});
/*
The MIT License (MIT)

Copyright (c) 2015 OneNoteDev

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
*/
!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.OneNoteApi=t()}}(function(){return function t(e,r,n){function o(i,s){if(!r[i]){if(!e[i]){var u="function"==typeof require&&require;if(!s&&u)return u(i,!0);if(a)return a(i,!0);var p=new Error("Cannot find module '"+i+"'");throw p.code="MODULE_NOT_FOUND",p}var c=r[i]={exports:{}};e[i][0].call(c.exports,function(t){var r=e[i][1][t];return o(r?r:t)},c,c.exports,t,e,r,n)}return r[i].exports}for(var a="function"==typeof require&&require,i=0;i<n.length;i++)o(n[i]);return o}({1:[function(t,e,r){"use strict";!function(t){t[t.Html=0]="Html",t[t.Image=1]="Image",t[t.EnhancedUrl=2]="EnhancedUrl",t[t.Url=3]="Url",t[t.Onml=4]="Onml"}(r.ContentType||(r.ContentType={}));r.ContentType},{}],2:[function(t,e,r){"use strict";!function(t){t[t.NETWORK_ERROR=0]="NETWORK_ERROR",t[t.UNEXPECTED_RESPONSE_STATUS=1]="UNEXPECTED_RESPONSE_STATUS",t[t.REQUEST_TIMED_OUT=2]="REQUEST_TIMED_OUT",t[t.UNABLE_TO_PARSE_RESPONSE=3]="UNABLE_TO_PARSE_RESPONSE"}(r.RequestErrorType||(r.RequestErrorType={}));var n=r.RequestErrorType,o=function(){function t(){}return t.createRequestErrorObject=function(e,r){if(void 0!==e&&null!==e)return t.createRequestErrorObjectInternal(e.status,e.readyState,e.response,e.getAllResponseHeaders(),e.timeout,r)},t.createRequestErrorObjectInternal=function(e,r,o,a,i,s){var u=t.formatRequestErrorTypeAsString(s);s===n.NETWORK_ERROR&&(u+=t.getAdditionalNetworkErrorInfo(r)),s===n.REQUEST_TIMED_OUT&&(e=408);var p={error:u,statusCode:e,responseHeaders:t.convertResponseHeadersToJsonInternal(a),response:o};return i>0&&!(e>=200&&e<300)&&(p.timeout=i),p},t.convertResponseHeadersToJson=function(e){if(void 0!==e&&null!==e){var r=e.getAllResponseHeaders();return t.convertResponseHeadersToJsonInternal(r)}},t.convertResponseHeadersToJsonInternal=function(t){for(var e,r=/([^:]+):\s?(.*)/g,n={};e=r.exec(t);){e.index===r.lastIndex&&r.lastIndex++;var o=e[1].trim(),a=e[2].trim();n[o]=a}return n},t.getAdditionalNetworkErrorInfo=function(t){return": "+JSON.stringify({readyState:t})},t.formatRequestErrorTypeAsString=function(t){var e=n[t];return e.charAt(0).toUpperCase()+e.replace(/_/g," ").toLowerCase().slice(1)},t}();r.ErrorUtils=o},{}],3:[function(t,e,r){"use strict";var n=function(){function t(){}return t.sectionExistsInNotebooks=function(e,r){if(!e||!r)return!1;for(var n=0;n<e.length;n++)if(t.sectionExistsInParent(e[n],r))return!0;return!1},t.sectionExistsInParent=function(e,r){if(!e||!r)return!1;if(e.sections)for(var n=0;n<e.sections.length;n++){var o=e.sections[n];if(o&&o.id===r)return!0}if(e.sectionGroups)for(var n=0;n<e.sectionGroups.length;n++)if(t.sectionExistsInParent(e.sectionGroups[n],r))return!0;return!1},t.getPathFromNotebooksToSection=function(e,r){if(e&&r)for(var n=0;n<e.length;n++){var o=e[n],a=t.getPathFromParentToSection(o,r);if(a)return a}},t.getPathFromParentToSection=function(e,r){if(e&&r){if(e.sections)for(var n=0;n<e.sections.length;n++){var o=e.sections[n];if(r(o))return[e,o]}if(e.sectionGroups)for(var n=0;n<e.sectionGroups.length;n++){var a=e.sectionGroups[n],i=t.getPathFromParentToSection(a,r);if(i)return i.unshift(e),i}}},t.getDepthOfNotebooks=function(e){return e&&0!==e.length?e.map(function(e){return t.getDepthOfParent(e)}).reduce(function(t,e){return Math.max(t,e)}):0},t.getDepthOfParent=function(e){if(!e)return 0;var r=e.sections&&e.sections.length>0,n=r?1:0;if(e.sectionGroups)for(var o=0;o<e.sectionGroups.length;o++)n=Math.max(t.getDepthOfParent(e.sectionGroups[o]),n);return n+1},t}();r.NotebookUtils=n},{}],4:[function(t,e,r){"use strict";var n=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},o=t("./oneNoteApiBase"),a=function(t){function e(e,r,n){void 0===r&&(r=3e4),void 0===n&&(n={}),t.call(this,e,r,n)}return n(e,t),e.prototype.createNotebook=function(t){var e=JSON.stringify({name:t});return this.requestPromise(this.getNotebooksUrl(),e)},e.prototype.createPage=function(t,e){var r=e?"/sections/"+e:"",n=r+"/pages",o=t.getTypedFormData();return this.requestPromise(n,o.asBlob(),o.getContentType())},e.prototype.createSection=function(t,e){var r={name:e},n=JSON.stringify(r);return this.requestPromise("/notebooks/"+t+"/sections/",n)},e.prototype.getNotebooks=function(t){return void 0===t&&(t=!0),this.requestPromise(this.getNotebooksUrl(null,t))},e.prototype.getNotebooksWithExpandedSections=function(t,e){return void 0===t&&(t=2),void 0===e&&(e=!0),this.requestPromise(this.getNotebooksUrl(t,e))},e.prototype.getNotebookByName=function(t){return this.requestPromise("/notebooks?filter=name%20eq%20%27"+encodeURI(t)+"%27&orderby=createdTime")},e.prototype.pagesSearch=function(t){return this.requestPromise(this.getSearchUrl(t))},e.prototype.getExpands=function(t){if(t<=0)return"";var e="$expand=sections,sectionGroups";return 1===t?e:e+"("+this.getExpands(t-1)+")"},e.prototype.getNotebooksUrl=function(t,e){void 0===t&&(t=0),void 0===e&&(e=!0);var r=e?"$filter=userRole%20ne%20Microsoft.OneNote.Api.UserRole'Reader'":"";return"/notebooks?"+r+(t?"&"+this.getExpands(t):"")},e.prototype.getSearchUrl=function(t){return"/pages?search="+t},e}(o.OneNoteApiBase);r.OneNoteApi=a;var i=t("./contentType");r.ContentType=i.ContentType;var s=t("./oneNotePage");r.OneNotePage=s.OneNotePage;var u=t("./errorUtils");r.ErrorUtils=u.ErrorUtils,r.RequestErrorType=u.RequestErrorType;var p=t("./notebookUtils");r.NotebookUtils=p.NotebookUtils},{"./contentType":1,"./errorUtils":2,"./notebookUtils":3,"./oneNoteApiBase":5,"./oneNotePage":6}],5:[function(t,e,r){"use strict";var n=t("./errorUtils"),o=function(){function t(t,e,r){void 0===r&&(r={}),this.useBetaApi=!1,this.token=t,this.timeout=e,this.headers=r}return t.prototype.requestPromise=function(t,e,r){var n=this,o=this.generateFullUrl(t);return null===r&&(r="application/json"),new Promise(function(t,a){n.makeRequest(o,e,r).then(function(e){t(e)},function(t){a(t)})})},t.prototype.generateFullUrl=function(t){var e=this.useBetaApi?"https://www.onenote.com/api/beta/me/notes":"https://www.onenote.com/api/v1.0/me/notes";return e+t},t.prototype.makeRequest=function(e,r,o){var a=this;return new Promise(function(i,s){var u=new XMLHttpRequest,p=r?"POST":"GET";u.open(p,e),u.timeout=a.timeout,u.onload=function(){if(200===u.status||201===u.status)try{var t=JSON.parse(u.response),e={parsedResponse:t,request:u};i(e)}catch(r){s(n.ErrorUtils.createRequestErrorObject(u,n.RequestErrorType.UNABLE_TO_PARSE_RESPONSE))}else s(n.ErrorUtils.createRequestErrorObject(u,n.RequestErrorType.UNEXPECTED_RESPONSE_STATUS))},u.onerror=function(){s(n.ErrorUtils.createRequestErrorObject(u,n.RequestErrorType.NETWORK_ERROR))},u.ontimeout=function(){s(n.ErrorUtils.createRequestErrorObject(u,n.RequestErrorType.REQUEST_TIMED_OUT))},o&&u.setRequestHeader("Content-Type",o),u.setRequestHeader("Authorization","Bearer "+a.token),t.addHeadersToRequest(u,a.headers),u.send(r)})},t.addHeadersToRequest=function(t,e){if(e)for(var r in e)e.hasOwnProperty(r)&&t.setRequestHeader(r,e[r])},t}();r.OneNoteApiBase=o},{"./errorUtils":2}],6:[function(t,e,r){"use strict";var n=t("./typedFormData"),o=function(){function t(t,e,r,n){void 0===t&&(t=""),void 0===e&&(e=""),void 0===r&&(r="en-us"),void 0===n&&(n=void 0),this.dataParts=[],this.title=t,this.presentationBody=e,this.locale=r,this.pageMetadata=n}return t.prototype.getEntireOnml=function(){return'<html xmlns="http://www.w3.org/1999/xhtml" lang='+this.locale+">"+this.getHeadAsHtml()+"<body>"+this.presentationBody+"</body></html>"},t.prototype.getHeadAsHtml=function(){var t=this.getPageMetadataAsHtml(),e=this.formUtcOffsetString(new Date);return"<head><title>"+this.escapeHtmlEntities(this.title)+'</title><meta name="created" content="'+e+' ">'+t+"</head>"},t.prototype.getPageMetadataAsHtml=function(){var t="";if(this.pageMetadata)for(var e in this.pageMetadata)t+='<meta name="'+e+'" content="'+this.escapeHtmlEntities(this.pageMetadata[e])+'" />';return t},t.prototype.formUtcOffsetString=function(t){var e=t.getTimezoneOffset(),r=e>=0?"-":"+";e=Math.abs(e);var n=Math.floor(e/60)+"",o=Math.round(e%60)+"";return parseInt(n,10)<10&&(n="0"+n),parseInt(o,10)<10&&(o="0"+o),r+n+":"+o},t.prototype.generateMimePartName=function(t){return t+Math.floor(1e4*Math.random()).toString()},t.prototype.escapeHtmlEntities=function(t){var e=document.createElement("div");return e.innerText=t,e.innerHTML},t.prototype.getTypedFormData=function(){var t=new n.TypedFormData;t.append("Presentation",this.getEntireOnml(),"application/xhtml+xml");for(var e=0;e<this.dataParts.length;e++){var r=this.dataParts[e];t.append(r.name,r.content,r.type)}return t},t.prototype.addOnml=function(t){this.presentationBody+=t},t.prototype.addHtml=function(t){var e=this.generateMimePartName("Html");return this.dataParts.push({content:t,name:e,type:"text/HTML"}),this.addOnml('<img data-render-src="name:'+e+'"/>'),e},t.prototype.addImage=function(t){this.addOnml('<img src="'+t+'"/>')},t.prototype.addObjectUrlAsImage=function(t){this.addOnml('<img data-render-src="'+t+'"/>')},t.prototype.addAttachment=function(t,e){var r=this.generateMimePartName("Attachment");return this.dataParts.push({content:t,name:r,type:"application/pdf"}),this.addOnml('<object data-attachment="'+e+'" data="name:'+r+'" type="application/pdf" />'),r},t.prototype.addUrl=function(t){this.addOnml('<div data-render-src="'+t+'" data-render-method="extract" data-render-fallback="none"></div>')},t.prototype.addCitation=function(t,e,r){this.addOnml(t.replace("{0}",'<a href="'+(r?r:e)+'">'+e+"</a>"))},t}();r.OneNotePage=o},{"./typedFormData":7}],7:[function(t,e,r){"use strict";var n=function(){function t(){this.contentTypeMultipart="multipart/form-data; boundary=",this.dataParts=[],this.boundaryName="OneNoteTypedDataBoundary"+Math.floor(1e3*Math.random())}return t.prototype.getContentType=function(){return this.contentTypeMultipart+this.boundaryName},t.prototype.append=function(t,e,r){this.dataParts.push({content:e,name:t,type:r})},t.prototype.asBlob=function(){for(var t="--"+this.boundaryName,e=[t],r=0;r<this.dataParts.length;r++){var n=this.dataParts[r],o="\r\nContent-Type: "+n.type+'\r\nContent-Disposition: form-data; name="'+n.name+'"\r\n\r\n';e.push(o),e.push(n.content),e.push("\r\n"+t)}return e.push("--\r\n"),new Blob(e)},t}();r.TypedFormData=n},{}]},{},[4])(4)});
!function e(t,n,o){function r(a,s){if(!n[a]){if(!t[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(i)return i(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var p=n[a]={exports:{}};t[a][0].call(p.exports,function(e){var n=t[a][1][e];return r(n?n:e)},p,p.exports,e,t,n,o)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<o.length;a++)r(o[a]);return r}({1:[function(e,t,n){"use strict";!function(e){e[e.Bookmarklet=0]="Bookmarklet",e[e.ChromeExtension=1]="ChromeExtension",e[e.EdgeExtension=2]="EdgeExtension",e[e.FirefoxExtension=3]="FirefoxExtension",e[e.SafariExtension=4]="SafariExtension"}(n.ClientType||(n.ClientType={}));n.ClientType},{}],2:[function(e,t,n){"use strict";var o=e("../extensions/invokeSource");!function(e){e[e.ChangeLog=0]="ChangeLog",e[e.Pdf=1]="Pdf",e[e.Product=2]="Product",e[e.Recipe=3]="Recipe",e[e.Video=4]="Video",e[e.WhatsNew=5]="WhatsNew"}(n.TooltipType||(n.TooltipType={}));var r,i=n.TooltipType;!function(e){function t(e){switch(e){case i.Pdf:return o.InvokeSource.PdfTooltip;case i.Product:return o.InvokeSource.ProductTooltip;case i.Recipe:return o.InvokeSource.RecipeTooltip;case i.Video:return o.InvokeSource.VideoTooltip;case i.WhatsNew:return o.InvokeSource.WhatsNewTooltip;default:throw Error("Invalid TooltipType passed in TooltipType.toInvokeSource")}}e.toInvokeSource=t}(r=n.TooltipTypeUtils||(n.TooltipTypeUtils={}))},{"../extensions/invokeSource":15}],3:[function(e,t,n){"use strict";var o=function(){function e(e,t){this.otherSideKeys={},this.queuedCalls={},this.callbackIdPostfix=0,this.functionMap={},this.svFunctions={},this.trackedSmartValues={},this.channel=t,this.messageHandler=e,this.messageHandler.onMessageReceived=this.parseMessage.bind(this),this.sendInitializationMessage()}return e.prototype.getMessageHandler=function(){return this.messageHandler},e.prototype.onInitialized=function(){},e.prototype.tearDown=function(){for(var e in this.trackedSmartValues)if(this.trackedSmartValues.hasOwnProperty(e)&&this.svFunctions[e])for(var t=0;t<this.svFunctions[e].length;t++)this.trackedSmartValues[e].unsubscribe(this.svFunctions[e][t]);this.messageHandler.tearDown()},e.prototype.setErrorHandler=function(e){this.communicatorErrorHandler=e},e.prototype.parseMessage=function(e){var t;try{t=JSON.parse(e)}catch(e){return}if(t&&(!this.channel||t.channel&&t.channel===this.channel)&&(this.channel||!t.channel))try{this.handleDataPackage(t)}catch(e){if(!this.communicatorErrorHandler)throw e;this.communicatorErrorHandler(e)}},e.prototype.handleDataPackage=function(t){var n=this;if(t.functionKey===e.initializationKey){this.sendAcknowledgementMessage();for(var o in this.functionMap)this.functionMap.hasOwnProperty(o)&&this.postMessage({data:o,functionKey:e.registrationKey});this.onInitialized()}else if(t.functionKey===e.acknowledgeKey)this.onInitialized();else if(t.functionKey===e.registrationKey){var r=t.data.toString();if(this.otherSideKeys[r]||(this.otherSideKeys[r]=!0),this.isSmartValueSubscription(r)){var i=r.substr(e.setValuePrefix.length),a=this.trackedSmartValues[i];a&&this.updateRemoteSmartValue(i,a.get())}else if(this.queuedCalls[r]){for(var s=this.queuedCalls[r],l=0;l<s.length;l++)this.postMessage(s[l]);delete this.queuedCalls[r]}}else{var u=this.functionMap[t.functionKey];if(u){var p=u(t.data);p&&p.then&&t.callbackKey&&p.then(function(e){n.callRemoteFunction(t.callbackKey,{param:e})},function(e){n.callRemoteFunction(t.callbackKey,{param:e})})}}},e.prototype.registerFunction=function(t,n){if(!t)throw new Error("param 'name' is invalid");this.functionMap[t]=n,this.postMessage({data:t,functionKey:e.registrationKey})},e.prototype.callRemoteFunction=function(t,n){if(!t)throw new Error("param 'name' is invalid");var o=n?n.param:void 0,r=void 0;n&&n.callback&&(r=t+e.callbackPostfix+"-"+this.callbackIdPostfix++,this.registerFunction(r,n.callback));var i={data:o,functionKey:t};r&&(i.callbackKey=r),this.otherSideKeys[t]?this.postMessage(i):this.isSmartValueSubscription(t)||(this.queuedCalls[t]=this.queuedCalls[t]||[],this.queuedCalls[t].push(i))},e.prototype.subscribeAcrossCommunicator=function(t,n,o){o&&t.subscribe(o,{callOnSubscribe:!1}),this.registerFunction(e.setValuePrefix+n,function(e){t.set(e)})},e.prototype.broadcastAcrossCommunicator=function(e,t){var n=this,o=function(e){n.updateRemoteSmartValue(t,e)};this.svFunctions[t]||(this.svFunctions[t]=[]),this.svFunctions[t].push(o),this.trackedSmartValues[t]=e,e.subscribe(o)},e.prototype.updateRemoteSmartValue=function(t,n){this.callRemoteFunction(e.setValuePrefix+t,{param:n})},e.prototype.sendInitializationMessage=function(){this.postMessage({functionKey:e.initializationKey})},e.prototype.sendAcknowledgementMessage=function(){this.postMessage({functionKey:e.acknowledgeKey})},e.prototype.isSmartValueSubscription=function(t){return t.substr(0,e.setValuePrefix.length)===e.setValuePrefix},e.prototype.postMessage=function(e){this.channel&&(e.channel=this.channel);try{this.messageHandler.sendMessage(JSON.stringify(e))}catch(e){if(!this.communicatorErrorHandler)throw e;this.communicatorErrorHandler(e)}},e.initializationKey="INITIALIZATION-K3Y",e.acknowledgeKey="ACKNOWLEDGE-K3Y",e.registrationKey="REGISTER-FUNCTION-K3Y",e.setValuePrefix="SETVALUE-",e.callbackPostfix="-CALLBACK",e}();n.Communicator=o},{}],4:[function(e,t,n){"use strict";var o=function(){function e(){}return e.prototype.onMessageReceived=function(e){},e}();n.MessageHandler=o},{}],5:[function(e,t,n){"use strict";var o=function(){function e(e){this.subscriptions=[],this.t=e}return e.prototype.subscribe=function(e,t){void 0===t&&(t={}),void 0===t.times&&(t.times=1/0),void 0===t.callOnSubscribe&&(t.callOnSubscribe=!0),t.callOnSubscribe&&e(this.t),t.times>0&&this.subscriptions.push({func:e,times:t.times})},e.prototype.unsubscribe=function(e){for(var t=0;t<this.subscriptions.length;t++)if(e===this.subscriptions[t].func)return void this.subscriptions.splice(t,1)},e.prototype.set=function(e){return this.t!==e&&(this.t=e,this.notifySubscribers()),this},e.prototype.get=function(){return this.t},e.prototype.forceUpdate=function(){this.notifySubscribers()},e.prototype.equals=function(e){return this.t===e},e.prototype.toString=function(){return this.t?this.t.toString():"undefined"},e.prototype.notifySubscribers=function(){for(var e=this.subscriptions.length,t=0;t<e;t++){this.subscriptions[t].times--,this.subscriptions[t].func(this.t);var n=this.subscriptions[t]&&0===this.subscriptions[t].times;n&&this.subscriptions.splice(t,1),this.subscriptions[t]&&!n||(e--,t--)}},e.subscribe=function(e,t){for(var n=0;n<e.length;n++)e[n].subscribe(function(){for(var n=[],o=0;o<e.length;o++)n.push(e[o].get());t.apply(this,n)})},e}();n.SmartValue=o},{}],6:[function(e,t,n){"use strict";var o;!function(e){var t;!function(e){e.heightAnimator="height-animator",e.panelAnimator="panel-animator",e.change="change",e.changes="changes",e.changeBody="change-body",e.changeDescription="change-description",e.changeImage="change-image",e.changeTitle="change-title",e.textAreaInput="textAreaInput",e.textAreaInputMirror="textAreaInputMirror",e.deleteHighlightButton="delete-highlight",e.highlightable="highlightable",e.highlighted="highlighted",e.regionSelection="region-selection",e.regionSelectionImage="region-selection-image",e.regionSelectionRemoveButton="region-selection-remove-button",e.spinner="spinner",e.tooltip="tooltip",e.centeredInPreview="centered-in-preview"}(t=e.Classes||(e.Classes={}));var n;!function(e){e.clipperInfo="ClipperInfo"}(n=e.Cookies||(e.Cookies={}));var o;!function(e){e.annotationContainer="annotationContainer",e.annotationField="annotationField",e.annotationFieldMirror="annotationFieldMirror",e.annotationPlaceholder="annotationPlaceholder",e.bookmarkThumbnail="bookmarkThumbnail",e.bookmarkPreviewContentContainer="bookmarkPreviewContentContainer",e.bookmarkPreviewInnerContainer="bookmarkPreviewInnerContainer",e.clipperApiProgressContainer="clipperApiProgressContainer",e.dialogBackButton="dialogBackButton",e.dialogButtonContainer="dialogButtonContainer",e.dialogDebugMessageContainer="dialogDebugMessageContainer",e.dialogMessageContainer="dialogMessageContainer",e.dialogContentContainer="dialogContentContainer",e.dialogMessage="dialogMessage",e.dialogTryAgainButton="dialogTryAgainButton",e.highlightablePreviewBody="highlightablePreviewBody",e.apiErrorMessage="apiErrorMessage",e.backToHomeButton="backToHomeButton",e.clipperFailureContainer="clipperFailureContainer",e.refreshPageButton="refreshPageButton",e.tryAgainButton="tryAgainButton",e.clipperFooterContainer="clipperFooterContainer",e.currentUserControl="currentUserControl",e.currentUserDetails="currentUserDetails",e.currentUserEmail="currentUserEmail",e.currentUserId="currentUserId",e.currentUserName="currentUserName",e.feedbackButton="feedbackButton",e.feedbackImage="feedbackImage",e.signOutButton="signOutButton",e.userDropdownArrow="userDropdownArrow",e.userSettingsContainer="userSettingsContainer",e.clipperLoadingContainer="clipperLoadingContainer",e.closeButton="closeButton",e.closeButtonContainer="closeButtonContainer",e.mainController="mainController",e.saveToLocationContainer="saveToLocationContainer",e.clipButton="clipButton",e.clipButtonContainer="clipButtonContainer",e.previewBody="previewBody",e.previewContentContainer="previewContentContainer",e.previewHeader="previewHeader",e.previewHeaderContainer="previewHeaderContainer",e.previewHeaderInput="previewHeaderInput",e.previewHeaderInputMirror="previewHeaderInputMirror",e.previewTitleContainer="previewTitleContainer",e.previewSubtitleContainer="previewSubtitleContainer",e.previewInnerContainer="previewInnerContainer",e.previewOptionsContainer="previewOptionsContainer",e.previewInnerWrapper="previewInnerWrapper",e.previewOuterContainer="previewOuterContainer",e.previewUrlContainer="previewUrlContainer",e.previewNotesContainer="previewNotesContainer",e.fullPageControl="fullPageControl",e.fullPageHeaderTitle="fullPageHeaderTitle",e.addAnotherRegionButton="addAnotherRegionButton",e.addRegionControl="addRegionControl",e.regionControl="regionControl",e.regionHeaderTitle="regionHeaderTitle",e.highlightControl="highlightControl",e.highlightButton="highlightButton",e.decrementFontSize="decrementFontSize",e.incrementFontSize="incrementFontSize",e.serifControl="serifControl",e.sansSerif="sansSerif",e.serif="serif",e.bookmarkControl="bookmarkControl",e.bookmarkHeaderTitle="bookmarkHeaderTitle",e.ratingsButtonFeedbackNo="ratingsButtonFeedbackNo",e.ratingsButtonFeedbackYes="ratingsButtonFeedbackYes",e.ratingsButtonInitNo="ratingsButtonInitNo",e.ratingsButtonInitYes="ratingsButtonInitYes",e.ratingsButtonRateNo="ratingsButtonRateNo",e.ratingsButtonRateYes="ratingsButtonRateYes",e.ratingsPromptContainer="ratingsPromptContainer",e.regionInstructionsContainer="regionInstructionsContainer",e.regionClipCancelButton="regionClipCancelButton",e.innerFrame="innerFrame",e.outerFrame="outerFrame",e.regionSelectorContainer="regionSelectorContainer",e.spinnerText="spinnerText",e.locationPickerContainer="locationPickerContainer",e.signInButtonMsa="signInButtonMsa",e.signInButtonOrgId="signInButtonOrgId",e.signInContainer="signInContainer",e.signInLogo="signInLogo",e.signInMessageLabelContainer="signInMessageLabelContainer",e.signInText="signInText",e.clipperSuccessContainer="clipperSuccessContainer",e.launchOneNoteButton="launchOneNoteButton",e.pageNavAnimatedTooltip="pageNavAnimatedTooltip",e.unsupportedBrowserContainer="unsupportedBrowserContainer",e.unsupportedBrowserPanel="unsupportedBrowserPanel",e.changeLogSubPanel="changeLogSubPanel",e.checkOutWhatsNewButton="checkOutWhatsNewButton",e.proceedToWebClipperButton="proceedToWebClipperButton",e.whatsNewTitleSubPanel="whatsNewTitleSubPanel",e.clipperRootScript="oneNoteCaptureRootScript",e.clipperUiFrame="oneNoteWebClipper",e.clipperPageNavFrame="oneNoteWebClipperPageNav",e.clipperExtFrame="oneNoteWebClipperExtension",e.brandingContainer="brandingContainer"}(o=e.Ids||(e.Ids={}));var r;!function(e){e.accept="Accept",e.appIdKey="MS-Int-AppId",e.correlationId="X-CorrelationId",e.noAuthKey="X-NoAuth",e.userSessionIdKey="X-UserSessionId"}(r=e.HeaderValues||(e.HeaderValues={}));var i;!function(e){e.debugLoggingInjectedAndExtension="DEBUGLOGGINGINJECTED_AND_EXTENSION",e.extensionAndUi="EXTENSION_AND_UI",e.injectedAndUi="INJECTED_AND_UI",e.injectedAndExtension="INJECTED_AND_EXTENSION",e.extensionAndPageNavUi="EXTENSION_AND_PAGENAVUI",e.pageNavInjectedAndPageNavUi="PAGENAVINJECTED_AND_PAGENAVUI",e.pageNavInjectedAndExtension="PAGENAVINJECTED_AND_EXTENSION"}(i=e.CommunicationChannels||(e.CommunicationChannels={}));var a;!function(e){e.clipperStrings="CLIPPER_STRINGS",e.clipperStringsFrontLoaded="CLIPPER_STRINGS_FRONT_LOADED",e.closePageNavTooltip="CLOSE_PAGE_NAV_TOOLTIP",e.createHiddenIFrame="CREATE_HIDDEN_IFRAME",e.ensureFreshUserBeforeClip="ENSURE_FRESH_USER_BEFORE_CLIP",e.escHandler="ESC_HANDLER",e.getInitialUser="GET_INITIAL_USER",e.getPageNavTooltipProps="GET_PAGE_NAV_TOOLTIP_PROPS",e.getStorageValue="GET_STORAGE_VALUE",e.getMultipleStorageValues="GET_MULTIPLE_STORAGE_VALUES",e.getTooltipToRenderInPageNav="GET_TOOLTIP_TO_RENDER_IN_PAGE_NAV",e.hideUi="HIDE_UI",e.invokeClipper="INVOKE_CLIPPER",e.invokeClipperFromPageNav="INVOKE_CLIPPER_FROM_PAGE_NAV",e.invokeDebugLogging="INVOKE_DEBUG_LOGGING",e.invokePageNav="INVOKE_PAGE_NAV",e.noOpTracker="NO_OP_TRACKER",e.onSpaNavigate="ON_SPA_NAVIGATE",e.refreshPage="REFRESH_PAGE",e.showRefreshClipperMessage="SHOW_REFRESH_CLIPPER_MESSAGE",e.setInjectOptions="SET_INJECT_OPTIONS",e.setInvokeOptions="SET_INVOKE_OPTIONS",e.setStorageValue="SET_STORAGE_VALUE",e.signInUser="SIGN_IN_USER",e.signOutUser="SIGN_OUT_USER",e.tabToLowestIndexedElement="TAB_TO_LOWEST_INDEXED_ELEMENT",e.takeTabScreenshot="TAKE_TAB_SCREENSHOT",e.telemetry="TELEMETRY",e.toggleClipper="TOGGLE_CLIPPER",e.unloadHandler="UNLOAD_HANDLER",e.updateFrameHeight="UPDATE_FRAME_HEIGHT",e.updatePageInfoIfUrlChanged="UPDATE_PAGE_INFO_IF_URL_CHANGED"}(a=e.FunctionKeys||(e.FunctionKeys={}));var s;!function(e){e.tab=9,e.enter=13,e.esc=27}(s=e.KeyCodes||(e.KeyCodes={}));var l;!function(e){e.clientInfo="CLIENT_INFO",e.isFullScreen="IS_FULL_SCREEN",e.pageInfo="PAGE_INFO",e.sessionId="SESSION_ID",e.user="USER"}(l=e.SmartValueKeys||(e.SmartValueKeys={}));var u;!function(e){e.sectionPickerContainerHeight=280,e.clipperUiWidth=322,e.clipperUiTopRightOffset=20,e.clipperUiDropShadowBuffer=7,e.clipperUiInnerPadding=30;var t;!function(e){e.oneNoteHighlightColor="#fefe56"}(t=e.Colors||(e.Colors={}))}(u=e.Styles||(e.Styles={}));var p;!function(e){e.serviceDomain="https://www.onenote.com",e.augmentationApiUrl=e.serviceDomain+"/onaugmentation/clipperextract/v1.0/",e.changelogUrl=e.serviceDomain+"/whatsnext/webclipper",e.clipperFeedbackUrl=e.serviceDomain+"/feedback",e.clipperInstallPageUrl=e.serviceDomain+"/clipper/installed",e.fullPageScreenshotUrl=e.serviceDomain+"/onaugmentation/clipperDomEnhancer/v1.0/",e.localizedStringsUrlBase=e.serviceDomain+"/strings?ids=WebClipper.",e.userFlightingEndpoint=e.serviceDomain+"/webclipper/userflight",e.msaDomain="https://login.live.com",e.orgIdDomain="https://login.microsoftonline.com";var t;!function(t){t.authRedirectUrl=e.serviceDomain+"/webclipper/auth",t.signInUrl=e.serviceDomain+"/webclipper/signin",t.signOutUrl=e.serviceDomain+"/webclipper/signout",t.userInformationUrl=e.serviceDomain+"/webclipper/userinfo"}(t=e.Authentication||(e.Authentication={}));var n;!function(e){e.authType="authType",e.category="category",e.changelogLocale="omkt",e.channel="channel",e.clientType="clientType",e.clipperId="clipperId",e.clipperVersion="clipperVersion",e.correlationId="correlationId",e.error="error",e.errorDescription="errorDescription",e.event="event",e.eventName="eventName",e.failureId="failureId",e.failureInfo="failureInfo",e.failureType="failureType",e.inlineInstall="inlineInstall",e.label="label",e.noOpType="noOpType",e.stackTrace="stackTrace",e.timeoutInMs="timeoutInMs",e.url="url",e.userSessionId="userSessionId",e.wdFromClipper="wdfromclipper"}(n=e.QueryParams||(e.QueryParams={}))}(p=e.Urls||(e.Urls={}));var c;!function(e){e.oneNoteClipperUsage="OneNoteClipperUsage"}(c=e.LogCategories||(e.LogCategories={}));var g;!function(e){e.fontSizeStep=2,e.maxClipSuccessForRatingsPrompt=12,e.maximumJSTimeValue=864e13,e.maximumFontSize=72,e.maximumNumberOfTimesToShowTooltips=3,e.minClipSuccessForRatingsPrompt=4,e.minimumFontSize=8,e.minTimeBetweenBadRatings=6048e6,e.noOpTrackerTimeoutDuration=2e4,e.timeBetweenDifferentTooltips=6048e5,e.timeBetweenSameTooltip=18144e5,e.timeBetweenTooltips=18144e5}(g=e.Settings||(e.Settings={}))}(o=n.Constants||(n.Constants={}))},{}],7:[function(e,t,n){"use strict";var o,r=e("../utils");!function(e){function t(e){if(r.Utils.onWhitelistedDomain(e)){var t=r.Utils.getHostname(e);for(var n in o)if("string"==typeof n&&t.indexOf(n.toLowerCase()+".")>-1)return n}}function n(e,t){if(!r.Utils.isNullOrUndefined(e)){var n,o=[];if(t.forEach(function(t){for(;n=t.exec(e);)n[2]?o.push(n[2]):o.push(n[3])}),0!==o.length)return o.filter(function(e,t,n){return n.indexOf(e)===t})}}e.youTubeWatchVideoBaseUrl="https://www.youtube.com/watch",e.youTubeVideoIdQueryKey="v",function(e){e[e.YouTube=0]="YouTube",e[e.Vimeo=1]="Vimeo",e[e.KhanAcademy=2]="KhanAcademy"}(e.SupportedVideoDomains||(e.SupportedVideoDomains={}));var o=e.SupportedVideoDomains;e.videoDomainIfSupported=t,e.matchRegexFromPageContent=n}(o=n.VideoUtils||(n.VideoUtils={}))},{"../utils":49}],8:[function(e,t,n){"use strict";var o;!function(e){function t(e,t){var r=o[e];if(!n||!n[r])return!1;var i=n[r];return!(!t||t.indexOf(i)===-1)}var n={DummyExperiment:"dummy-flight"};e.updateIntervalForFlights=18e6,function(e){e[e.DummyExperiment=0]="DummyExperiment"}(e.Feature||(e.Feature={}));var o=e.Feature;e.isFeatureEnabled=t}(o=n.Experiments||(n.Experiments={}))},{}],9:[function(e,t,n){"use strict";var o=e("../communicator/smartValue"),r=e("../logging/log"),i=e("../http/http"),a=e("../storage/clipperStorageKeys"),s=e("../constants"),l=e("../userInfo"),u=e("../utils"),p=function(){function e(e,t){this.user=new o.SmartValue,this.logger=t,this.clipperData=e}return e.prototype.updateUserInfoData=function(t,n){var o=this;return new Promise(function(i){var s=0,l=o.clipperData.getValue(a.ClipperStorageKeys.userInformation);if(l){var p=void 0;try{p=JSON.parse(l)}catch(e){o.logger.logJsonParseUnexpected(l)}p&&p.data&&u.Utils.isNumeric(p.data.accessTokenExpiration)&&(s=Math.max(1e3*p.data.accessTokenExpiration-18e4,0))}var c=function(){return new Promise(function(n,o){e.getClipperInfoCookie(t).then(function(r){e.retrieveUserInformation(t,r).then(function(e){n(e)},function(e){o(e)})})})},g=new r.Event.PromiseEvent(r.Event.Label.GetExistingUserInformation);g.setCustomProperty(r.PropertyName.Custom.UserInformationStored,!!l),o.clipperData.getFreshValue(a.ClipperStorageKeys.userInformation,c,s).then(function(e){g.setCustomProperty(r.PropertyName.Custom.FreshUserInfoAvailable,!!e),e?o.user.set({user:e.data,lastUpdated:e.lastUpdated,updateReason:n}):o.user.set({updateReason:n}),i(o.user.get())},function(e){g.setStatus(r.Status.Failed),g.setFailureInfo(e),o.user.set({updateReason:n}),i(o.user.get())}).then(function(){o.logger.logEvent(g)})})},e.getClipperInfoCookie=function(e){return new Promise(function(e){var t=setTimeout(function(){e(void 0)},3e3);navigator.userAgent.search(/edge/i)!==-1?browser.cookies.get({url:s.Constants.Urls.serviceDomain,name:s.Constants.Cookies.clipperInfo},function(n){clearTimeout(t),e(n?n.value:"")}):e(void 0)})},e.deleteUserAuthenticationCookies=function(e){browser.cookies.remove({url:s.Constants.Urls.serviceDomain,name:s.Constants.Cookies.clipperInfo});var t=s.Constants.Urls.msaDomain;e===l.AuthType.OrgId&&(t=s.Constants.Urls.orgIdDomain),browser.cookies.getAll({url:t},function(e){for(var n=0;n<e.length;n++)browser.cookies.remove({url:t+e[n].path,name:e[n].name})})},e.retrieveUserInformation=function(e,t){var n=this;return void 0===t&&(t=void 0),new Promise(function(o,r){var a=u.Utils.addUrlQueryValue(s.Constants.Urls.Authentication.userInformationUrl,s.Constants.Urls.QueryParams.clipperId,e),l={};l["Content-type"]="application/x-www-form-urlencoded";var p="";u.Utils.isNullOrUndefined(t)||(p=t.replace(/\+/g,"%2B")),i.Http.post(a,p,l).then(function(e){var t=e.response;o({parsedResponse:n.isValidUserInformationJsonString(t)?t:void 0,request:e})},function(e){r(e)})})},e.isValidUserInformationJsonString=function(e){var t;try{t=JSON.parse(e)}catch(e){return!1}return!!(t&&t.accessToken&&t.accessTokenExpiration>0&&t.authType)},e}();n.AuthenticationHelper=p},{"../communicator/smartValue":5,"../constants":6,"../http/http":23,"../logging/log":26,"../storage/clipperStorageKeys":46,"../userInfo":48,"../utils":49}],10:[function(e,t,n){"use strict";var o=e("../../clientType"),r=e("../webExtensionBase/webExtension");r.WebExtension.browser=chrome;new r.WebExtension(o.ClientType.ChromeExtension,{debugLoggingInjectUrl:"chromeDebugLoggingInject.js",webClipperInjectUrl:"chromeInject.js",pageNavInjectUrl:"chromePageNavInject.js"})},{"../../clientType":1,"../webExtensionBase/webExtension":17}],11:[function(e,t,n){"use strict";var o=e("../clientType"),r=e("../constants"),i=e("../experiments"),a=e("../utils"),s=e("../clipperUI/tooltipType"),l=e("../communicator/smartValue"),u=e("../http/http"),p=e("../localization/localization"),c=e("../localization/localizationHelper"),g=e("../logging/log"),d=e("../storage/clipperStorageKeys"),f=e("../versioning/changeLog"),h=e("../versioning/changeLogHelper"),m=e("../versioning/version"),v=e("./authenticationHelper"),y=e("./tooltipHelper"),C=e("./workerPassthroughLogger"),b=function(){function e(t,n){this.setUnhandledExceptionLogging(),this.workers=[],this.logger=new C.WorkerPassthroughLogger(this.workers),this.clipperData=n,this.clipperData.setLogger(this.logger),this.auth=new v.AuthenticationHelper(this.clipperData,this.logger),this.tooltip=new y.TooltipHelper(this.clipperData);var o=!1,r=this.clipperData.getValue(d.ClipperStorageKeys.clipperId);r||(o=!0,r=e.generateClipperId(),this.clipperData.setValue(d.ClipperStorageKeys.clipperId,r),this.updateLastSeenVersionInStorageToCurrent()),this.clientInfo=new l.SmartValue({clipperType:t,clipperVersion:e.getExtensionVersion(),clipperId:r}),o&&this.onFirstRun(),this.initializeUserFlighting(),this.listenForOpportunityToShowPageNavTooltip()}return e.getExtensionVersion=function(){return e.version},e.shouldCheckForMajorUpdates=function(e,t){return!!t&&(!e||e.isLesserThan(t))},e.prototype.addWorker=function(e){var t=this;e.setOnUnloading(function(){e.destroy(),t.removeWorker(e)}),this.workers.push(e)},e.prototype.getWorkers=function(){return this.workers},e.prototype.removeWorker=function(e){var t=this.workers.indexOf(e);t>-1&&this.workers.splice(t,1)},e.isOnOneNoteDomain=function(e){return e.indexOf("onenote.com")>=0||e.indexOf("onenote-int.com")>=0},e.prototype.fetchAndStoreLocStrings=function(){var e=this,t=navigator.language||navigator.userLanguage;return new Promise(function(n,o){c.LocalizationHelper.makeLocStringsFetchRequest(t).then(function(r){try{var i=JSON.parse(r.parsedResponse);i&&(e.clipperData.setValue(d.ClipperStorageKeys.locale,t),e.clipperData.setValue(d.ClipperStorageKeys.locStrings,r.parsedResponse),p.Localization.setLocalizedStrings(i)),n(i)}catch(e){o()}},function(e){o()})})},e.prototype.getClipperInstalledPageUrl=function(t,n,i){var s=r.Constants.Urls.clipperInstallPageUrl;return s=a.Utils.addUrlQueryValue(s,r.Constants.Urls.QueryParams.clientType,o.ClientType[n]),s=a.Utils.addUrlQueryValue(s,r.Constants.Urls.QueryParams.clipperId,t),s=a.Utils.addUrlQueryValue(s,r.Constants.Urls.QueryParams.clipperVersion,e.getExtensionVersion()),s=a.Utils.addUrlQueryValue(s,r.Constants.Urls.QueryParams.inlineInstall,i.toString()),this.logger.logTrace(g.Trace.Label.RequestForClipperInstalledPageUrl,g.Trace.Level.Information,s),s},e.prototype.getExistingWorkerForTab=function(e){for(var t=this.getWorkers(),n=0,o=t;n<o.length;n++){var r=o[n];if(r.getUniqueId()===e)return r}},e.prototype.getFlightingAssignments=function(e){var t=this,n=function(){return new Promise(function(t,n){var o=a.Utils.addUrlQueryValue(r.Constants.Urls.userFlightingEndpoint,r.Constants.Urls.QueryParams.clipperId,e);u.Http.get(o).then(function(e){t({request:e,parsedResponse:e.responseText})},function(e){n(e)})})};return new Promise(function(e,o){t.clipperData.getFreshValue(d.ClipperStorageKeys.flightingInfo,n,i.Experiments.updateIntervalForFlights).then(function(t){var n=t.data.Features?t.data.Features:[];e(n)},function(e){o(e)})})},e.prototype.getLastSeenVersion=function(){var e=this.clipperData.getValue(d.ClipperStorageKeys.lastSeenVersion);return e?new m.Version(e):void 0},e.prototype.getNewUpdates=function(e,t){var n=this;return new Promise(function(o,i){var s=n.clipperData.getValue(d.ClipperStorageKeys.displayLanguageOverride),l=s||navigator.language||navigator.userLanguage,p=a.Utils.addUrlQueryValue(r.Constants.Urls.changelogUrl,r.Constants.Urls.QueryParams.changelogLocale,l);u.Http.get(p).then(function(n){try{for(var r=JSON.parse(n.responseText),a=void 0,s=0;s<r.length;s++)if(r[s].schemaVersion===f.ChangeLog.schemaVersionSupported){a=r[s].updates;break}if(!a)throw new Error("No matching schemas were found.");var l=h.ChangeLogHelper.getUpdatesBetweenVersions(a,e,t);o(l)}catch(e){i(e)}},function(e){i(e)})})},e.prototype.getOrCreateWorkerForTab=function(e,t){var n=t(e),o=this.getExistingWorkerForTab(n);return o||(o=this.createWorker(e),this.addWorker(o)),o},e.generateClipperId=function(){var e="ON";return e+"-"+a.Utils.generateGuid()},e.prototype.initializeUserFlighting=function(){var e=this,t=new g.Event.PromiseEvent(g.Event.Label.GetFlightingAssignments);this.getFlightingAssignments(this.clientInfo.get().clipperId).then(function(t){e.updateClientInfoWithFlightInformation(t)},function(n){e.updateClientInfoWithFlightInformation([]),t.setStatus(g.Status.Failed),t.setFailureInfo(n)}).then(function(){e.logger.logEvent(t)})},e.prototype.shouldShowTooltip=function(e,t){var n=this.checkIfTabMatchesATooltipType(e,t);if(n&&this.tooltip.tooltipDelayIsOver(n,Date.now()))return n},e.prototype.shouldShowVideoTooltip=function(e){return!(!this.checkIfTabIsAVideoDomain(e)||!this.tooltip.tooltipDelayIsOver(s.TooltipType.Video,Date.now()))},e.prototype.showTooltip=function(e,t){var n=this,o=this.getOrCreateWorkerForTab(e,this.getIdFromTab),r=new g.Event.BaseEvent(g.Event.Label.TooltipImpression);r.setCustomProperty(g.PropertyName.Custom.TooltipType,s.TooltipType[t]),r.setCustomProperty(g.PropertyName.Custom.LastSeenTooltipTime,this.tooltip.getTooltipInformation(d.ClipperStorageKeys.lastSeenTooltipTimeBase,t)),r.setCustomProperty(g.PropertyName.Custom.NumTimesTooltipHasBeenSeen,this.tooltip.getTooltipInformation(d.ClipperStorageKeys.numTimesTooltipHasBeenSeenBase,t)),o.invokeTooltip(t).then(function(e){if(e){n.tooltip.setTooltipInformation(d.ClipperStorageKeys.lastSeenTooltipTimeBase,t,Date.now().toString());var i=d.ClipperStorageKeys.numTimesTooltipHasBeenSeenBase,a=n.tooltip.getTooltipInformation(i,t)+1;n.tooltip.setTooltipInformation(d.ClipperStorageKeys.numTimesTooltipHasBeenSeenBase,t,a.toString())}r.setCustomProperty(g.PropertyName.Custom.FeatureEnabled,e),o.getLogger().logEvent(r)})},e.prototype.shouldShowWhatsNewTooltip=function(t,n,o){return this.checkIfTabIsOnWhitelistedUrl(t)&&e.shouldCheckForMajorUpdates(n,o)},e.prototype.showWhatsNewTooltip=function(e,t,n){var r=this;this.getNewUpdates(t,n).then(function(t){var n=h.ChangeLogHelper.filterUpdatesThatDontApplyToBrowser(t,o.ClientType[r.clientInfo.get().clipperType]);if(n&&n.length>0){var i=r.getOrCreateWorkerForTab(e,r.getIdFromTab);i.invokeWhatsNewTooltip(n).then(function(e){if(e){var t=new g.Event.BaseEvent(g.Event.Label.WhatsNewImpression);t.setCustomProperty(g.PropertyName.Custom.FeatureEnabled,e),i.getLogger().logEvent(t),r.updateLastSeenVersionInStorageToCurrent()}})}else r.updateLastSeenVersionInStorageToCurrent()},function(e){g.ErrorUtils.sendFailureLogRequest({label:g.Failure.Label.GetChangeLog,properties:{failureType:g.Failure.Type.Unexpected,failureInfo:{error:e},failureId:"GetChangeLog",stackTrace:e},clientInfo:r.clientInfo})})},e.prototype.listenForOpportunityToShowPageNavTooltip=function(){var t=this;this.addPageNavListener(function(n){var o;try{o=t.getLastSeenVersion()}catch(e){return void t.updateLastSeenVersionInStorageToCurrent()}var r=new m.Version(e.getExtensionVersion()),i=[s.TooltipType.Pdf,s.TooltipType.Product,s.TooltipType.Recipe],a=t.shouldShowTooltip(n,i);return a?void t.showTooltip(n,a):t.shouldShowVideoTooltip(n)?void t.showTooltip(n,s.TooltipType.Video):t.shouldShowWhatsNewTooltip(n,o,r)?void t.showWhatsNewTooltip(n,o,r):void 0})},e.prototype.setUnhandledExceptionLogging=function(){var e=this,t=window.onerror;window.onerror=function(n,o,r,i,a){var s=a?g.Failure.getStackTrace(a):"[unknown stacktrace]";g.ErrorUtils.sendFailureLogRequest({label:g.Failure.Label.UnhandledExceptionThrown,properties:{failureType:g.Failure.Type.Unexpected,failureInfo:{error:JSON.stringify({error:a.toString(),message:n,lineno:r,colno:i})},failureId:"ExtensionBase",stackTrace:s},clientInfo:e.clientInfo}),t&&t(n,o,r,i,a)}},e.prototype.updateClientInfoWithFlightInformation=function(e){this.clientInfo.set({clipperType:this.clientInfo.get().clipperType,clipperVersion:this.clientInfo.get().clipperVersion,clipperId:this.clientInfo.get().clipperId,flightingInfo:e})},e.prototype.updateLastSeenVersionInStorageToCurrent=function(){this.clipperData.setValue(d.ClipperStorageKeys.lastSeenVersion,e.getExtensionVersion())},e.version="3.2.8",e}();n.ExtensionBase=b},{"../clientType":1,"../clipperUI/tooltipType":2,"../communicator/smartValue":5,"../constants":6,"../experiments":8,"../http/http":23,"../localization/localization":24,"../localization/localizationHelper":25,"../logging/log":26,"../storage/clipperStorageKeys":46,"../utils":49,"../versioning/changeLog":50,"../versioning/changeLogHelper":51,"../versioning/version":52,"./authenticationHelper":9,"./tooltipHelper":16,"./workerPassthroughLogger":20}],12:[function(e,t,n){"use strict";var o=e("../clientType"),r=e("../constants"),i=e("../polyfills"),a=e("../userInfo"),s=e("../settings"),l=e("../utils"),u=e("../clipperUI/tooltipType"),p=e("../communicator/communicator"),c=e("../communicator/smartValue"),g=e("../http/clipperCachedHttp"),d=e("../localization/localizationHelper"),f=e("../logging/log"),h=e("../logging/logHelpers"),m=e("../storage/clipperStorageKeys"),v=e("./invokeSource"),y=e("./invokeOptions"),C=function(){function e(e,t,n,o,a){this.clipperFunnelAlreadyLogged=!1,i.Polyfills.init(),this.onUnloading=function(){},this.uiCommunicator=new p.Communicator(o(),r.Constants.CommunicationChannels.extensionAndUi),this.pageNavUiCommunicator=new p.Communicator(o(),r.Constants.CommunicationChannels.extensionAndPageNavUi),this.debugLoggingInjectCommunicator=new p.Communicator(a(),r.Constants.CommunicationChannels.debugLoggingInjectedAndExtension),this.injectCommunicator=new p.Communicator(a(),r.Constants.CommunicationChannels.injectedAndExtension),this.pageNavInjectCommunicator=new p.Communicator(a(),r.Constants.CommunicationChannels.pageNavInjectedAndExtension),this.sessionId=new c.SmartValue,this.logger=LogManager.createExtLogger(this.sessionId,h.LogHelpers.isConsoleOutputEnabled()?this.debugLoggingInjectCommunicator:void 0),this.logger.logSessionStart(),this.clipperData=n,this.clipperData.setLogger(this.logger),this.auth=t,this.clientInfo=e,this.logDeviceIdMapEvent(),this.initializeCommunicators(),this.initializeContextProperties()}return e.prototype.initializeContextProperties=function(){var e=this,t=this.clientInfo.get();if(this.logger.setContextProperty(f.Context.Custom.AppInfoId,s.Settings.getSetting("App_Id")),this.logger.setContextProperty(f.Context.Custom.UserInfoId,void 0),this.logger.setContextProperty(f.Context.Custom.AuthType,"None"),this.logger.setContextProperty(f.Context.Custom.AppInfoVersion,t.clipperVersion),
this.logger.setContextProperty(f.Context.Custom.DeviceInfoId,t.clipperId),this.logger.setContextProperty(f.Context.Custom.ClipperType,o.ClientType[t.clipperType]),t.flightingInfo)this.logger.setContextProperty(f.Context.Custom.FlightInfo,t.flightingInfo.join(","));else{var n=function(t){t.flightingInfo&&(e.clientInfo.unsubscribe(n),e.logger.setContextProperty(f.Context.Custom.FlightInfo,t.flightingInfo.join(",")))}.bind(this);this.clientInfo.subscribe(n,{callOnSubscribe:!1})}},e.prototype.getUniqueId=function(){return this.tabId},e.prototype.closeAllFramesAndInvokeClipper=function(e,t){this.pageNavInjectCommunicator.callRemoteFunction(r.Constants.FunctionKeys.closePageNavTooltip),this.invokeClipper(e,t)},e.prototype.getLogger=function(){return this.logger},e.prototype.invokeClipper=function(e,t){var n=this,o={invokeDataForMode:t?t.invokeDataForMode:void 0,invokeMode:t?t.invokeMode:y.InvokeMode.Default};this.sendInvokeOptionsToInject(o),this.invokeClipperBrowserSpecific().then(function(t){t&&!n.clipperFunnelAlreadyLogged&&(n.logger.logUserFunnel(f.Funnel.Label.Invoke),n.clipperFunnelAlreadyLogged=!0),n.logClipperInvoke(e,o)})},e.prototype.invokeWhatsNewTooltip=function(e){var t=this;return new Promise(function(n){var o=new f.Event.PromiseEvent(f.Event.Label.InvokeWhatsNew);t.registerLocalizedStringsForPageNav().then(function(r){r?(t.registerWhatsNewCommunicatorFunctions(e),t.invokeWhatsNewTooltipBrowserSpecific(e).then(function(e){e||(o.setStatus(f.Status.Failed),o.setFailureInfo({error:"invoking the What's New experience failed"})),t.logger.logEvent(o),n(e)})):(o.setStatus(f.Status.Failed),o.setFailureInfo({error:"getLocalizedStringsForBrowser returned undefined/null"}),t.logger.logEvent(o),n(!1))})})},e.prototype.invokeTooltip=function(e){var t=this;return new Promise(function(n){var o=new f.Event.PromiseEvent(f.Event.Label.InvokeTooltip);o.setCustomProperty(f.PropertyName.Custom.TooltipType,u.TooltipType[e]),t.registerLocalizedStringsForPageNav().then(function(r){r?(t.registerTooltipCommunicatorFunctions(e),t.invokeTooltipBrowserSpecific(e).then(function(e){t.logger.logEvent(o),n(e)})):(o.setStatus(f.Status.Failed),o.setFailureInfo({error:"getLocalizedStringsForBrowser returned undefined/null"}),t.logger.logEvent(o),n(!1))})})},e.prototype.setOnUnloading=function(e){this.onUnloading=e},e.prototype.destroy=function(){this.logger.logSessionEnd(f.Session.EndTrigger.Unload)},e.prototype.getLocalizedStrings=function(e,t){var n=this;this.logger.setContextProperty(f.Context.Custom.BrowserLanguage,e);var o=this.clipperData.getValue(m.ClipperStorageKeys.locale),r=!o||o!==e,i=new f.Event.BaseEvent(f.Event.Label.GetLocale);i.setCustomProperty(f.PropertyName.Custom.StoredLocaleDifferentThanRequested,r),this.logger.logEvent(i);var a=function(){return d.LocalizationHelper.makeLocStringsFetchRequest(e)},s=r?0:g.ClipperCachedHttp.getDefaultExpiry(),l=new f.Event.PromiseEvent(f.Event.Label.GetLocalizedStrings);l.setCustomProperty(f.PropertyName.Custom.ForceRetrieveFreshLocStrings,r),this.clipperData.getFreshValue(m.ClipperStorageKeys.locStrings,a,s).then(function(o){n.clipperData.setValue(m.ClipperStorageKeys.locale,e),t&&t(o?o.data:void 0)},function(e){l.setStatus(f.Status.Failed),l.setFailureInfo(e),t&&t(void 0)}).then(function(){n.logger.logEvent(l)})},e.prototype.getLocalizedStringsForBrowser=function(e){var t=this.clipperData.getValue(m.ClipperStorageKeys.displayLanguageOverride),n=t||navigator.language||navigator.userLanguage;this.getLocalizedStrings(n,e)},e.prototype.getUserSessionIdQueryParamValue=function(){var e=this.logger.getUserSessionId();return e?e:this.clientInfo.get().clipperId},e.prototype.invokeDebugLoggingIfEnabled=function(){return h.LogHelpers.isConsoleOutputEnabled()?this.invokeDebugLoggingBrowserSpecific():Promise.resolve(!1)},e.prototype.launchPopupAndWaitForClose=function(e){var t=this;return new Promise(function(n,o){var i,a=l.Utils.openPopupWindow(e),s=function(e){if(e.source===a){var n=void 0;try{n=JSON.parse(e.data)}catch(n){t.logger.logJsonParseUnexpected(e.data)}n&&(n[r.Constants.Urls.QueryParams.error]||n[r.Constants.Urls.QueryParams.errorDescription])&&(i={correlationId:n[r.Constants.Urls.QueryParams.correlationId],error:n[r.Constants.Urls.QueryParams.error],errorDescription:n[r.Constants.Urls.QueryParams.errorDescription]})}};window.addEventListener("message",s);var u=setInterval(function(){a&&!a.closed||(clearInterval(u),window.removeEventListener("message",s),i?o(i):n(!0))},100)})},e.prototype.logClipperInvoke=function(e,t){var n=new f.Event.BaseEvent(f.Event.Label.InvokeClipper);n.setCustomProperty(f.PropertyName.Custom.InvokeSource,v.InvokeSource[e.invokeSource]),n.setCustomProperty(f.PropertyName.Custom.InvokeMode,y.InvokeMode[t.invokeMode]),this.logger.logEvent(n)},e.prototype.registerTooltipToRenderInPageNav=function(e,t){this.pageNavUiCommunicator.registerFunction(r.Constants.FunctionKeys.getTooltipToRenderInPageNav,function(){return Promise.resolve(e)}),this.pageNavUiCommunicator.registerFunction(r.Constants.FunctionKeys.getPageNavTooltipProps,function(){return Promise.resolve(t)})},e.prototype.registerWhatsNewCommunicatorFunctions=function(e){this.registerTooltipToRenderInPageNav(u.TooltipType.WhatsNew,{updates:e})},e.prototype.registerTooltipCommunicatorFunctions=function(e){this.registerTooltipToRenderInPageNav(e)},e.prototype.sendInvokeOptionsToInject=function(e){this.injectCommunicator.callRemoteFunction(r.Constants.FunctionKeys.setInvokeOptions,{param:e})},e.prototype.setUpNoOpTrackers=function(e){var t=f.ErrorUtils.setNoOpTrackerRequestTimeout({label:f.NoOp.Label.InitializeCommunicator,channel:r.Constants.CommunicationChannels.injectedAndExtension,clientInfo:this.clientInfo,url:e},!0);this.injectCommunicator.callRemoteFunction(r.Constants.FunctionKeys.noOpTracker,{param:(new Date).getTime(),callback:function(){clearTimeout(t)}});var n=f.ErrorUtils.setNoOpTrackerRequestTimeout({label:f.NoOp.Label.InitializeCommunicator,channel:r.Constants.CommunicationChannels.extensionAndUi,clientInfo:this.clientInfo,url:e},!0);this.uiCommunicator.callRemoteFunction(r.Constants.FunctionKeys.noOpTracker,{param:(new Date).getTime(),callback:function(){clearTimeout(n)}})},e.prototype.doSignOutActionInFrontEnd=function(e){var t=this.getUserSessionIdQueryParamValue(),n=l.Utils.generateSignOutUrl(this.clientInfo.get().clipperId,t,a.AuthType[e]);this.uiCommunicator.callRemoteFunction(r.Constants.FunctionKeys.createHiddenIFrame,{param:n})},e.prototype.initializeCommunicators=function(){this.initializeDebugLoggingCommunicators(),this.initializeClipperCommunicators(),this.initializePageNavCommunicators()},e.prototype.initializeClipperCommunicators=function(){this.initializeClipperUiCommunicator(),this.initializeClipperInjectCommunicator()},e.prototype.initializeClipperUiCommunicator=function(){var e=this;this.uiCommunicator.broadcastAcrossCommunicator(this.auth.user,r.Constants.SmartValueKeys.user),this.uiCommunicator.broadcastAcrossCommunicator(this.clientInfo,r.Constants.SmartValueKeys.clientInfo),this.uiCommunicator.broadcastAcrossCommunicator(this.sessionId,r.Constants.SmartValueKeys.sessionId),this.uiCommunicator.registerFunction(r.Constants.FunctionKeys.clipperStrings,function(){return new Promise(function(t){e.getLocalizedStringsForBrowser(function(e){t(e)})})}),this.uiCommunicator.registerFunction(r.Constants.FunctionKeys.getStorageValue,function(t){return new Promise(function(n){var o=e.clipperData.getValue(t);n(o)})}),this.uiCommunicator.registerFunction(r.Constants.FunctionKeys.getMultipleStorageValues,function(t){return new Promise(function(n){for(var o={},r=0,i=t;r<i.length;r++){var a=i[r];o[a]=e.clipperData.getValue(a)}n(o)})}),this.uiCommunicator.registerFunction(r.Constants.FunctionKeys.setStorageValue,function(t){e.clipperData.setValue(t.key,t.value)}),this.uiCommunicator.registerFunction(r.Constants.FunctionKeys.getInitialUser,function(){return e.auth.updateUserInfoData(e.clientInfo.get().clipperId,a.UpdateReason.InitialRetrieval)}),this.uiCommunicator.registerFunction(r.Constants.FunctionKeys.signInUser,function(t){return new Promise(function(n,o){e.doSignInAction(t).then(function(t){if(t)e.auth.updateUserInfoData(e.clientInfo.get().clipperId,a.UpdateReason.SignInAttempt).then(function(e){n(e)});else{var o={updateReason:a.UpdateReason.SignInCancel};e.auth.user.set(o),n(o)}},function(t){e.auth.user.set({updateReason:a.UpdateReason.SignInAttempt}),o(t)})})}),this.uiCommunicator.registerFunction(r.Constants.FunctionKeys.signOutUser,function(t){e.clientInfo.get().clipperType===o.ClientType.EdgeExtension?e.doSignOutActionInFrontEnd(t):e.doSignOutAction(t),e.auth.user.set({updateReason:a.UpdateReason.SignOutAction}),e.clipperData.setValue(m.ClipperStorageKeys.userInformation,void 0),e.clipperData.setValue(m.ClipperStorageKeys.currentSelectedSection,void 0),e.clipperData.setValue(m.ClipperStorageKeys.cachedNotebooks,void 0)}),this.uiCommunicator.registerFunction(r.Constants.FunctionKeys.telemetry,function(t){f.parseAndLogDataPackage(t,e.logger)}),this.uiCommunicator.registerFunction(r.Constants.FunctionKeys.ensureFreshUserBeforeClip,function(){return e.auth.updateUserInfoData(e.clientInfo.get().clipperId,a.UpdateReason.TokenRefreshForPendingClip)}),this.uiCommunicator.registerFunction(r.Constants.FunctionKeys.takeTabScreenshot,function(){return e.takeTabScreenshot()}),this.uiCommunicator.setErrorHandler(function(t){f.ErrorUtils.handleCommunicatorError(r.Constants.CommunicationChannels.extensionAndUi,t,e.clientInfo)})},e.prototype.initializeClipperInjectCommunicator=function(){var e=this;this.injectCommunicator.broadcastAcrossCommunicator(this.clientInfo,r.Constants.SmartValueKeys.clientInfo),this.injectCommunicator.registerFunction(r.Constants.FunctionKeys.unloadHandler,function(){e.tearDownCommunicators(),e.onUnloading()}),this.injectCommunicator.registerFunction(r.Constants.FunctionKeys.setStorageValue,function(t){e.clipperData.setValue(t.key,t.value)}),this.injectCommunicator.setErrorHandler(function(t){f.ErrorUtils.handleCommunicatorError(r.Constants.CommunicationChannels.injectedAndExtension,t,e.clientInfo)})},e.prototype.initializeDebugLoggingCommunicators=function(){var e=this;this.debugLoggingInjectCommunicator.registerFunction(r.Constants.FunctionKeys.unloadHandler,function(){e.tearDownCommunicators(),e.onUnloading()})},e.prototype.initializePageNavCommunicators=function(){this.initializePageNavUiCommunicator(),this.initializePageNavInjectCommunicator()},e.prototype.initializePageNavUiCommunicator=function(){var e=this;this.pageNavUiCommunicator.registerFunction(r.Constants.FunctionKeys.telemetry,function(t){f.parseAndLogDataPackage(t,e.logger)}),this.pageNavUiCommunicator.registerFunction(r.Constants.FunctionKeys.invokeClipperFromPageNav,function(t){e.closeAllFramesAndInvokeClipper({invokeSource:t},{invokeMode:y.InvokeMode.Default})})},e.prototype.initializePageNavInjectCommunicator=function(){var e=this;this.pageNavInjectCommunicator.registerFunction(r.Constants.FunctionKeys.telemetry,function(t){f.parseAndLogDataPackage(t,e.logger)}),this.pageNavInjectCommunicator.registerFunction(r.Constants.FunctionKeys.unloadHandler,function(){e.tearDownCommunicators(),e.onUnloading()})},e.prototype.registerLocalizedStringsForPageNav=function(){var e=this;return new Promise(function(t){e.getLocalizedStringsForBrowser(function(n){n&&e.pageNavUiCommunicator.registerFunction(r.Constants.FunctionKeys.clipperStringsFrontLoaded,function(){return Promise.resolve(n)}),t(!!n)})})},e.prototype.tearDownCommunicators=function(){this.uiCommunicator.tearDown(),this.pageNavUiCommunicator.tearDown(),this.injectCommunicator.tearDown(),this.pageNavInjectCommunicator.tearDown()},e.prototype.logDeviceIdMapEvent=function(){var e=this.clientInfo.get().clipperId,t=l.Utils.readCookie("MicrosoftApplicationsTelemetryDeviceId");if(t!==e){var n=new f.Event.BaseEvent(f.Event.Label.DeviceIdMap);n.setCustomProperty(f.PropertyName.Custom.DeviceIdInStorage,e),n.setCustomProperty(f.PropertyName.Custom.DeviceIdInCookie,t),this.logger.logEvent(n)}},e}();n.ExtensionWorkerBase=C},{"../clientType":1,"../clipperUI/tooltipType":2,"../communicator/communicator":3,"../communicator/smartValue":5,"../constants":6,"../http/clipperCachedHttp":22,"../localization/localizationHelper":25,"../logging/log":26,"../logging/logHelpers":27,"../polyfills":41,"../settings":42,"../storage/clipperStorageKeys":46,"../userInfo":48,"../utils":49,"./invokeOptions":14,"./invokeSource":15}],13:[function(e,t,n){"use strict";var o=e("../localization/localization"),r=function(){function e(){}return e.alertUserOfUnclippablePage=function(){alert(o.Localization.getLocalizedString("WebClipper.Error.CannotClipPage"))},e.isKnownUninjectablePage=function(t){if(!t)return!1;for(var n=0;n<e.isKnownUninjectablePage.length;n++)if(e.uninjectableUrlRegexes[n].test(t))return!0;return!1},e.uninjectableUrlRegexes=[/^about:/],e}();n.InjectHelper=r},{"../localization/localization":24}],14:[function(e,t,n){"use strict";!function(e){e[e.ContextImage=0]="ContextImage",e[e.ContextTextSelection=1]="ContextTextSelection",e[e.Default=2]="Default"}(n.InvokeMode||(n.InvokeMode={}));n.InvokeMode},{}],15:[function(e,t,n){"use strict";!function(e){e[e.Bookmarklet=0]="Bookmarklet",e[e.ContextMenu=1]="ContextMenu",e[e.ExtensionButton=2]="ExtensionButton",e[e.WhatsNewTooltip=3]="WhatsNewTooltip",e[e.PdfTooltip=4]="PdfTooltip",e[e.ProductTooltip=5]="ProductTooltip",e[e.RecipeTooltip=6]="RecipeTooltip",e[e.VideoTooltip=7]="VideoTooltip"}(n.InvokeSource||(n.InvokeSource={}));n.InvokeSource},{}],16:[function(e,t,n){"use strict";var o=e("../constants"),r=e("../utils"),i=e("../clipperUI/tooltipType"),a=e("../storage/clipperStorageKeys"),s=function(){function e(e){this.storage=e,this.validTypes=[i.TooltipType.Pdf,i.TooltipType.Product,i.TooltipType.Recipe,i.TooltipType.Video]}return e.prototype.getTooltipInformation=function(t,n){if(r.Utils.isNullOrUndefined(t)||r.Utils.isNullOrUndefined(n))throw new Error("Invalid argument passed to getTooltipInformation");var o=e.getStorageKeyForTooltip(t,n),i=this.storage.getValue(o),a=parseInt(i,10);return isNaN(a)?0:a},e.prototype.setTooltipInformation=function(t,n,o){if(r.Utils.isNullOrUndefined(t)||r.Utils.isNullOrUndefined(n))throw new Error("Invalid argument passed to setTooltipInformation");var i=e.getStorageKeyForTooltip(t,n);this.storage.setValue(i,o)},e.prototype.tooltipDelayIsOver=function(e,t){if(r.Utils.isNullOrUndefined(e)||r.Utils.isNullOrUndefined(t))throw new Error("Invalid argument passed to tooltipDelayIsOver");var n=this.getTooltipInformation(a.ClipperStorageKeys.lastClippedTooltipTimeBase,e);if(0!==n)return!1;var i=this.getTooltipInformation(a.ClipperStorageKeys.numTimesTooltipHasBeenSeenBase,e);if(i>=o.Constants.Settings.maximumNumberOfTimesToShowTooltips)return!1;this.getTooltipInformation(a.ClipperStorageKeys.lastSeenTooltipTimeBase,e);if(this.tooltipHasBeenSeenInLastTimePeriod(e,t,o.Constants.Settings.timeBetweenSameTooltip))return!1;var s=this.validTypes.indexOf(e),l=this.validTypes.slice();return l.splice(s,1),!this.hasAnyTooltipBeenSeenInLastTimePeriod(t,l,o.Constants.Settings.timeBetweenDifferentTooltips)},e.getStorageKeyForTooltip=function(e,t){if(r.Utils.isNullOrUndefined(e)||r.Utils.isNullOrUndefined(t))throw new Error("Invalid argument passed to getStorageKeyForTooltip");return e+i.TooltipType[t]},e.prototype.tooltipHasBeenSeenInLastTimePeriod=function(e,t,n){var o=this.getTooltipInformation(a.ClipperStorageKeys.lastSeenTooltipTimeBase,e);return 0!==o&&t-o<n},e.prototype.hasAnyTooltipBeenSeenInLastTimePeriod=function(e,t,n){var o=this;return t.some(function(t){var r=o.tooltipHasBeenSeenInLastTimePeriod(t,e,n);return r})},e}();n.TooltipHelper=s},{"../clipperUI/tooltipType":2,"../constants":6,"../storage/clipperStorageKeys":46,"../utils":49}],17:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("../../clientType"),i=e("../../utils"),a=e("../../domParsers/videoUtils"),s=e("../../localization/localization"),l=e("../../storage/clipperData"),u=e("../../storage/localStorage"),p=e("../extensionBase"),c=e("../invokeSource"),g=e("../invokeOptions"),d=e("./webExtensionWorker"),f=function(e){function t(t,n){e.call(this,t,new l.ClipperData(new u.LocalStorage)),this.injectUrls=n,this.registerBrowserButton(),this.registerContextMenuItems(),this.registerInstallListener(),this.registerTabRemoveListener()}return o(t,e),t.getExtensionVersion=function(){return t.browser.runtime.getManifest().version},t.prototype.addPageNavListener=function(e){t.browser.webNavigation.onCompleted.addListener(function(n){0===n.frameId&&t.browser.tabs.get(n.tabId,function(n){!t.browser.runtime.lastError&&n&&e(n)})})},t.prototype.checkIfTabIsOnWhitelistedUrl=function(e){return i.Utils.onWhitelistedDomain(e.url)},t.prototype.createWorker=function(e){return new d.WebExtensionWorker(this.injectUrls,e,this.clientInfo,this.auth)},t.prototype.getIdFromTab=function(e){return e.id},t.prototype.onFirstRun=function(){this.onInstalledSupported()||this.onInstalled()},t.prototype.checkIfTabMatchesATooltipType=function(e,t){return i.Utils.checkIfUrlMatchesAContentType(e.url,t)},t.prototype.checkIfTabIsAVideoDomain=function(e){var t=a.VideoUtils.videoDomainIfSupported(e.url);return!!t},t.prototype.invokeClipperInTab=function(e,t,n){var o=this.getOrCreateWorkerForTab(e,this.getIdFromTab);o.closeAllFramesAndInvokeClipper(t,n)},t.prototype.onInstalled=function(){var e=this;t.browser.tabs.query({active:!0,lastFocusedWindow:!0},function(n){var o=p.ExtensionBase.isOnOneNoteDomain(n[0].url),r=e.getClipperInstalledPageUrl(e.clientInfo.get().clipperId,e.clientInfo.get().clipperType,o);o?t.browser.tabs.update(n[0].id,{url:r}):t.browser.tabs.create({url:r})})},t.prototype.registerBrowserButton=function(){var e=this;t.browser.browserAction.onClicked.addListener(function(t){e.invokeClipperInTab(t,{invokeSource:c.InvokeSource.ExtensionButton},{invokeMode:g.InvokeMode.Default})})},t.prototype.registerContextMenuItems=function(){var e=this;this.fetchAndStoreLocStrings().then(function(){t.browser.contextMenus.removeAll(function(){for(var n=[{title:s.Localization.getLocalizedString("WebClipper.Label.OneNoteWebClipper"),contexts:["page"],onclick:function(t,n){e.invokeClipperInTab(n,{invokeSource:c.InvokeSource.ContextMenu},{invokeMode:g.InvokeMode.Default})}},{title:s.Localization.getLocalizedString("WebClipper.Label.ClipSelectionToOneNote"),contexts:["selection"],onclick:function(t,n){e.invokeClipperInTab(n,{invokeSource:c.InvokeSource.ContextMenu},{invokeMode:g.InvokeMode.ContextTextSelection})}},{title:s.Localization.getLocalizedString("WebClipper.Label.ClipImageToOneNote"),contexts:["image"],onclick:function(t,n){e.invokeClipperInTab(n,{invokeSource:c.InvokeSource.ContextMenu},t.srcUrl?{invokeDataForMode:t.srcUrl,invokeMode:g.InvokeMode.ContextImage}:void 0)}}],o=e.clientInfo.get().clipperType===r.ClientType.FirefoxExtension,i=0;i<n.length;i++)o||(n[i].documentUrlPatterns=["http://*/*","https://*/*"]),t.browser.contextMenus.create(n[i])})})},t.prototype.registerInstallListener=function(){var e=this;this.onInstalledSupported()&&t.browser.runtime.onInstalled.addListener(function(t){"install"===t.reason&&e.onInstalled()})},t.prototype.registerTabRemoveListener=function(){var e=this;t.browser.tabs.onRemoved.addListener(function(t){var n=e.getExistingWorkerForTab(t);n&&e.removeWorker(n)})},t.prototype.onInstalledSupported=function(){return!!t.browser.runtime.onInstalled},t}(p.ExtensionBase);n.WebExtension=f},{"../../clientType":1,"../../domParsers/videoUtils":7,"../../localization/localization":24,"../../storage/clipperData":44,"../../storage/localStorage":47,"../../utils":49,"../extensionBase":11,"../invokeOptions":14,"../invokeSource":15,"./webExtensionWorker":19}],18:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("../../communicator/messageHandler"),i=e("./webExtension"),a=function(e){function t(t){e.call(this),this.tabId=t,this.initMessageHandler(),i.WebExtension.browser.runtime.onMessage.addListener(this.messageHandler)}return o(t,e),t.prototype.initMessageHandler=function(){var e=this;this.messageHandler=function(t,n){n.tab.id===e.tabId&&e.onMessageReceived(t)}},t.prototype.sendMessage=function(e){i.WebExtension.browser.tabs.sendMessage(this.tabId,e)},t.prototype.tearDown=function(){i.WebExtension.browser.runtime.onMessage.removeListener(this.messageHandler)},t}(r.MessageHandler);n.WebExtensionBackgroundMessageHandler=a;var s=function(e){function t(){e.call(this),this.initMessageHandler(),i.WebExtension.browser.runtime.onMessage.addListener(this.messageHandler)}return o(t,e),t.prototype.initMessageHandler=function(){var e=this;this.messageHandler=function(t){e.onMessageReceived(t)}},t.prototype.sendMessage=function(e){i.WebExtension.browser.runtime.sendMessage(e)},t.prototype.tearDown=function(){i.WebExtension.browser.runtime.onMessage.removeListener(this.messageHandler)},t}(r.MessageHandler);n.WebExtensionContentMessageHandler=s},{"../../communicator/messageHandler":4,"./webExtension":17}],19:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("../../userInfo"),i=e("../../clientType"),a=e("../../constants"),s=e("../../utils"),l=e("../../logging/log"),u=e("../../storage/clipperData"),p=e("../../storage/LocalStorage"),c=e("../extensionWorkerBase"),g=e("../injectHelper"),d=e("./webExtension"),f=e("./webExtensionMessageHandler"),h=function(e){function t(t,n,o,r){var i=function(){return new f.WebExtensionBackgroundMessageHandler(n.id)};e.call(this,o,r,new u.ClipperData(new p.LocalStorage),i,i),this.injectUrls=t,this.tab=n,this.tabId=n.id,this.noOpTrackerInvoked=!1;var a=!!n.incognito||!!n.inPrivate;this.logger.setContextProperty(l.Context.Custom.InPrivateBrowsing,a.toString()),this.invokeDebugLoggingIfEnabled()}return o(t,e),t.prototype.getUrl=function(){return this.tab.url},t.prototype.doSignInAction=function(e){var t=this.getUserSessionIdQueryParamValue(),n=s.Utils.generateSignInUrl(this.clientInfo.get().clipperId,t,r.AuthType[e]);return this.launchWebExtensionPopupAndWaitForClose(n,a.Constants.Urls.Authentication.authRedirectUrl)},t.prototype.doSignOutAction=function(e){var t=this.getUserSessionIdQueryParamValue(),n=s.Utils.generateSignOutUrl(this.clientInfo.get().clipperId,t,r.AuthType[e]);s.Utils.appendHiddenIframeToDocument(n)},t.prototype.invokeClipperBrowserSpecific=function(){var e=this;return new Promise(function(t){d.WebExtension.browser.tabs.executeScript(e.tab.id,{code:'var frameUrl = "'+d.WebExtension.browser.extension.getURL("clipper.html")+'";'},function(){d.WebExtension.browser.runtime.lastError?(l.ErrorUtils.sendFailureLogRequest({label:l.Failure.Label.UnclippablePage,properties:{failureType:l.Failure.Type.Expected,failureInfo:{error:JSON.stringify({error:d.WebExtension.browser.runtime.lastError.message,url:e.tab.url})},stackTrace:l.Failure.getStackTrace()},clientInfo:e.clientInfo}),e.clientInfo.get().clipperType!==i.ClientType.FirefoxExtension&&g.InjectHelper.alertUserOfUnclippablePage(),t(!1)):(d.WebExtension.browser.tabs.executeScript(e.tab.id,{file:e.injectUrls.webClipperInjectUrl}),e.noOpTrackerInvoked||(e.setUpNoOpTrackers(e.tab.url),e.noOpTrackerInvoked=!0),t(!0))})})},t.prototype.invokeDebugLoggingBrowserSpecific=function(){var e=this;return new Promise(function(t){d.WebExtension.browser.tabs.executeScript(e.tab.id,{file:e.injectUrls.debugLoggingInjectUrl},function(){t(d.WebExtension.browser.runtime.lastError?!1:!0)})})},t.prototype.invokePageNavBrowserSpecific=function(){var e=this;return new Promise(function(t){d.WebExtension.browser.tabs.executeScript(e.tab.id,{code:'var frameUrl = "'+d.WebExtension.browser.extension.getURL("pageNav.html")+'";'},function(){d.WebExtension.browser.runtime.lastError?t(!1):(d.WebExtension.browser.tabs.executeScript(e.tab.id,{file:e.injectUrls.pageNavInjectUrl}),t(!0))})})},t.prototype.invokeWhatsNewTooltipBrowserSpecific=function(e){return this.invokePageNavBrowserSpecific()},t.prototype.invokeTooltipBrowserSpecific=function(){return this.invokePageNavBrowserSpecific()},t.prototype.takeTabScreenshot=function(){return new Promise(function(e){d.WebExtension.browser.tabs.query({active:!0,lastFocusedWindow:!0},function(){d.WebExtension.browser.tabs.captureVisibleTab({format:"png"},function(t){e(t)})})})},t.prototype.launchWebExtensionPopupAndWaitForClose=function(e,t){var n=this;return new Promise(function(o,r){var u=1e3,p=700,c=screen&&screen.width?Math.round((screen.width-u)/2):0,g=screen&&screen.height?Math.round((screen.height-p)/2):0;try{var f={height:p,left:c,top:g,type:"popup",url:e,width:u};n.clientInfo.get().clipperType!==i.ClientType.FirefoxExtension&&(f.focused=!0),d.WebExtension.browser.windows.create(f,function(e){var n,i,l=!1,u=function(e){if(l=!0,e.responseHeaders)for(var t=0;t<e.responseHeaders.length;t++)if(e.responseHeaders[t].name===a.Constants.HeaderValues.correlationId){i=e.responseHeaders[t].value;break}var o=e.url,r=s.Utils.getQueryValue(o,a.Constants.Urls.QueryParams.error),p=s.Utils.getQueryValue(o,a.Constants.Urls.QueryParams.errorDescription);(r||p)&&(n={error:r,errorDescription:p,correlationId:i}),d.WebExtension.browser.webRequest.onCompleted.removeListener(u),d.WebExtension.browser.tabs.remove(e.tabId)};d.WebExtension.browser.webRequest.onCompleted.addListener(u,{windowId:e.id,urls:[t+"*"]},["responseHeaders"]);var p=function(t,i){i.windowId===e.id&&(n?r(n):o(l),d.WebExtension.browser.tabs.onRemoved.removeListener(p))};d.WebExtension.browser.tabs.onRemoved.addListener(p)})}catch(t){n.logger.logFailure(l.Failure.Label.WebExtensionWindowCreate,l.Failure.Type.Unexpected,{error:t.message}),n.launchPopupAndWaitForClose(e).then(function(e){o(!0)},function(e){r(e)})}})},t}(c.ExtensionWorkerBase);n.WebExtensionWorker=h},{"../../clientType":1,"../../constants":6,"../../logging/log":26,"../../storage/LocalStorage":43,"../../storage/clipperData":44,"../../userInfo":48,"../../utils":49,"../extensionWorkerBase":12,"../injectHelper":13,"./webExtension":17,"./webExtensionMessageHandler":18}],20:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("../logging/logger"),i=function(e){function t(t){e.call(this),this.workers=t}return o(t,e),t.prototype.logEvent=function(e){for(var t=0,n=this.workers;t<n.length;t++){var o=n[t];o.getLogger().logEvent(e)}},t.prototype.pushToStream=function(e,t){for(var n=0,o=this.workers;n<o.length;n++){var r=o[n];r.getLogger().pushToStream(e,t)}},t.prototype.logFailure=function(e,t,n,o){for(var r=0,i=this.workers;r<i.length;r++){var a=i[r];a.getLogger().logFailure(e,t,n,o)}},t.prototype.logUserFunnel=function(e){for(var t=0,n=this.workers;t<n.length;t++){var o=n[t];o.getLogger().logUserFunnel(e)}},t.prototype.logSessionStart=function(){for(var e=0,t=this.workers;e<t.length;e++){var n=t[e];n.getLogger().logSessionStart()}},t.prototype.logSessionEnd=function(e){for(var t=0,n=this.workers;t<n.length;t++){var o=n[t];o.getLogger().logSessionEnd(e)}},t.prototype.logTrace=function(e,t,n){for(var o=0,r=this.workers;o<r.length;o++){var i=r[o];i.getLogger().logTrace(e,t,n)}},t.prototype.logClickEvent=function(e){for(var t=0,n=this.workers;t<n.length;t++){var o=n[t];o.getLogger().logClickEvent(e)}},t.prototype.setContextProperty=function(e,t){for(var n=0,o=this.workers;n<o.length;n++){var r=o[n];r.getLogger().setContextProperty(e,t)}},t}(r.Logger);n.WorkerPassthroughLogger=i},{"../logging/logger":28}],21:[function(e,t,n){"use strict";var o=function(){function e(e){this.cache=e}return e.prototype.getFreshValue=function(t,n,o){var r=this;if(!t)throw new Error("key must be a non-empty string, but was: "+t);if(!n)throw new Error("getRemoteValue must be non-undefined");return o<0&&(o=0),new Promise(function(i,a){var s=r.cache.getValue(t),l=!!s;if(l){var u=void 0;try{u=JSON.parse(s)}catch(e){a({error:e})}var p=e.valueHasExpired(u,o);if(!p)return void i(u)}r.getAndCacheRemoteValue(t,n).then(function(e){i(e)},function(e){a(e)})})},e.prototype.getAndCacheRemoteValue=function(e,t){var n=this;if(!e)throw new Error("key must be a non-empty string, but was: "+e);if(!t)throw new Error("getRemoteValue must be non-undefined");return new Promise(function(o,r){t().then(function(t){var r=n.setTimeStampedValue(e,t.parsedResponse);r||n.cache.removeKey(e),o(r)},function(t){n.cache.removeKey(e),r(t)})})},e.valueHasExpired=function(e,t){var n=e&&e.lastUpdated?e.lastUpdated:0;return Date.now()-n>=t},e.prototype.setTimeStampedValue=function(e,t){if(!e)throw new Error("key must be a non-empty string, but was: "+e);if(t){var n;try{n=JSON.parse(t)}catch(e){return}var o={data:n,lastUpdated:Date.now()};return this.cache.setValue(e,JSON.stringify(o)),o}},e}();n.CachedHttp=o},{}],22:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("../constants"),i=e("../logging/log"),a=e("./cachedHttp"),s=function(e){function t(t,n){e.call(this,t),this.logger=n}return o(t,e),t.prototype.setLogger=function(e){this.logger=e},t.getDefaultExpiry=function(){return t.defaultExpiry},t.prototype.getFreshValue=function(n,o,r){if(void 0===r&&(r=t.defaultExpiry),!n)return this.logger.logFailure(i.Failure.Label.InvalidArgument,i.Failure.Type.Unexpected,{error:"getFreshValue key parameter should be passed a non-empty string"},""+n),Promise.resolve(void 0);if(!o)return this.logger.logFailure(i.Failure.Label.InvalidArgument,i.Failure.Type.Unexpected,{error:"getFreshValue getRemoteValue parameter should be passed a non-undefined function"},""+o),Promise.resolve(void 0);r<0&&(this.logger.logFailure(i.Failure.Label.InvalidArgument,i.Failure.Type.Unexpected,{error:"getFreshValue updateInterval parameter should be passed a number >= 0"},""+r),r=0);var a=this.addLoggingToGetResponseAsync(n,o,r);return e.prototype.getFreshValue.call(this,n,a,r)},t.prototype.addLoggingToGetResponseAsync=function(e,n,o){var r=this;return function(){var a=new i.Event.PromiseEvent(i.Event.Label.FetchNonLocalData);return a.setCustomProperty(i.PropertyName.Custom.Key,e),a.setCustomProperty(i.PropertyName.Custom.UpdateInterval,o),new Promise(function(e,o){n().then(function(n){n.request&&t.addCorrelationIdToLogEvent(a,n.request),e(n)},function(e){a.setStatus(i.Status.Failed),a.setFailureInfo(e),o(e)}).then(function(){r.logger.logEvent(a)})})}},t.addCorrelationIdToLogEvent=function(e,t){var n=t.getResponseHeader(r.Constants.HeaderValues.correlationId);n&&e.setCustomProperty(i.PropertyName.Custom.CorrelationId,n)},t.defaultExpiry=432e5,t}(a.CachedHttp);n.ClipperCachedHttp=s},{"../constants":6,"../logging/log":26,"./cachedHttp":21}],23:[function(e,t,n){"use strict";var o=e("../utils"),r=function(){function e(){}return e.get=function(t,n,o,r){return void 0===o&&(o=e.defaultTimeout),void 0===r&&(r=[200]),e.createAndSendRequest("GET",t,n,r,o)},e.post=function(t,n,r,i,a){if(void 0===i&&(i=[200]),void 0===a&&(a=e.defaultTimeout),o.Utils.isNullOrUndefined(n))throw new Error("data must be a non-undefined object, but was: "+n);return e.createAndSendRequest("POST",t,r,i,a,n)},e.createAndSendRequest=function(t,n,o,r,i,a){if(void 0===r&&(r=[200]),void 0===i&&(i=e.defaultTimeout),!n)throw new Error("url must be a non-empty string, but was: "+n);return new Promise(function(s,l){var u=new XMLHttpRequest;u.open(t,n),u.onload=function(){
r.indexOf(u.status)>-1?s(u):l(OneNoteApi.ErrorUtils.createRequestErrorObject(u,OneNoteApi.RequestErrorType.UNEXPECTED_RESPONSE_STATUS))},u.onerror=function(){l(OneNoteApi.ErrorUtils.createRequestErrorObject(u,OneNoteApi.RequestErrorType.NETWORK_ERROR))},u.ontimeout=function(){l(OneNoteApi.ErrorUtils.createRequestErrorObject(u,OneNoteApi.RequestErrorType.REQUEST_TIMED_OUT))},e.setHeaders(u,o),u.timeout=i,u.send(a)})},e.setHeaders=function(e,t){if(t)for(var n in t)e.setRequestHeader(n,t[n])},e.defaultTimeout=3e4,e}();n.Http=r},{"../utils":49}],24:[function(e,t,n){"use strict";var o;!function(t){function n(e){if(!e)throw new Error("stringId must be a non-empty string, but was: "+e);if(s){var t=s[e];if(t)return t}var n=p[e];if(n)return n;throw new Error("getLocalizedString could not find a localized or fallback string: "+e)}function o(e){s=e}function r(e){return"font-family: "+i(e)+";"}function i(e){if(u[e])return u[e];var t="WebClipper.FontFamily."+l[e].toString(),o=n(t);return u[e]=a(o),u[e]}function a(e){if(!e)return"";for(var t=e.split(","),n=0;n<t.length;n++)t[n]=t[n].trim(),t[n].length>0&&t[n].indexOf(" ")>=0&&"'"!==t[n][0]&&"'"!==t[n][t.length-1]&&(t[n]="'"+t[n]+"'");return t.join(",")}!function(e){e[e.Regular=0]="Regular",e[e.Bold=1]="Bold",e[e.Light=2]="Light",e[e.Semibold=3]="Semibold",e[e.Semilight=4]="Semilight"}(t.FontFamily||(t.FontFamily={}));var s,l=t.FontFamily,u={},p=e("../../strings.json");t.getLocalizedString=n,t.setLocalizedStrings=o,t.getFontFamilyAsStyle=r,t.getFontFamily=i,t.formatFontFamily=a}(o=n.Localization||(n.Localization={}))},{"../../strings.json":54}],25:[function(e,t,n){"use strict";var o=e("../constants"),r=e("../utils"),i=function(){function e(){}return e.makeLocStringsFetchRequest=function(e){var t=r.Utils.addUrlQueryValue(o.Constants.Urls.localizedStringsUrlBase,"locale",e);return new Promise(function(e,n){var o=new XMLHttpRequest;o.open("GET",t),o.timeout=3e4,o.onreadystatechange=function(){if(4===o.readyState){var t=o.status;200===t?e({parsedResponse:o.responseText,request:o}):n(0===t?OneNoteApi.ErrorUtils.createRequestErrorObject(o,OneNoteApi.RequestErrorType.NETWORK_ERROR):OneNoteApi.ErrorUtils.createRequestErrorObject(o,OneNoteApi.RequestErrorType.UNEXPECTED_RESPONSE_STATUS))}},o.ontimeout=function(){n(OneNoteApi.ErrorUtils.createRequestErrorObject(o,OneNoteApi.RequestErrorType.REQUEST_TIMED_OUT))},o.send()})},e}();n.LocalizationHelper=i},{"../constants":6,"../utils":49}],26:[function(e,t,n){"use strict";function o(e,t){switch(e.methodName){case i.LogMethods.logEvent:var n=e.methodArgs[0],o=e.methodArgs[1];t.logEvent.apply(t,[r.Event.createEvent(n,o)]);break;case i.LogMethods.logFailure:t.logFailure.apply(t,e.methodArgs);break;case i.LogMethods.pushToStream:t.pushToStream.apply(t,e.methodArgs);break;case i.LogMethods.logFunnel:t.logUserFunnel.apply(t,e.methodArgs);break;case i.LogMethods.logSessionStart:t.logSessionStart.apply(t,e.methodArgs);break;case i.LogMethods.logSessionEnd:t.logSessionEnd.apply(t,e.methodArgs);break;case i.LogMethods.logClickEvent:t.logClickEvent.apply(t,e.methodArgs);break;case i.LogMethods.setContextProperty:t.setContextProperty.apply(t,e.methodArgs);break;case i.LogMethods.logTrace:default:t.logTrace.apply(t,e.methodArgs)}}var r=e("./submodules/event"),i=e("./submodules/logMethods");n.contextPropertyNameRegex=/^[a-zA-Z0-9](([a-zA-Z0-9|_]){0,98}[a-zA-Z0-9])?$/,n.enableConsoleLogging="enable_console_logging",n.reportData="ReportData",n.unknownValue="unknown",n.parseAndLogDataPackage=o;var a=e("./submodules/click");n.Click=a.Click;var s=e("./submodules/context");n.Context=s.Context;var l=e("./submodules/errorUtils");n.ErrorUtils=l.ErrorUtils;var u=e("./submodules/event");n.Event=u.Event;var p=e("./submodules/failure");n.Failure=p.Failure;var c=e("./submodules/funnel");n.Funnel=c.Funnel;var g=e("./submodules/logMethods");n.LogMethods=g.LogMethods;var d=e("./submodules/noop");n.NoOp=d.NoOp;var f=e("./submodules/propertyName");n.PropertyName=f.PropertyName;var h=e("./submodules/session");n.Session=h.Session;var m=e("./submodules/status");n.Status=m.Status;var v=e("./submodules/trace");n.Trace=v.Trace},{"./submodules/click":29,"./submodules/context":30,"./submodules/errorUtils":31,"./submodules/event":32,"./submodules/failure":33,"./submodules/funnel":34,"./submodules/logMethods":35,"./submodules/noop":36,"./submodules/propertyName":37,"./submodules/session":38,"./submodules/status":39,"./submodules/trace":40}],27:[function(e,t,n){"use strict";var o,r=e("./log");!function(e){function t(e,t){var n={};n[r.PropertyName.Reserved.EventType]=r.reportData,n[r.PropertyName.Reserved.Label]=t;var o=r.PropertyName.Reserved.WebClipper+"."+e;return n[r.PropertyName.Reserved.Category]=o,n[r.PropertyName.Reserved.EventName]=o+"."+t,n}function n(t){if(!t)throw new Error("Button clicked without an ID! Logged with ID "+JSON.stringify(t));var n=e.createBaseEventAsJson(r.Click.category,t);return n}function o(t){t.timerWasStopped()||t.stopTimer();var n=t.getEventCategory(),o=e.createBaseEventAsJson(r.Event.Category[n],t.getLabel());switch(o[r.PropertyName.Reserved.Duration]=t.getDuration(),d(o,t.getCustomProperties()),n){case r.Event.Category.BaseEvent:break;case r.Event.Category.PromiseEvent:i(o,t);break;case r.Event.Category.StreamEvent:a(o,t);break;default:throw new Error("createLogEvent does not specify a case for event category: "+r.Event.Category[n])}return o}function i(e,t){var n=t.getStatus();e[r.PropertyName.Reserved.Status]=n,n===r.Status[r.Status.Failed]&&(e[r.PropertyName.Reserved.FailureInfo]=t.getFailureInfo(),e[r.PropertyName.Reserved.FailureType]=t.getFailureType())}function a(e,t){e[r.PropertyName.Reserved.Stream]=JSON.stringify(t.getEventData().Stream)}function s(t,n){var o=new r.Event.BaseEvent(r.Event.Label.SetContextProperty),i=e.createBaseEventAsJson(r.Event.Category[o.getEventCategory()],o.getLabel()),a=r.Context.toString(t);return i[r.PropertyName.Custom[r.PropertyName.Custom.Key]]=a,i[r.PropertyName.Custom[r.PropertyName.Custom.Value]]=n,i}function l(t,n,o,i){var a=e.createBaseEventAsJson(r.Failure.category,r.Failure.Label[t]);return a[r.PropertyName.Reserved.FailureType]=r.Failure.Type[n],o&&(a[r.PropertyName.Reserved.FailureInfo]=r.ErrorUtils.toString(o)),i&&(a[r.PropertyName.Reserved.Id]=i),a[r.PropertyName.Reserved.StackTrace]=r.Failure.getStackTrace(),a}function u(t){var n=e.createBaseEventAsJson(r.Funnel.category,r.Funnel.Label[t]);return n}function p(){var t=e.createBaseEventAsJson(r.Session.category,r.Session.State[r.Session.State.Started]);return t}function c(t){var n=e.createBaseEventAsJson(r.Session.category,r.Session.State[r.Session.State.Ended]);return n[r.PropertyName.Reserved.Trigger]=r.Session.EndTrigger[t],n}function g(t,n,o){var i=e.createBaseEventAsJson(r.Trace.category,r.Trace.Label[t]);switch(o&&(i[r.PropertyName.Reserved.Message]=o),i[r.PropertyName.Reserved.Level]=r.Trace.Level[n],n){case r.Trace.Level.Warning:i[r.PropertyName.Reserved.StackTrace]=r.Failure.getStackTrace()}return i}function d(e,t){if(e[r.PropertyName.Reserved.Status]===r.Status[r.Status.Failed]&&(e[r.PropertyName.Reserved.StackTrace]=r.Failure.getStackTrace()),t)for(var n in t)if(t.hasOwnProperty(n)){var o=void 0;o="object"==typeof t[n]?JSON.stringify(t[n]):t[n],e[n]=o}}function f(){try{if(localStorage.getItem(r.enableConsoleLogging))return!0}catch(e){}return!1}e.createBaseEventAsJson=t,e.createClickEventAsJson=n,e.createLogEventAsJson=o,e.createSetContextEventAsJson=s,e.createFailureEventAsJson=l,e.createFunnelEventAsJson=u,e.createSessionStartEventAsJson=p,e.createSessionEndEventAsJson=c,e.createTraceEventAsJson=g,e.addToLogEvent=d,e.isConsoleOutputEnabled=f}(o=n.LogHelpers||(n.LogHelpers={}))},{"./log":26}],28:[function(e,t,n){"use strict";var o=e("./log"),r=function(){function e(){}return e.prototype.logJsonParseUnexpected=function(e){this.logFailure(o.Failure.Label.JsonParse,o.Failure.Type.Unexpected,void 0,e)},e}();n.Logger=r},{"./log":26}],29:[function(e,t,n){"use strict";var o;!function(e){e.category="Click";var t;!function(e){e.regionSelectionRemoveButton="RegionSelectionRemoveButton",e.sectionComponent="SectionComponent",e.sectionPickerLocationContainer="SectionPickerLocationContainer"}(t=e.Label||(e.Label={}))}(o=n.Click||(n.Click={}))},{}],30:[function(e,t,n){"use strict";var o;!function(e){function t(e){return n[o[e]]}var n={AppInfoId:"AppInfo.Id",AppInfoVersion:"AppInfo.Version",DeviceInfoId:"DeviceInfo.Id",SessionId:"Session.Id",UserInfoId:"UserInfo.Id",UserInfoLanguage:"UserInfo.Language",AuthType:"AuthType",BrowserLanguage:"BrowserLanguage",ClipperType:"ClipperType",ContentType:"ContentType",FlightInfo:"FlightInfo",InPrivateBrowsing:"InPrivateBrowsing",InvokeHostname:"InvokeHostname",PageLanguage:"PageLanguage"};!function(e){e[e.AppInfoId=0]="AppInfoId",e[e.AppInfoVersion=1]="AppInfoVersion",e[e.DeviceInfoId=2]="DeviceInfoId",e[e.SessionId=3]="SessionId",e[e.UserInfoId=4]="UserInfoId",e[e.UserInfoLanguage=5]="UserInfoLanguage",e[e.AuthType=6]="AuthType",e[e.BrowserLanguage=7]="BrowserLanguage",e[e.ClipperType=8]="ClipperType",e[e.ContentType=9]="ContentType",e[e.FlightInfo=10]="FlightInfo",e[e.InPrivateBrowsing=11]="InPrivateBrowsing",e[e.InvokeHostname=12]="InvokeHostname",e[e.PageLanguage=13]="PageLanguage"}(e.Custom||(e.Custom={}));var o=e.Custom;e.toString=t}(o=n.Context||(n.Context={}))},{}],31:[function(e,t,n){"use strict";var o,r=e("../../clientType"),i=e("../../constants"),a=e("../../utils"),s=e("../../localization/localization"),l=e("../log");!function(e){function t(e){if(e){var t={};t[d[d.error]]=e.error;var n=e;return n&&void 0!==n.statusCode&&(t[d[d.statusCode]]=n.statusCode,t[d[d.response]]=n.response,t[d[d.responseHeaders]]=n.responseHeaders,void 0!==n.timeout&&(t[d[d.timeout]]=n.timeout)),JSON.stringify(t)}}function n(e){if(e){var t=e;return t&&void 0!==t.statusCode?void 0!==t.timeout?{error:t.error,statusCode:t.statusCode,response:t.response,responseHeaders:t.responseHeaders,timeout:t.timeout}:{error:t.error,statusCode:t.statusCode,response:t.response,responseHeaders:t.responseHeaders}:{error:e.error}}}function o(t){var n={};n[i.Constants.Urls.QueryParams.failureType]=l.Failure.Type[t.properties.failureType],n[i.Constants.Urls.QueryParams.failureInfo]=e.toString(t.properties.failureInfo),n[i.Constants.Urls.QueryParams.stackTrace]=t.properties.stackTrace,a.Utils.isNullOrUndefined(t.properties.failureId)||(n[i.Constants.Urls.QueryParams.failureId]=t.properties.failureId);var o=t.clientInfo;g(n,o),LogManager.sendMiscLogRequest({label:l.Failure.Label[t.label],category:l.Failure.category,properties:n},!0)}function u(t,n,o,r){var i;throw i=r?JSON.stringify({message:r,error:n.toString()}):n.toString(),e.sendFailureLogRequest({label:l.Failure.Label.UnhandledExceptionThrown,properties:{failureType:l.Failure.Type.Unexpected,failureInfo:{error:i},failureId:"Channel "+t,stackTrace:l.Failure.getStackTrace(n)},clientInfo:o}),n}function p(e,t){void 0===t&&(t=!1);var n={};n[i.Constants.Urls.QueryParams.channel]=e.channel,n[i.Constants.Urls.QueryParams.url]=encodeURIComponent(e.url),n[i.Constants.Urls.QueryParams.timeoutInMs]=i.Constants.Settings.noOpTrackerTimeoutDuration.toString();var o=e.clientInfo;g(n,o),LogManager.sendMiscLogRequest({label:l.NoOp.Label[e.label],category:l.NoOp.category,properties:n},!0),t&&window&&window.alert(s.Localization.getLocalizedString("WebClipper.Error.NoOpError"))}function c(e,t){return void 0===t&&(t=!1),setTimeout(function(){p(e,t)},i.Constants.Settings.noOpTrackerTimeoutDuration)}function g(e,t){t&&(e[i.Constants.Urls.QueryParams.clientType]=a.Utils.isNullOrUndefined(t.get())?l.unknownValue:r.ClientType[t.get().clipperType],e[i.Constants.Urls.QueryParams.clipperVersion]=a.Utils.isNullOrUndefined(t.get())?l.unknownValue:t.get().clipperVersion,e[i.Constants.Urls.QueryParams.clipperId]=a.Utils.isNullOrUndefined(t.get())?l.unknownValue:t.get().clipperId)}var d;!function(e){e[e.error=0]="error",e[e.statusCode=1]="statusCode",e[e.response=2]="response",e[e.responseHeaders=3]="responseHeaders",e[e.timeout=4]="timeout"}(d||(d={})),e.toString=t,e.clone=n,e.sendFailureLogRequest=o,e.handleCommunicatorError=u,e.sendNoOpTrackerRequest=p,e.setNoOpTrackerRequestTimeout=c}(o=n.ErrorUtils||(n.ErrorUtils={}))},{"../../clientType":1,"../../constants":6,"../../localization/localization":24,"../../utils":49,"../log":26}],32:[function(e,t,n){"use strict";var o,r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},i=e("../log"),a=e("../../utils");!function(e){function t(t,n){switch(t){default:case e.Category.BaseEvent:return new e.BaseEvent(n);case e.Category.PromiseEvent:return new e.PromiseEvent(n);case e.Category.StreamEvent:return new e.StreamEvent(n)}}!function(e){e[e.BaseEvent=0]="BaseEvent",e[e.PromiseEvent=1]="PromiseEvent",e[e.StreamEvent=2]="StreamEvent"}(e.Category||(e.Category={}));e.Category;!function(e){e[e.AddEmbeddedVideo=0]="AddEmbeddedVideo",e[e.AugmentationApiCall=1]="AugmentationApiCall",e[e.BookmarkPage=2]="BookmarkPage",e[e.CompressRegionSelection=3]="CompressRegionSelection",e[e.ClearNoOpTracker=4]="ClearNoOpTracker",e[e.Click=5]="Click",e[e.ClipToOneNoteAction=6]="ClipToOneNoteAction",e[e.CloseClipper=7]="CloseClipper",e[e.ClosePageNavTooltip=8]="ClosePageNavTooltip",e[e.DebugFeedback=9]="DebugFeedback",e[e.DeviceIdMap=10]="DeviceIdMap",e[e.FetchNonLocalData=11]="FetchNonLocalData",e[e.FullPageScreenshotCall=12]="FullPageScreenshotCall",e[e.GetBinaryRequest=13]="GetBinaryRequest",e[e.GetCleanDom=14]="GetCleanDom",e[e.GetDefaultSection=15]="GetDefaultSection",e[e.GetExistingUserInformation=16]="GetExistingUserInformation",e[e.GetFlightingAssignments=17]="GetFlightingAssignments",e[e.GetLocale=18]="GetLocale",e[e.GetLocalizedStrings=19]="GetLocalizedStrings",e[e.GetNotebooks=20]="GetNotebooks",e[e.HandleSignInEvent=21]="HandleSignInEvent",e[e.HideClipperDueToSpaNavigate=22]="HideClipperDueToSpaNavigate",e[e.InvokeClipper=23]="InvokeClipper",e[e.InvokeTooltip=24]="InvokeTooltip",e[e.InvokeWhatsNew=25]="InvokeWhatsNew",e[e.RegionSelectionCapturing=26]="RegionSelectionCapturing",e[e.RegionSelectionLoading=27]="RegionSelectionLoading",e[e.RegionSelectionProcessing=28]="RegionSelectionProcessing",e[e.SetContextProperty=29]="SetContextProperty",e[e.SetDoNotPromptRatings=30]="SetDoNotPromptRatings",e[e.ShouldShowRatingsPrompt=31]="ShouldShowRatingsPrompt",e[e.PageModifications=32]="PageModifications",e[e.PostToOneNoteApi=33]="PostToOneNoteApi",e[e.ProcessPdfIntoDataUrls=34]="ProcessPdfIntoDataUrls",e[e.RefreshUserToken=35]="RefreshUserToken",e[e.TooltipImpression=36]="TooltipImpression",e[e.UserInfoUpdated=37]="UserInfoUpdated",e[e.WaitOnBinaryRequestBeforePdfClip=38]="WaitOnBinaryRequestBeforePdfClip",e[e.WhatsNewImpression=39]="WhatsNewImpression"}(e.Label||(e.Label={}));var n=(e.Label,function(){function t(e){if(this._timerWasStopped=!1,this.isEventData(e)){var t=e;this._label=t.Label,this._duration=t.Duration,this._properties=t.Properties?JSON.parse(JSON.stringify(t.Properties)):void 0}else{var n=e;this._label=n,this.startTimer()}}return t.prototype.getDuration=function(){return this._duration},t.prototype.getEventCategory=function(){return e.Category.BaseEvent},t.prototype.getEventData=function(){return{Label:this._label,Duration:this._duration,Properties:this.getCustomProperties()}},t.prototype.getLabel=function(){return e.Label[this._label]},t.prototype.getCustomProperties=function(){return this._properties?JSON.parse(JSON.stringify(this._properties)):void 0},t.prototype.setCustomProperty=function(e,t){if(this.isReservedPropertyName(e))throw new Error("Tried to overwrite key '"+i.PropertyName.Custom[e]+"' with value of "+JSON.stringify(t));this._properties||(this._properties={}),this._properties[i.PropertyName.Custom[e]]=t},t.prototype.startTimer=function(){this._startTime=(new Date).getTime()},t.prototype.stopTimer=function(){return!!this._startTime&&(this._duration=(new Date).getTime()-this._startTime,this._timerWasStopped=!0,!0)},t.prototype.timerWasStopped=function(){return this._timerWasStopped},t.prototype.isEventData=function(e){var t=e;return!(!t||a.Utils.isNullOrUndefined(t.Label))},t.prototype.isReservedPropertyName=function(e){for(var t in i.PropertyName.Reserved)if(i.PropertyName.Custom[e].toLowerCase()===t.toLowerCase())return!0;return!1},t}());e.BaseEvent=n;var o=function(t){function n(e){if(t.call(this,e),this._logStatus=i.Status.Succeeded,this._failureType=i.Failure.Type.Unexpected,this.isEventData(e)){var n=e;this._logStatus=n.LogStatus,this._failureType=n.FailureType,this._failureInfo=i.ErrorUtils.clone(n.FailureInfo)}}return r(n,t),n.prototype.getEventCategory=function(){return e.Category.PromiseEvent},n.prototype.getEventData=function(){return{Label:this._label,Duration:this._duration,Properties:this.getCustomProperties(),LogStatus:this._logStatus,FailureType:this._failureType,FailureInfo:i.ErrorUtils.clone(this._failureInfo)}},n.prototype.getStatus=function(){return i.Status[this._logStatus]},n.prototype.setStatus=function(e){this._logStatus=e,this._timerWasStopped||this.stopTimer()},n.prototype.getFailureInfo=function(){return i.ErrorUtils.toString(this._failureInfo)},n.prototype.setFailureInfo=function(e){this._failureInfo=i.ErrorUtils.clone(e)},n.prototype.getFailureType=function(){return i.Failure.Type[this._failureType]},n.prototype.setFailureType=function(e){this._failureType=e},n}(n);e.PromiseEvent=o;var s=function(t){function n(e){if(t.call(this,e),this._stream=[],this.isEventData(e)){var n=e;this._stream=n.Stream}}return r(n,t),n.prototype.getEventCategory=function(){return e.Category.StreamEvent},n.prototype.getEventData=function(){return{Label:this._label,Duration:this._duration,Properties:this.getCustomProperties(),Stream:this._stream}},n.prototype.append=function(e){this._stream.push(e)},n}(n);e.StreamEvent=s,e.createEvent=t}(o=n.Event||(n.Event={}))},{"../../utils":49,"../log":26}],33:[function(e,t,n){"use strict";var o;!function(e){function t(e){return e||(e=new Error),e.stack}e.category="Failure",function(e){e[e.Unexpected=0]="Unexpected",e[e.Expected=1]="Expected"}(e.Type||(e.Type={}));e.Type;e.getStackTrace=t,function(e){e[e.ClickedButtonWithNoId=0]="ClickedButtonWithNoId",e[e.EndSessionWithoutTrigger=1]="EndSessionWithoutTrigger",e[e.GetChangeLog=2]="GetChangeLog",e[e.GetComputedStyle=3]="GetComputedStyle",e[e.GetLocalizedString=4]="GetLocalizedString",e[e.GetSetting=5]="GetSetting",e[e.IFrameMessageHandlerHasNoOtherWindow=6]="IFrameMessageHandlerHasNoOtherWindow",e[e.InvalidArgument=7]="InvalidArgument",e[e.IsFeatureEnabled=8]="IsFeatureEnabled",e[e.JsonParse=9]="JsonParse",e[e.NotImplemented=10]="NotImplemented",e[e.OnLaunchOneNoteButton=11]="OnLaunchOneNoteButton",e[e.OrphanedWebClippersDueToExtensionRefresh=12]="OrphanedWebClippersDueToExtensionRefresh",e[e.RegionSelectionProcessing=13]="RegionSelectionProcessing",e[e.RenderFailurePanel=14]="RenderFailurePanel",e[e.ReservedPropertyOverwriteAttempted=15]="ReservedPropertyOverwriteAttempted",e[e.SessionAlreadySet=16]="SessionAlreadySet",e[e.SetLoggerNoop=17]="SetLoggerNoop",e[e.SetUndefinedLocalizedStrings=18]="SetUndefinedLocalizedStrings",e[e.TraceLevelErrorWarningMessage=19]="TraceLevelErrorWarningMessage",e[e.UnhandledApiCode=20]="UnhandledApiCode",e[e.UnhandledExceptionThrown=21]="UnhandledExceptionThrown",e[e.UserSetWithInvalidExpiredData=22]="UserSetWithInvalidExpiredData",e[e.WebExtensionWindowCreate=23]="WebExtensionWindowCreate",e[e.UnclippablePage=24]="UnclippablePage",e[e.UnsupportedBrowser=25]="UnsupportedBrowser"}(e.Label||(e.Label={}));e.Label}(o=n.Failure||(n.Failure={}))},{}],34:[function(e,t,n){"use strict";var o;!function(e){e.category="Funnel",function(e){e[e.Invoke=0]="Invoke",e[e.AuthAlreadySignedIn=1]="AuthAlreadySignedIn",e[e.AuthAttempted=2]="AuthAttempted",e[e.AuthSignInCompleted=3]="AuthSignInCompleted",e[e.ClipAttempted=4]="ClipAttempted",e[e.Interact=5]="Interact",e[e.ViewInWac=6]="ViewInWac",e[e.SignOut=7]="SignOut"}(e.Label||(e.Label={}));e.Label}(o=n.Funnel||(n.Funnel={}))},{}],35:[function(e,t,n){"use strict";!function(e){e[e.logEvent=0]="logEvent",e[e.logFailure=1]="logFailure",e[e.pushToStream=2]="pushToStream",e[e.logFunnel=3]="logFunnel",e[e.logSession=4]="logSession",e[e.logSessionStart=5]="logSessionStart",e[e.logSessionEnd=6]="logSessionEnd",e[e.logTrace=7]="logTrace",e[e.logClickEvent=8]="logClickEvent",e[e.setContextProperty=9]="setContextProperty"}(n.LogMethods||(n.LogMethods={}));n.LogMethods},{}],36:[function(e,t,n){"use strict";var o;!function(e){e.category="NoOp",function(e){e[e.InitializeCommunicator=0]="InitializeCommunicator",e[e.WebClipperUiFrameDidNotExist=1]="WebClipperUiFrameDidNotExist",e[e.WebClipperUiFrameIsNotVisible=2]="WebClipperUiFrameIsNotVisible"}(e.Label||(e.Label={}));e.Label}(o=n.NoOp||(n.NoOp={}))},{}],37:[function(e,t,n){"use strict";var o;!function(e){!function(e){e[e.AnnotationAdded=0]="AnnotationAdded",e[e.AugmentationModel=1]="AugmentationModel",e[e.AverageProcessingDurationPerPage=2]="AverageProcessingDurationPerPage",e[e.BookmarkInfo=3]="BookmarkInfo",e[e.ByteLength=4]="ByteLength",e[e.BytesTrimmed=5]="BytesTrimmed",e[e.Channel=6]="Channel",e[e.ClipMode=7]="ClipMode",e[e.CloseReason=8]="CloseReason",e[e.ContainsAtLeastOneHighlight=9]="ContainsAtLeastOneHighlight",e[e.ContentType=10]="ContentType",e[e.CorrelationId=11]="CorrelationId",e[e.CurrentPanel=12]="CurrentPanel",e[e.CurrentSectionStillExists=13]="CurrentSectionStillExists",e[e.DeviceIdInStorage=14]="DeviceIdInStorage",e[e.DeviceIdInCookie=15]="DeviceIdInCookie",e[e.DomSizeInBytes=16]="DomSizeInBytes",e[e.FeatureEnabled=17]="FeatureEnabled",e[e.FinalDataUrlLength=18]="FinalDataUrlLength",e[e.FontSize=19]="FontSize",e[e.ForceRetrieveFreshLocStrings=20]="ForceRetrieveFreshLocStrings",e[e.FoundDefaultNotebook=21]="FoundDefaultNotebook",e[e.FoundDefaultSection=22]="FoundDefaultSection",e[e.FreshUserInfoAvailable=23]="FreshUserInfoAvailable",e[e.FullPageScreenshotContentFound=24]="FullPageScreenshotContentFound",e[e.Height=25]="Height",e[e.InitialDataUrlLength=26]="InitialDataUrlLength",e[e.InvokeMode=27]="InvokeMode",e[e.InvokeSource=28]="InvokeSource",e[e.IsRetryable=29]="IsRetryable",e[e.IsSerif=30]="IsSerif",e[e.Key=31]="Key",e[e.LastSeenTooltipTime=32]="LastSeenTooltipTime",e[e.LastUpdated=33]="LastUpdated",e[e.MaxDepth=34]="MaxDepth",e[e.NumPages=35]="NumPages",e[e.NumTimesTooltipHasBeenSeen=36]="NumTimesTooltipHasBeenSeen",e[e.PageNavTooltipType=37]="PageNavTooltipType",e[e.PageTitleModified=38]="PageTitleModified",e[e.Quality=39]="Quality",e[e.QualityStepDownCount=40]="QualityStepDownCount",e[e.RatingsInfo=41]="RatingsInfo",e[e.RequestCorrelationId=42]="RequestCorrelationId",e[e.ShouldShowRatingsPrompt=43]="ShouldShowRatingsPrompt",e[e.SignInCancelled=44]="SignInCancelled",e[e.StoredLocaleDifferentThanRequested=45]="StoredLocaleDifferentThanRequested",e[e.Styles=46]="Styles",e[e.TimeToClearNoOpTracker=47]="TimeToClearNoOpTracker",e[e.TooltipType=48]="TooltipType",e[e.UpdateInterval=49]="UpdateInterval",e[e.UserInformationReturned=50]="UserInformationReturned",e[e.UserInformationStored=51]="UserInformationStored",e[e.UserUpdateReason=52]="UserUpdateReason",e[e.Url=53]="Url",e[e.Value=54]="Value",e[e.VideoDataOriginalSrcUrl=55]="VideoDataOriginalSrcUrl",e[e.VideoSrcUrl=56]="VideoSrcUrl",e[e.Width=57]="Width"}(e.Custom||(e.Custom={}));var t;e.Custom;!function(e){e.Category="Category",e.Duration="Duration",e.EventName="EventName",e.EventType="EventType",e.FailureInfo="FailureInfo",e.FailureType="FailureType",e.Id="Id",e.Label="Label",e.Level="Level",e.Message="Message",e.Properties="Properties",e.StackTrace="StackTrace",e.Status="Status",e.Stream="Stream",e.Trigger="Trigger",e.WebClipper="WebClipper"}(t=e.Reserved||(e.Reserved={}))}(o=n.PropertyName||(n.PropertyName={}))},{}],38:[function(e,t,n){"use strict";var o;!function(e){e.category="Session",function(e){e[e.SignOut=0]="SignOut",e[e.Unload=1]="Unload"}(e.EndTrigger||(e.EndTrigger={}));e.EndTrigger;!function(e){e[e.Started=0]="Started",e[e.Ended=1]="Ended"}(e.State||(e.State={}));e.State}(o=n.Session||(n.Session={}))},{}],39:[function(e,t,n){"use strict";!function(e){e[e.Succeeded=0]="Succeeded",e[e.Failed=1]="Failed"}(n.Status||(n.Status={}));n.Status},{}],40:[function(e,t,n){"use strict";var o;!function(e){e.category="Trace",function(e){e[e.DefaultingToConsoleLogger=0]="DefaultingToConsoleLogger",e[e.DebugMode=1]="DebugMode",e[e.RequestForClipperInstalledPageUrl=2]="RequestForClipperInstalledPageUrl"}(e.Label||(e.Label={}));e.Label;!function(e){e[e.None=0]="None",e[e.Error=1]="Error",e[e.Warning=2]="Warning",e[e.Information=3]="Information",e[e.Verbose=4]="Verbose"}(e.Level||(e.Level={}));e.Level}(o=n.Trace||(n.Trace={}))},{}],41:[function(e,t,n){"use strict";var o,r=e("es6-promise");!function(e){function t(){n(),o(),i()}function n(){"function"!=typeof Object.assign&&(Object.assign=function(e){if(!e)throw new TypeError("Cannot convert undefined to object");for(var t=Object(e),n=1;n<arguments.length;n++){var o=arguments[n];if(o)for(var r in o)o.hasOwnProperty(r)&&(t[r]=o[r])}return t})}function o(){"undefined"==typeof Promise&&r.polyfill()}function i(){window.requestAnimationFrame||(window.requestAnimationFrame=window.msRequestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.oRequestAnimationFrame||function(e){setTimeout(function(){e(Date.now())},16)})}e.init=t}(o=n.Polyfills||(n.Polyfills={}))},{"es6-promise":56}],42:[function(e,t,n){"use strict";var o,r=e("../settings.json");!function(t){function n(e){var t=r[e];if(t&&t.Value)return t.Value}function o(t){r=t?t:e("../settings.json")}t.getSetting=n,t.setSettingsJsonForTesting=o}(o=n.Settings||(n.Settings={}))},{"../settings.json":53}],43:[function(e,t,n){"use strict";var o=function(){function e(){}return e.prototype.getValue=function(e){var t;return window.localStorage&&(t=window.localStorage.getItem(e),t||this.removeKey(e)),t},e.prototype.getValues=function(e){var t={};if(window.localStorage&&e)for(var n=0;n<e.length;n++){var o=window.localStorage.getItem(e[n]);o?t[e[n]]=o:this.removeKey(e[n])}return t},e.prototype.setValue=function(e,t){window.localStorage&&(t?window.localStorage.setItem(e,t):window.localStorage.removeItem(e))},e.prototype.removeKey=function(e){return window.localStorage&&window.localStorage.removeItem(e),!0},e}();n.LocalStorage=o},{}],44:[function(e,t,n){"use strict";var o=e("../http/clipperCachedHttp"),r=e("./clipperStorageGateStrategy"),i=function(){function e(e,t){this.storage=e,this.storageGateStrategy=new r.ClipperStorageGateStrategy(e),this.cachedHttp=new o.ClipperCachedHttp(this,t)}return e.prototype.setLogger=function(e){this.cachedHttp.setLogger(e)},e.prototype.getFreshValue=function(e,t,n){return this.cachedHttp.getFreshValue(e,t,n)},e.prototype.getValue=function(e){return this.storage.getValue(e)},e.prototype.getValues=function(e){return this.storage.getValues(e)},e.prototype.setValue=function(e,t){this.storageGateStrategy.shouldSet(e,t)&&this.storage.setValue(e,t)},e.prototype.removeKey=function(e){return this.storage.removeKey(e)},e}();n.ClipperData=i},{"../http/clipperCachedHttp":22,"./clipperStorageGateStrategy":45}],45:[function(e,t,n){"use strict";var o=e("./clipperStorageKeys"),r=function(){function e(e){this.keysThatRequireUserInfo=[o.ClipperStorageKeys.cachedNotebooks,o.ClipperStorageKeys.currentSelectedSection],this.storage=e}return e.prototype.shouldSet=function(e,t){if(t&&this.keysThatRequireUserInfo.indexOf(e)>-1){var n=this.storage.getValue(o.ClipperStorageKeys.userInformation);return!!n}return!0},e}();n.ClipperStorageGateStrategy=r},{"./clipperStorageKeys":46}],46:[function(e,t,n){"use strict";var o;!function(e){e.clipperId="clipperId",e.cachedNotebooks="notebooks",e.currentSelectedSection="curSection",e.displayLanguageOverride="displayLocaleOverride",e.doNotPromptRatings="doNotPromptRatings",e.flightingInfo="flightingInfo",e.lastBadRatingDate="lastBadRatingDate",e.lastBadRatingVersion="lastBadRatingVersion",e.lastClippedDate="lastClippedDate",e.lastSeenVersion="lastSeenVersion",e.lastInvokedDate="lastInvokedDate",e.lastSeenTooltipTimeBase="lastSeenTooltipTime",e.lastClippedTooltipTimeBase="lastClippedTooltipTime",e.locale="locale",e.locStrings="locStrings",e.numSuccessfulClips="numSuccessfulClips",e.numTimesTooltipHasBeenSeenBase="numTimesTooltipHasBeenSeen",e.userInformation="userInformation"}(o=n.ClipperStorageKeys||(n.ClipperStorageKeys={}))},{}],47:[function(e,t,n){arguments[4][43][0].apply(n,arguments)},{dup:43}],48:[function(e,t,n){"use strict";!function(e){e[e.Msa=0]="Msa",e[e.OrgId=1]="OrgId"}(n.AuthType||(n.AuthType={}));n.AuthType;!function(e){e[e.InitialRetrieval=0]="InitialRetrieval",e[e.SignInAttempt=1]="SignInAttempt",e[e.SignInCancel=2]="SignInCancel",e[e.SignOutAction=3]="SignOutAction",e[e.TokenRefreshForPendingClip=4]="TokenRefreshForPendingClip"}(n.UpdateReason||(n.UpdateReason={}));n.UpdateReason},{}],49:[function(e,t,n){"use strict";var o,r=e("./clientType"),i=e("./constants"),a=e("./settings"),s=e("./clipperUI/tooltipType");!function(e){function t(e){var t=1e3,n=700,o=screen.width?(screen.width-t)/2:0,r=screen.height?(screen.height-n)/2:0,i="height="+n+",width="+t+",top="+r+",left="+o+",scrollbars=yes,resizable=yes,location=no,menubar=no,status=yes,titlebar=no,toolbar=no";return window.open(e,"_blank",i)}function n(e,t){if(e&&t){var n=t.replace(/[\[\]]/g,"\\$&"),o=new RegExp("[?&]"+n+"(=([^&#]*)|&|#|$)","i"),r=o.exec(e);if(r)return r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):""}}function o(t,n,o,r){if(void 0===r&&(r=!1),!t||!n||!o)return t;r&&(n=e.toCamelCase(n));var i=t.match(/^([^#]*)(#.*)?$/),a=i[1],s=i[2]?i[2]:"",l=a.indexOf("?");if(l===-1)return a+"?"+n+"="+o+s;if(l===a.length-1)return a+n+"="+o+s;for(var u=a.substring(l+1).split("&"),p=0;p<u.length;p++){var c=u[p].split("=");if(c[0]===n)return u[p]=c[0]+"="+o,a.substring(0,l+1)+u.join("&")+s}return a+"&"+n+"="+o+s}function l(t,n,o,r){var a=e.addUrlQueryValue(t,i.Constants.Urls.QueryParams.authType,r);return a=e.addUrlQueryValue(a,i.Constants.Urls.QueryParams.clipperId,n),a=e.addUrlQueryValue(a,i.Constants.Urls.QueryParams.userSessionId,o)}function u(e,t,n){return l(i.Constants.Urls.Authentication.signInUrl,e,t,n)}function p(e,t,n){return l(i.Constants.Urls.Authentication.signOutUrl,e,t,n)}function c(t,n,o){var a=e.addUrlQueryValue(i.Constants.Urls.clipperFeedbackUrl,"LogCategory",o);return a=e.addUrlQueryValue(a,"originalUrl",t.pageInfo.rawUrl),a=e.addUrlQueryValue(a,"clipperId",t.clientInfo.clipperId),a=e.addUrlQueryValue(a,"usid",n),a=e.addUrlQueryValue(a,"type",r.ClientType[t.clientInfo.clipperType]),a=e.addUrlQueryValue(a,"version",t.clientInfo.clipperVersion)}function g(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,n="x"===e?t:3&t|8;return n.toString(16)})}function d(e){var t=document.createElement("a");return t.href=e,t.protocol+"//"+t.host+"/"}function f(e){var t=document.createElement("a");t.href=e;var n=t.pathname;return this.ensureLeadingForwardSlash(n)}function h(e,t){for(var n=0;n<t.length;++n){var o=t[n],r=s.TooltipType[o],i=a.Settings.getSetting(r+"Domains"),l=new RegExp(i.join("|"),"i");if(l.test(e))return o}}function m(e){return e=this.isNullOrUndefined(e)?"/":e,e.length>0&&"/"===e.charAt(0)?e:"/"+e}function v(e,t){if(!e)return t;var n=/\/(?=[^\/]+\.\w{3,4}$).+/g.exec(e);return n&&n[0]?n[0].slice(1):t}function y(e){return null===e||void 0===e}function C(e){return"number"==typeof e&&!isNaN(e)}function b(e){return("images/"+e).toLowerCase()}function S(e){return e.charAt(0).toUpperCase()+e.slice(1)}function w(e){if(!e)return!1;var t=["AugmentationDefault_WhitelistedDomains","ProductDomains","RecipeDomains"],n=[];t.forEach(function(e){n=n.concat(a.Settings.getSetting(e))});for(var o=0,r=n;o<r.length;o++){var i=r[o];if(new RegExp(i).test(e))return!0}return!1}function T(e){var t=document.createElement("iframe");
t.hidden=!0,t.style.display="none",t.src=e,document.body.appendChild(t)}function I(e,t){var n={};if(e)for(var o in e)e.hasOwnProperty(o)&&(n[o]=e[o]);if(t)for(var o in t)t.hasOwnProperty(o)&&(n[o]=t[o]);return n}function E(t,n){e.isNullOrUndefined(n)&&(n=document);for(var o=document.cookie.split(";").map(function(e){return e.split("=")}),r=0,i=o;r<i.length;r++){var a=i[r];if(a[0].trim()===t)return a[1].trim()}}e.openPopupWindow=t,e.getQueryValue=n,e.addUrlQueryValue=o,e.generateSignInUrl=u,e.generateSignOutUrl=p,e.generateFeedbackUrl=c,e.generateGuid=g,e.getHostname=d,e.getPathname=f,e.checkIfUrlMatchesAContentType=h,e.ensureLeadingForwardSlash=m,e.getFileNameFromUrl=v,e.isNullOrUndefined=y,e.isNumeric=C,e.getImageResourceUrl=b,e.toCamelCase=S,e.onWhitelistedDomain=w,e.appendHiddenIframeToDocument=T,e.createUpdatedObject=I,e.readCookie=E}(o=n.Utils||(n.Utils={}))},{"./clientType":1,"./clipperUI/tooltipType":2,"./constants":6,"./settings":42}],50:[function(e,t,n){"use strict";var o;!function(e){e.schemaVersionSupported="1"}(o=n.ChangeLog||(n.ChangeLog={}))},{}],51:[function(e,t,n){"use strict";var o,r=e("./version");!function(e){function t(e,t){if(!e||0===e.length)return[];if(!t)return e;for(var n=0;n<e.length;n++){var o=new r.Version(e[n].version);if(t.isGreaterThanOrEqualTo(o))return e.slice(0,n)}return e}function n(e,t,n){if(!e||0===e.length)return[];for(var o=[],i=0;i<e.length;i++){var a=new r.Version(e[i].version);if(t&&a.isLesserThanOrEqualTo(t))break;a.isLesserThanOrEqualTo(n)&&o.push(e[i])}return o}function o(e,t){if(!e||!t)return[];for(var n=[],o=0;o<e.length;o++){var r=e[o],i=r.changes.filter(function(e){return e.supportedBrowsers.indexOf(t)!==-1});i.length>0&&n.push({version:r.version,date:r.date,changes:i})}return n}e.getUpdatesSinceVersion=t,e.getUpdatesBetweenVersions=n,e.filterUpdatesThatDontApplyToBrowser=o}(o=n.ChangeLogHelper||(n.ChangeLogHelper={}))},{"./version":52}],52:[function(e,t,n){"use strict";var o=function(){function e(e){if(!e||!/^\d+\.\d+\.\d+$/.test(e))throw new Error("version must match 'int.int.int' pattern, but was: "+e);var t=e.split(".");this.major=parseInt(t[0],10),this.minor=parseInt(t[1],10),this.patch=parseInt(t[2],10),this.stringRepresentation=this.major+"."+this.minor+"."+this.patch}return e.prototype.isEqualTo=function(e,t){return this.major===e.major&&this.minor===e.minor&&(t||this.patch===e.patch)},e.prototype.isGreaterThan=function(e,t){return this.major!==e.major?this.major>e.major:this.minor!==e.minor?this.minor>e.minor:!t&&this.patch>e.patch},e.prototype.isGreaterThanOrEqualTo=function(e,t){return this.isEqualTo(e,t)||this.isGreaterThan(e,t)},e.prototype.isLesserThan=function(e,t){return this.major!==e.major?this.major<e.major:this.minor!==e.minor?this.minor<e.minor:!t&&this.patch<e.patch},e.prototype.isLesserThanOrEqualTo=function(e,t){return this.isEqualTo(e,t)||this.isLesserThan(e,t)},e.prototype.toString=function(){return this.stringRepresentation},e}();n.Version=o},{}],53:[function(e,t,n){t.exports={DummyObjectForTestingPurposes:{Description:"Do not remove under any circumstances!",Value:"Testing."},AugmentationDefault_WhitelistedDomains:{Description:"The set of domains on which we are changing the default clip mode to Augmentation.",Value:["onenote","wikipedia","nytimes","lifehacker","msn","theguardian","forbes","bbc","huffingtonpost","businessinsider","washingtonpost","medium","buzzfeed","bbc","theverge","techcrunch","amazon","allrecipes","foodnetwork","seriouseats","epicurious","support.office.com","blogs.office.com","blogs.technet.com","youtube\\.com\\/watch(\\?v=(\\w+)|.*\\&v=(\\w+))","youtube\\.com\\/embed\\/(\\w+)","vimeo\\.com.*?\\/(\\d+)($|\\?|\\#|\\/$)","vimeo\\.com.*?\\/(\\d+)\\/\\w+:\\w+(\\/|$)","khanacademy\\.org(.*)/v/(.*)","\\/(\\d{2}|\\d{4})\\/\\d{1,2}\\/","\\/(\\d{2}|\\d{4})-\\d{1,2}-\\d{1,2}\\/"]},PdfDomains:{Description:"PDF regexes",Value:["^.*(.pdf)$"]},RecipeDomains:{Description:"The set of domains where we want to show a Recipe tooltip",Value:["^(http(s)?)://(12tomatoes\\.com/)()([^/]*-[^/]*)/$","^(http(s)?)://(abc\\.go\\.com/shows/the-chew/recipes/)([^/]*-[^/]*)$","^(http(s)?)://(([^ ]{1,18})?)(allrecipes\\.com)()/(recipe/.*)$","^(http(s)?)://((\\.{1,18}\\.)?)(allrecipes\\.)(com)/(recipe/[^/]+(/)?(/detail\\.aspx\\??)?)$","^(http(s)?)://()(allrecipes\\.com)()/([r|R]ecipe/[^/]+/Detail\\.aspx)$","^(http(s)?)://()(allrecipes\\.com)()/(recipe/.*)$","^(http(s)?)://(cookieandkate\\.com)()/(\\d{4})/(.+)$","^(http(s)?)://(cooking\\.)(nytimes\\.com)()/(recipes/(.*))$","^(http(s)?)://()(cookpad\\.com)()/(recipe/[0-9]+$)$","^(http(s)?)://()(damndelicious\\.net)()/\\d+/\\d+/\\d+/.+/$","^(http(s)?)://(food52\\.com)()/recipes/[0-9]+-.+$","^(http(s)?)://(minimalistbaker.com)/([^/]*-[^/]*)/$","^(http(s)?)://(paleoleap.com)/([^/]*-[^/]*)/$","^(http(s)?)://(pinchofyum.com)/([^/]*-[^/]*)$","^(http(s)?)://(recipe\\.rakuten\\.co\\.jp)()/recipe/[0-9]+/$","^(http(s)?)://()(thepioneerwoman\\.com)()/(cooking/.+/)$","^(http(s)?)://((www\\.)?)(allrecipes\\.com)()/([r|R]ecipe/[^/]+/(Detail\\.aspx)?)$","^(http(s)?)://((www\\.)?)(allrecipes\\.com)()/([R|r]ecipe/.*)$","^(http(s)?)://(www\\.)(bbc\\.co\\.uk/food/recipes/[^/]*_\\d+)$","^(http(s)?)://(www\\.)(bbcgoodfood\\.com)()/(recipes/[0-9]+/(.*))$","^(http(s)?)://(www\\.)(bbcgoodfood\\.com)/recipes/([^/]*-[^/]*)$","^(http(s)?)://(www\\.)(bettycrocker\\.com)()/(recipes/[^\\/]+/[0-9a-f-]{36}/?)$","^(http(s)?)://(www\\.)(bonappetit\\.com)()/(recipe/(.*))$","^(http(s)?)://(www\\.budgetbytes\\.com)/\\d{4}/\\d{2}/(.*)/","^(http(s)?)://((www\\.)?)(chowhound\\.com)()/(recipes/.*)$","^(http(s)?)://(www\\.cookingclassy\\.com)/\\d{4}/\\d{2}/(.*)/","^(http(s)?)://(www\\.delish\\.com)/cooking/recipe-ideas/recipes/a\\d+/[^/]*-[^/]*/","^(http(s)?)://(www\\.)(eatingwell\\.com)()/(recipe/\\d+/.+/)$","^(http(s)?)://(www\\.)(epicurious\\.com)()/(recipes/food/views/.*)$","^(http(s)?)://(www\\.)(food\\.com)()/(recipe/.*)$","^(http(s)?)://(www\\.)(foodandwine\\.com)()/(recipes\\/.+)$","^(http(s)?)://(www\\.)(foodnetwork)(\\.ca)/(recipe/(.*))$","^(http(s)?)://(www\\.)(foodnetwork\\.com)()/(recipe-collections/.*)$","^(http(s)?)://(www\\.)(foodnetwork\\.com)()/(recipes.*)$","^(http(s)?)://(www\\.)(foodnetwork\\.com)()/(recipes/.*)$","^(http(s)?)://(www\\.)(marthastewart\\.com)()/(([0-9]+|recipe)/.*)$","^(http(s)?)://(www\\.)(marthastewart\\.com)()/([0-9]+/[^/]+)$","^(http(s)?)://(www\\.)(myrecipes\\.com)()/(recipe/.*)$","^(http(s)?)://(www\\.)(myrecipes\\.com)()/(recipe/.*-[0-9]*/)$","^(http(s)?)://(www\\.)(myrecipes\\.com)()/(recipe/.*)$","^(http(s)?)://(www\\.)(myrecipes\\.com)()/(recipe/[^/]+.*)$","^(http(s)?)://(www\\.)(realsimple\\.com)()/(food-recipes/browse-all-recipes/[^\\/]+/index\\.html)$","^(http(s)?)://((www)?\\.)(seriouseats\\.com)()/([Rr]ecipes\\/.*\\.(html|HTML)(.*)?)$","^(http(s)?)://(www\\.)(simplyrecipes\\.com)()/(recipes/[^/]*/)$","^(http(s)?)://((www\\.)?)(simplyrecipes\\.com)()/(recipes/[^/]*/)$","^(http(s)?)://((www\\.)?)(simplyrecipes\\.com)()/(recipes/.*)$","^(http(s)?)://(www\\.)(tasteofhome\\.com)()/([R|r]ecipes/[^/]+$)$","^(http(s)?)://(www\\.)(tasteofhome\\.com)()/(recipes/[^/]*/?)$","^(http(s)?)://(www\\.)(tasteofhome\\.com)()/(recipes/[^\\/]+/?)$","^(http(s)?)://(www\\.)(yummly\\.com)()/(recipe/[^/]+)$","^(http(s)?)://((www\\.)?)(yummly\\.com)()/(recipe/.*)$","^(http(s)?)://(.*)(yummly\\.com)()/(recipe/.+)$"]},ProductDomains:{Description:"The set of domains where we want to show a Product tooltip",Value:["^(http(s)?)://store\\.steampowered.com/app/\\d+/.*$","^(http(s)?)://(www\\.)(amazon\\.com)()/(gp/product/[^/]+/.*)$","^(http(s)?)://(www\\.)(amazon\\.com)()/(dp/[^/]+.*)$","^(http(s)?)://(www\\.)(amazon\\.com)()/([^/]+/dp/[^/]+)$","^(http(s)?)://(www\\.)(amazon\\.in)()/((.+/)?(dp|gp/product)\\/\\w{10,13}([^\\w].*)?)$","^(http(s)?)://(www\\.)(amazon\\.)([a-zA-Z\\.]+)/([^/]+/dp/.*)$","^(http(s)?)://(www\\.)(bedbathandbeyond\\.com)(/store/product/)([^/]*-[^/]*/)(\\d+.*)","^(http(s)?)://(www\\.)(ebay\\.com)()/(itm/[^/]+/.*)$","^(http(s)?)://(www\\.)(etsy\\.com)()/(listing)/(\\d+/.*)$","^(http(s)?)://(www\\.)(homedepot\\.com)()/(p/[^/]+/.*)$","^(http(s)?)://(www\\.)(newegg\\.com)()/(Product/Product\\.aspx\\?Item=.+)$","^(http(s)?)://(www\\.)(overstock\\.com)()/(.+/.+/[0-9]+/product\\.html.*)$","^(http(s)?)://(www\\.)(staples\\.com)()/(.*/product_[^/]+)$","^(http(s)?)://(www\\.)(target\\.com)()/(p/.+)$","^(http(s)?)://(www\\.)(walmart\\.com)()/(ip/.*)$"]},App_Id:{Description:"For identifying the Web Clipper during interaction with external services",Value:"OneNote Web Clipper"},Misc_Data_Endpoint_Id:{Description:"The id of the data endpoint used for miscellaneous logging",Value:"production"},Aria_Token:{Description:"For sending log events to the Aria production tenant 'OneNote Web Clipper (production)'",Value:"c7f3f24bc5f746d7b9d8f8e422fdd8a5-1cb58166-2598-485f-897c-1d3c8e62d30e-7560"},LogCategory_RatingsPrompt:{Description:"OFeedback log category for the ratings prompt feature",Value:"OneNoteClipperRatingsPrompt"},Bookmarklet_RatingsEnabled:{Description:"If true, ratings prompt will be enabled for the bookmarklet",Value:"false"},ChromeExtension_RatingsEnabled:{Description:"If true, ratings prompt will be enabled for the Chrome extension",Value:"true"},EdgeExtension_RatingsEnabled:{Description:"If true, ratings prompt will be enabled for the Edge extension",Value:"false"},FirefoxExtension_RatingsEnabled:{Description:"If true, ratings prompt will be enabled for the Firefox extension",Value:"false"},SafariExtension_RatingsEnabled:{Description:"If true, ratings prompt will be enabled for the Safari extension",Value:"false"},ChromeExtension_RatingUrl:{Description:"URL for the Web Clipper in the Chrome Web Store; used to direct users to leave ratings and reviews",Value:"https://chrome.google.com/webstore/detail/onenote-web-clipper/gojbdfnpnhogfdgjbigejoaolejmgdhk/reviews"},EdgeExtension_RatingUrl:{Description:"URL for the Web Clipper in the Windows Store; used to direct users to leave ratings and reviews",Value:"https://www.microsoft.com/en-us/store/p/onenote-web-clipper/9nblggh4r01n#ratings-reviews"},FirefoxExtension_RatingUrl:{Description:"URL for the Web Clipper in Firefox Add-ons; used to direct users to leave ratings and reviews",Value:""}}},{}],54:[function(e,t,n){t.exports={"WebClipper.Action.BackToHome":"Back","WebClipper.Action.Cancel":"Cancel","WebClipper.Action.Clip":"Clip","WebClipper.Action.Feedback":"Feedback?","WebClipper.Action.RefreshPage":"Refresh Page","WebClipper.Action.Signin":"Sign In","WebClipper.Action.SigninMsa":"Sign in with a Microsoft account","WebClipper.Action.SigninOrgId":"Sign in with a work or school account","WebClipper.Action.SignOut":"Sign Out","WebClipper.Action.TryAgain":"Try Again","WebClipper.Action.ViewInOneNote":"View in OneNote","WebClipper.BetaTag":"beta","WebClipper.ClipType.Article.Button":"Article","WebClipper.ClipType.Article.ProgressLabel":"Clipping Article","WebClipper.ClipType.Bookmark.Button":"Bookmark","WebClipper.ClipType.Bookmark.Button.Tooltip":"Clip just the title, thumbnail, synopsis, and link.","WebClipper.ClipType.Bookmark.ProgressLabel":"Clipping Bookmark","WebClipper.ClipType.Button.Tooltip":"Clip just the {0} in an easy-to-read format.","WebClipper.ClipType.Image.Button":"Image","WebClipper.ClipType.ImageSnippet.Button":"Image Snippet","WebClipper.ClipType.MultipleRegions.Button.Tooltip":"Take screenshots of parts of the page you'll select.","WebClipper.ClipType.Pdf.Button":"PDF File","WebClipper.ClipType.Pdf.ProgressLabel":"Clipping PDF File","WebClipper.ClipType.Pdf.Button.Tooltip":"Take a screenshot of the whole PDF file and save a copy of the attachment.","WebClipper.ClipType.Product.Button":"Product","WebClipper.ClipType.Product.ProgressLabel":"Clipping Product","WebClipper.ClipType.Recipe.Button":"Recipe","WebClipper.ClipType.Recipe.ProgressLabel":"Clipping Recipe","WebClipper.ClipType.Region.Button":"Region","WebClipper.ClipType.Region.Button.Tooltip":"Take a screenshot of the part of the page you'll select.","WebClipper.ClipType.Region.ProgressLabel":"Clipping Region","WebClipper.ClipType.ScreenShot.Button":"Full Page","WebClipper.ClipType.ScreenShot.Button.Tooltip":"Take a screenshot of the whole page, just like you see it.","WebClipper.ClipType.ScreenShot.ProgressLabel":"Clipping Page","WebClipper.ClipType.Selection.Button":"Selection","WebClipper.ClipType.Selection.Button.Tooltip":"Clip the selection you made on the web page.","WebClipper.ClipType.Selection.ProgressLabel":"Clipping Selection","WebClipper.Error.NoOpError":"Sorry, we can't clip this page right now","WebClipper.Error.CannotClipPage":"Sorry, this type of page can't be clipped.","WebClipper.Error.CorruptedSection":"Your clip can't be saved here because the section is corrupt.","WebClipper.Error.GenericError":"Something went wrong. Please try clipping the page again.","WebClipper.Error.NotProvisioned":"Your clip can't be saved because your OneDrive for Business account isn't set up.","WebClipper.Error.PasswordProtected":"Your clip can't be saved here because the section is password protected.","WebClipper.Error.QuotaExceeded":"Your clip can't be saved because your OneDrive account has reached its size limit.","WebClipper.Error.ResourceDoesNotExist":"Your clip can't be saved here because the location no longer exists. Please try clipping to another location.","WebClipper.Error.SectionTooLarge":"Your clip can't be saved here because the section has reached its size limit.","WebClipper.Error.UserAccountSuspended":"Your clip can't be saved because your Microsoft account has been suspended.","WebClipper.Error.UserAccountSuspendedResetText":"Reset Your Account","WebClipper.Error.GenericExpiredTokenRefreshError":"Your login session has ended and we were unable to clip the page. Please sign in again.","WebClipper.Error.SignInUnsuccessful":"We couldn't sign you in. Please try again.","WebClipper.Error.OrphanedWebClipperDetected":"Something went wrong. Please refresh this page, and try to clip again.","WebClipper.Extension.RefreshTab":"Please refresh this page, and try to clip again.","WebClipper.FromCitation":"Clipped from: {0}","WebClipper.Label.Annotation":"Note","WebClipper.Label.AnnotationPlaceholder":"Add a note...","WebClipper.Label.ClipImageToOneNote":"Clip Image to OneNote","WebClipper.Label.ClipLocation":"Location","WebClipper.Label.ClipSelectionToOneNote":"Clip Selection to OneNote","WebClipper.Label.ClipSuccessful":"Clip Successful!","WebClipper.Label.DragAndRelease":"Drag and release to capture a screenshot","WebClipper.Label.OneNoteClipper":"OneNote Clipper","WebClipper.Label.OneNoteWebClipper":"OneNote Web Clipper","WebClipper.Label.OpenChangeLogFromTooltip":"Check out what's new","WebClipper.Label.ProceedToWebClipper":"Proceed to the Web Clipper","WebClipper.Label.ProceedToWebClipperFun":"Try it out!","WebClipper.Label.SignInDescription":"Save anything on the web to OneNote in one click","WebClipper.Label.UnsupportedBrowser":"Sorry, your browser version is unsupported.","WebClipper.Label.WebClipper":"Web Clipper","WebClipper.Label.WebClipperWasUpdated":"OneNote Web Clipper has been updated","WebClipper.Label.WebClipperWasUpdatedFun":"OneNote Web Clipper is now better than ever!","WebClipper.Label.PdfTooltip":"Clip this PDF to OneNote, and read it later","WebClipper.Label.ProductTooltip":"Clip and save product details like this to OneNote","WebClipper.Label.RecipeTooltip":"Save clutter-free recipes right to OneNote","WebClipper.Label.VideoTooltip":"Clip this video and watch it anytime in OneNote","WebClipper.Label.WhatsNew":"What's New","WebClipper.Label.Ratings.Message.End":"Thanks for your feedback!","WebClipper.Label.Ratings.Message.Feedback":"Help us improve","WebClipper.Label.Ratings.Message.Init":"Enjoying the Web Clipper?","WebClipper.Label.Ratings.Message.Rate":"Glad you like it!","WebClipper.Label.Ratings.Button.Feedback":"Provide feedback","WebClipper.Label.Ratings.Button.Init.Positive":"Yes, it's great!","WebClipper.Label.Ratings.Button.Init.Negative":"Not really...","WebClipper.Label.Ratings.Button.NoThanks":"No thanks","WebClipper.Label.Ratings.Button.Rate":"Rate us 5 stars","WebClipper.Preview.AugmentationModeGenericError":"Something went wrong creating the preview. Try again, or choose a different clipping mode.","WebClipper.Preview.BookmarkModeGenericError":"Something went wrong creating the bookmark. Try again, or choose a different clipping mode.","WebClipper.Preview.FullPageModeGenericError":"A preview isn't available, but you can still clip your page.","WebClipper.Preview.LoadingMessage":"Loading preview...","WebClipper.Preview.NoContentFound":"No article found. Try another clipping mode.","WebClipper.Preview.UnableToClipLocalFile":"Local files can only be clipped using Region mode.","WebClipper.Preview.Header.AddAnotherRegionButtonLabel":"Add another region","WebClipper.Preview.Header.SansSerifButtonLabel":"Sans-serif","WebClipper.Preview.Header.SerifButtonLabel":"Serif","WebClipper.Preview.Spinner.ClipAnyTimeInFullPage":"In a hurry? You can clip any time in Full Page mode!","WebClipper.SectionPicker.DefaultLocation":"Default location","WebClipper.SectionPicker.LoadingNotebooks":"Loading notebooks...","WebClipper.SectionPicker.NoNotebooksFound":"You don't have any notebooks yet, so we'll create your default notebook when you clip this page.","WebClipper.SectionPicker.NotebookLoadFailureMessage":"OneNote couldn't load your notebooks. Please try again later.","WebClipper.SectionPicker.NotebookLoadUnretryableFailureMessage":"OneNote couldn't load your notebooks.","WebClipper.FontFamily.Regular":"Segoe UI Regular,Segoe UI,Segoe,Segoe WP,Helvetica Neue,Roboto,Helvetica,Arial,Tahoma,Verdana,sans-serif","WebClipper.FontFamily.Bold":"Segoe UI Bold,Segoe UI,Segoe,Segoe WP,Helvetica Neue,Roboto,Helvetica,Arial,Tahoma,Verdana,sans-serif","WebClipper.FontFamily.Light":"Segoe UI Light,Segoe WP Light,Segoe UI,Segoe,Segoe WP,Helvetica Neue,Roboto,Helvetica,Arial,Tahoma,Verdana,sans-serif","WebClipper.FontFamily.Preview.SerifDefault":"Georgia","WebClipper.FontFamily.Preview.SansSerifDefault":"Verdana","WebClipper.FontFamily.Semibold":"Segoe UI Semibold,Segoe UI,Segoe,Segoe WP,Helvetica Neue,Roboto,Helvetica,Arial,Tahoma,Verdana,sans-serif","WebClipper.FontFamily.Semilight":"Segoe UI Semilight,Segoe UI Light,Segoe WP Light,Segoe UI,Segoe,Segoe WP,Helvetica Neue,Roboto,Helvetica,Arial,Tahoma,Verdana,sans-serif","WebClipper.FontSize.Preview.SerifDefault":"16px","WebClipper.FontSize.Preview.SansSerifDefault":"16px"}},{}],55:[function(e,t,n){function o(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function i(e){if(c===setTimeout)return setTimeout(e,0);if((c===o||!c)&&setTimeout)return c=setTimeout,setTimeout(e,0);try{return c(e,0)}catch(t){try{return c.call(null,e,0)}catch(t){return c.call(this,e,0)}}}function a(e){if(g===clearTimeout)return clearTimeout(e);if((g===r||!g)&&clearTimeout)return g=clearTimeout,clearTimeout(e);try{return g(e)}catch(t){try{return g.call(null,e)}catch(t){return g.call(this,e)}}}function s(){m&&f&&(m=!1,f.length?h=f.concat(h):v=-1,h.length&&l())}function l(){if(!m){var e=i(s);m=!0;for(var t=h.length;t;){for(f=h,h=[];++v<t;)f&&f[v].run();v=-1,t=h.length}f=null,m=!1,a(e)}}function u(e,t){this.fun=e,this.array=t}function p(){}var c,g,d=t.exports={};!function(){try{c="function"==typeof setTimeout?setTimeout:o}catch(e){c=o}try{g="function"==typeof clearTimeout?clearTimeout:r}catch(e){g=r}}();var f,h=[],m=!1,v=-1;d.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];h.push(new u(e,t)),1!==h.length||m||i(l)},u.prototype.run=function(){this.fun.apply(null,this.array)},d.title="browser",d.browser=!0,d.env={},d.argv=[],d.version="",d.versions={},d.on=p,d.addListener=p,d.once=p,d.off=p,d.removeListener=p,d.removeAllListeners=p,d.emit=p,d.binding=function(e){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(e){throw new Error("process.chdir is not supported")},d.umask=function(){return 0}},{}],56:[function(e,t,n){(function(o,r){!function(e,o){"object"==typeof n&&"undefined"!=typeof t?t.exports=o():"function"==typeof define&&define.amd?define(o):e.ES6Promise=o()}(this,function(){"use strict";function t(e){return"function"==typeof e||"object"==typeof e&&null!==e}function n(e){return"function"==typeof e}function i(e){Q=e}function a(e){J=e}function s(){return function(){return o.nextTick(g)}}function l(){return"undefined"!=typeof $?function(){$(g)}:c()}function u(){var e=0,t=new Z(g),n=document.createTextNode("");return t.observe(n,{characterData:!0}),function(){n.data=e=++e%2}}function p(){var e=new MessageChannel;return e.port1.onmessage=g,function(){return e.port2.postMessage(0)}}function c(){var e=setTimeout;return function(){return e(g,1)}}function g(){for(var e=0;e<q;e+=2){var t=ne[e],n=ne[e+1];t(n),ne[e]=void 0,ne[e+1]=void 0}q=0}function d(){try{var t=e,n=t("vertx");return $=n.runOnLoop||n.runOnContext,l()}catch(e){return c()}}function f(e,t){var n=arguments,o=this,r=new this.constructor(m);void 0===r[re]&&O(r);var i=o._state;return i?!function(){var e=n[i-1];J(function(){return x(i,r,e,o._result)})}():U(o,r,e,t),r}function h(e){var t=this;if(e&&"object"==typeof e&&e.constructor===t)return e;var n=new t(m);return I(n,e),n}function m(){}function v(){return new TypeError("You cannot resolve a promise with itself")}function y(){return new TypeError("A promises callback cannot return that same promise.")}function C(e){try{return e.then}catch(e){return le.error=e,le}}function b(e,t,n,o){try{e.call(t,n,o)}catch(e){return e}}function S(e,t,n){J(function(e){var o=!1,r=b(n,t,function(n){o||(o=!0,t!==n?I(e,n):P(e,n))},function(t){o||(o=!0,k(e,t))},"Settle: "+(e._label||" unknown promise"));!o&&r&&(o=!0,k(e,r))},e)}function w(e,t){t._state===ae?P(e,t._result):t._state===se?k(e,t._result):U(t,void 0,function(t){return I(e,t)},function(t){return k(e,t)})}function T(e,t,o){t.constructor===e.constructor&&o===f&&t.constructor.resolve===h?w(e,t):o===le?k(e,le.error):void 0===o?P(e,t):n(o)?S(e,t,o):P(e,t)}function I(e,n){e===n?k(e,v()):t(n)?T(e,n,C(n)):P(e,n)}function E(e){e._onerror&&e._onerror(e._result),L(e)}function P(e,t){e._state===ie&&(e._result=t,e._state=ae,0!==e._subscribers.length&&J(L,e))}function k(e,t){e._state===ie&&(e._state=se,e._result=t,J(E,e))}function U(e,t,n,o){var r=e._subscribers,i=r.length;e._onerror=null,r[i]=t,r[i+ae]=n,r[i+se]=o,0===i&&e._state&&J(L,e)}function L(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var o=void 0,r=void 0,i=e._result,a=0;a<t.length;a+=3)o=t[a],r=t[a+n],o?x(n,o,r,i):r(i);e._subscribers.length=0}}function F(){this.error=null}function N(e,t){try{return e(t)}catch(e){return ue.error=e,ue}}function x(e,t,o,r){var i=n(o),a=void 0,s=void 0,l=void 0,u=void 0;if(i){if(a=N(o,r),a===ue?(u=!0,s=a.error,a=null):l=!0,t===a)return void k(t,y())}else a=r,l=!0;t._state!==ie||(i&&l?I(t,a):u?k(t,s):e===ae?P(t,a):e===se&&k(t,a))}function A(e,t){try{t(function(t){I(e,t)},function(t){k(e,t)})}catch(t){k(e,t)}}function R(){return pe++}function O(e){e[re]=pe++,e._state=void 0,e._result=void 0,e._subscribers=[]}function D(e,t){this._instanceConstructor=e,this.promise=new e(m),this.promise[re]||O(this.promise),G(t)?(this._input=t,this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?P(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&P(this.promise,this._result))):k(this.promise,W())}function W(){return new Error("Array Methods must be provided an Array")}function B(e){return new D(this,e).promise}function V(e){var t=this;return new t(G(e)?function(n,o){for(var r=e.length,i=0;i<r;i++)t.resolve(e[i]).then(n,o)}:function(e,t){return t(new TypeError("You must pass an array to race."))})}function _(e){var t=this,n=new t(m);return k(n,e),n}function M(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function H(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function K(e){this[re]=R(),this._result=this._state=void 0,this._subscribers=[],m!==e&&("function"!=typeof e&&M(),this instanceof K?A(this,e):H())}function z(){var e=void 0;if("undefined"!=typeof r)e=r;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var n=null;try{n=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===n&&!t.cast)return}e.Promise=K}var j=void 0;j=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)};var G=j,q=0,$=void 0,Q=void 0,J=function(e,t){ne[q]=e,ne[q+1]=t,q+=2,2===q&&(Q?Q(g):oe())},Y="undefined"!=typeof window?window:void 0,X=Y||{},Z=X.MutationObserver||X.WebKitMutationObserver,ee="undefined"==typeof self&&"undefined"!=typeof o&&"[object process]"==={}.toString.call(o),te="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,ne=new Array(1e3),oe=void 0;oe=ee?s():Z?u():te?p():void 0===Y&&"function"==typeof e?d():c();var re=Math.random().toString(36).substring(16),ie=void 0,ae=1,se=2,le=new F,ue=new F,pe=0;return D.prototype._enumerate=function(){for(var e=this.length,t=this._input,n=0;this._state===ie&&n<e;n++)this._eachEntry(t[n],n)},D.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,o=n.resolve;if(o===h){var r=C(e);if(r===f&&e._state!==ie)this._settledAt(e._state,t,e._result);else if("function"!=typeof r)this._remaining--,this._result[t]=e;else if(n===K){var i=new n(m);T(i,e,r),this._willSettleAt(i,t)}else this._willSettleAt(new n(function(t){return t(e)}),t)}else this._willSettleAt(o(e),t)},D.prototype._settledAt=function(e,t,n){var o=this.promise;o._state===ie&&(this._remaining--,e===se?k(o,n):this._result[t]=n),0===this._remaining&&P(o,this._result)},D.prototype._willSettleAt=function(e,t){var n=this;U(e,void 0,function(e){return n._settledAt(ae,t,e)},function(e){return n._settledAt(se,t,e)})},K.all=B,K.race=V,K.resolve=h,K.reject=_,K._setScheduler=i,K._setAsap=a,K._asap=J,K.prototype={constructor:K,then:f,catch:function(e){return this.then(null,e)}},K.polyfill=z,K.Promise=K,K})}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:55}]},{},[10]);